"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[8964],{44713:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var a=s(31635),i=s(70355),n=s(59456),d=s(49655),o=s(17986),r=s(39886),l=s(95108),c=s(43586),u=s(69462),g=s(94202),m=s(68512),A=s(38989),h=s(68801),v=s(87650),f=s(49102),p=s(62562),E=s(38546),y=s(22011),b=s(33515),C=s(10685),k=s(69070),S=s(74027),F=s(46487),w=s(4899),_=s(60833),B=s(74302);const N=(0,m.A)((0,u.bk)({handleSubmit:(e,{props:{onSubmit:t}})=>{t(e)},mapPropsToValues:({getFields:e,customerMessage:t,billingAddress:s})=>Object.assign(Object.assign({},(0,y.A)(e(s&&s.countryCode),s)),{orderComment:t}),isInitialValid:({billingAddress:e,getFields:t,language:s})=>!!e&&(0,b.A)({language:s,formFields:t(e.countryCode)}).isValidSync(e),validationSchema:({language:e,getFields:t,methodId:s})=>"amazonpay"===s?(0,g.RZ)((s=>(0,C.A)({translate:(0,b.X)(e),formFields:t(s&&s.countryCode)}))):(0,g.RZ)((s=>(0,b.A)({language:e,formFields:t(s&&s.countryCode)}))),enableReinitialize:!0})((({methodId:e,getFields:t,billingAddress:s,setFieldValue:r,values:l,onUnhandledError:c})=>{const[u,g]=(0,i.useState)(!1),m=(0,i.useRef)(null),{isPayPalFastlaneEnabled:y,paypalFastlaneAddresses:b}=(0,A.A)(),{checkoutService:C,checkoutState:N}=(0,n.Q)(),{data:{getCustomer:I,getConfig:U,getCart:L},statuses:{isUpdatingBillingAddress:P,isUpdatingCheckout:R}}=N,V=I(),z=U(),M=L();if(!z||!V||!M)throw new Error("checkout data is not available");const O=V.isGuest,j=V.addresses,x="amazonpay"===e,J=t(l.countryCode),Q=J.filter((({custom:e})=>e)),Z=Q.length>0,G=x&&Z?Q:J,T=O&&y?b:j,X=(null==T?void 0:T.length)>0,q=s&&(0,v.A)(s,T,t(s.countryCode)),D=P()||R(),{enableOrderComments:H}=z.checkoutSettings,K=H&&(0,S.A)(M)<1,W=e=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){g(!0);try{yield C.updateBillingAddress(e)}catch(e){e instanceof Error&&c(e)}finally{g(!1)}}));return i.createElement(w.A,{autoComplete:"on"},x&&s&&i.createElement("div",{className:"form-fieldset"},i.createElement(B.A,{address:s})),i.createElement(_.A,{id:"checkoutBillingAddress",ref:m},X&&!x&&i.createElement(_.A,{id:"billingAddresses"},i.createElement(h.A,{isLoading:u},i.createElement(f.A,{addresses:T,onSelectAddress:W,onUseNewAddress:()=>{W({})},selectedAddress:q?s:void 0,type:p.A.Billing}))),!q&&i.createElement(o.A,{isLoading:u},i.createElement(E.A,{countryCode:l.countryCode,formFields:G,setFieldValue:r,shouldShowSaveAddress:!O,type:p.A.Billing}))),K&&i.createElement(k.A,null),i.createElement("div",{className:"form-actions"},i.createElement(F.Ay,{className:"body-bold",disabled:D||u,id:"checkout-billing-continue",isLoading:D||u,type:"submit",variant:F.Ak.Primary},i.createElement(d.A,{id:"common.continue_action"}))))})));var I=s(21106);const U=({navigateNextStep:e,onReady:t,onUnhandledError:s})=>{const{checkoutService:u,checkoutState:g}=(0,n.Q)(),{data:{getCheckout:m,getConfig:A,getCart:h,getCustomer:v,getBillingAddress:f,getBillingAddressFields:p},statuses:{isLoadingBillingCountries:E}}=g,y=A(),b=v(),C=m(),k=h();if(!(y&&b&&C&&k))throw new Error("Unable to access checkout data");const S=E(),F=C.customerMessage,w=function(e){const t=(0,I.A)(e);return t&&["amazonpay"].includes(t.providerId)?t.providerId:void 0}(C),_=f(),B=p;return(0,i.useEffect)((()=>{(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{yield u.loadBillingAddressFields(),t()}catch(e){e instanceof Error&&s(e)}}))}),[]),i.createElement(o.A,{isLoading:S},i.createElement("div",{className:"checkout-form"},i.createElement("div",{className:"form-legend-container"},i.createElement(c.A,{testId:"billing-address-heading"},i.createElement(d.A,{id:"billing.billing_address_heading"}))),i.createElement(N,{billingAddress:_,customerMessage:F,getFields:B,methodId:w,navigateNextStep:e,onSubmit:t=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var{orderComment:i}=t,n=(0,a.__rest)(t,["orderComment"]);const d=u.updateBillingAddress,o=u.updateCheckout,c=f(),g=[],m=(0,r.A)(n);m&&!(0,l.A)(m,c)&&g.push(d(m)),F!==i&&g.push(o({customerMessage:i}));try{yield Promise.all(g),e()}catch(e){e instanceof Error&&s(e)}})),onUnhandledError:s})))}}}]);
//# sourceMappingURL=billing-16dbbf2d.js.map