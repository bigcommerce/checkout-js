"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[2843],{21106:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(57398),a=s(60045);function r(e){return(e&&e.payments?e.payments:[]).find((e=>!(0,n.A)(e)&&!(0,a.A)(e)&&!!e.providerId))}},38546:(e,t,s)=>{s.d(t,{A:()=>q});var n=s(69440),a=s(70355),r=s(55150),l=s(76049),o=s(49655),i=s(39981),d=s(33740),c=s(41410),u=s(79001),m=s(84559),p=s(60833),g=s(37958);const h={address1:"address.address_line_1_label",address2:"address.address_line_2_label",city:"address.city_label",company:"address.company_name_label",countryCode:"address.country_label",firstName:"address.first_name_label",lastName:"address.last_name_label",phone:"address.phone_number_label",postalCode:"address.postal_code_label",stateOrProvince:"address.state_label",stateOrProvinceCode:"address.state_label"},f={address1:"address-line1",address2:"address-line2",city:"address-level2",company:"organization",countryCode:"country",firstName:"given-name",lastName:"family-name",phone:"tel",postalCode:"postal-code",stateOrProvince:"address-level1",stateOrProvinceCode:"address-level1"},_={countryCode:"address.select_country_action",stateOrProvince:"address.select_state_action",stateOrProvinceCode:"address.select_state_action"},b="address1";var v=s(62562);const y={address1:"addressLine1",address2:"addressLine2",postalCode:"postCode",stateOrProvince:"province",stateOrProvinceCode:"provinceCode"};function A(e){return y[e]||e}function C(e){return`${A(e)}Input`}class E{constructor(e){const{address_components:t,name:s}=e;this._name=null!=s?s:"",this._address=t}getState(){return this._get("administrative_area_level_1","short_name")}getStreet(){return this._name}getStreet2(){return"NZ"===this.getCountry()?this._get("sublocality","short_name"):this._get("subpremise","short_name")}getCity(){return this._get("postal_town","long_name")||this._get("locality","long_name")||this._get("neighborhood","short_name")}getCountry(){return this._get("country","short_name")}getPostCode(){return this._get("postal_code","short_name")}_get(e,t){const s=this._address&&this._address.find((t=>t.types.includes(e)));return s?s[t]:""}}class S extends E{getStreet(){const e=this._get("subpremise","short_name");return`${e?`${e}/`:""}${this._get("street_number","long_name")} ${this._get("route","long_name")}`}getStreet2(){return""}}class P extends E{getCity(){return this._get("sublocality_level_1","long_name")||this._get("locality","long_name")}}class w extends E{getState(){return""}getStreet2(){return this._get("locality","long_name")}getPostCode(){return""}}class O{static create(e){var t;const s=null===(t=e.address_components)||void 0===t?void 0:t.find((e=>e.types.includes("country")));switch((null==s?void 0:s.short_name)||""){case"GB":return new w(e);case"CA":return new P(e);case"AU":return new S(e);default:return new E(e)}}}var k=s(3375),I=s.n(k),N=s(28407),x=s(22375),T=s(36951),F=s(31635);const L=({children:e})=>a.createElement("div",{className:"popover"},e);function V(e,t){const s=["popoverList-item"];return e===t&&s.push("is-active"),s.join(" ")}const j=(0,a.memo)((({highlightedIndex:e=-1,testId:t,getItemProps:s=()=>({}),menuProps:n={},items:r})=>r.length?a.createElement("ul",Object.assign({className:"popoverList","data-test":t},n),r.map(((n,r)=>a.createElement("li",Object.assign({className:V(e,r),"data-test":t&&`${t}-item`},s(r,n.id),{key:r}),n.content)))):null)),$=e=>{if(!e.highlightedSlices||!e.highlightedSlices.length)return e.label;let t=0,s=0;return e.highlightedSlices.reduce(((n,r,l)=>{const{label:o}=e,{offset:i,length:d}=r,c=i-t;return c&&(n.push(a.createElement(a.Fragment,{key:s},o.substr(t,c))),s+=1),t=i+d,n.push(a.createElement("strong",{key:s},o.substr(i,d))),s+=1,l===(e.highlightedSlices||[]).length-1&&(n.push(a.createElement(a.Fragment,{key:s},o.substr(t))),s+=1),n}),[])},M=e=>e&&e.value||"",B=({isOpen:e,getInputProps:t,getMenuProps:s,getItemProps:l,highlightedIndex:o,initialValue:i,inputProps:d,items:c,listTestId:u,children:m})=>{const{themeV2:p}=(0,r.w)(),g=t({value:i}),h=Object.assign(Object.assign({},g),d),{labelText:f}=h,_=(0,F.__rest)(h,["labelText"]);return a.createElement(a.Fragment,null,a.createElement("input",Object.assign({},_)),d&&(0,n.includes)(d.className,"floating")&&a.createElement(N.A,{additionalClassName:p?"floating-form-field-label":"",htmlFor:d.id,id:d["aria-labelledby"],isFloatingLabelEnabled:!0},d.labelText),e&&!!c.length&&a.createElement(L,null,a.createElement(j,{getItemProps:(e,t)=>{const s=c.find((e=>e.id===t));return s?l({key:t,index:e,item:s}):{}},highlightedIndex:(0,n.isNumber)(o)?o:-1,items:c.map((e=>(e=>Object.assign(Object.assign({},e),{content:$(e)}))(e))),menuProps:s(),testId:u}),m))},K=({inputProps:e,initialValue:t,initialHighlightedIndex:s,defaultHighlightedIndex:r,items:l,children:o,onSelect:i,listTestId:d,onChange:c,onToggleOpen:u=n.noop})=>{const m=(0,a.useCallback)(((e,t)=>{switch(t.type){case T.Ay.stateChangeTypes.blurInput:case T.Ay.stateChangeTypes.blurButton:case T.Ay.stateChangeTypes.mouseUp:case T.Ay.stateChangeTypes.touchEnd:return Object.assign(Object.assign({},t),{inputValue:e.inputValue});case T.Ay.stateChangeTypes.changeInput:return t.inputValue!==e.inputValue&&c&&c(t.inputValue||"",e.isOpen),t;case T.Ay.stateChangeTypes.keyDownEnter:default:return t}}),[c]),p=(0,a.useCallback)((({isOpen:e,inputValue:t})=>{void 0!==e&&u({isOpen:e,inputValue:t||""})}),[u]);return a.createElement(T.Ay,{defaultHighlightedIndex:r,initialHighlightedIndex:s,initialInputValue:t,itemToString:M,labelId:e&&e["aria-labelledby"],onChange:i,onStateChange:p,stateReducer:m},(({isOpen:s,getInputProps:n,getMenuProps:r,getItemProps:i,highlightedIndex:c})=>a.createElement("div",null,a.createElement(B,{getInputProps:n,getItemProps:i,getMenuProps:r,highlightedIndex:c,initialValue:t,inputProps:e,isOpen:s,items:l,listTestId:d},o))))};var U=s(80315);class R{constructor(){this._scriptLoader=(0,U.vQ)()}loadMapsSdk(e){return this._googleAutoComplete||(this._googleAutoComplete=new Promise(((t,s)=>{const n="initAutoComplete",a=["language=en",`key=${e}`,"libraries=places",`callback=${n}`].join("&");window[n]=()=>{(function(e){const t=e;return Boolean(t.google&&t.google.maps&&t.google.maps.places)})(window)&&t(window.google.maps),s(new Error("Failed to initialize Google Maps Autocomplete SDK."))},this._scriptLoader.loadScript(`//maps.googleapis.com/maps/api/js?${a}`).catch((e=>{throw this._googleAutoComplete=void 0,e}))}))),this._googleAutoComplete}}let D;class H{constructor(e,t=function(){return D||(D=new R),D}()){this._apiKey=e,this._scriptLoader=t}getAutocompleteService(){return this._autocompletePromise||(this._autocompletePromise=this._scriptLoader.loadMapsSdk(this._apiKey).then((e=>{if(!e.places.AutocompleteService)throw new Error("`AutocompleteService` is undefined");return new e.places.AutocompleteService}))),this._autocompletePromise}getPlacesServices(){const e=document.createElement("div");return this._placesPromise||(this._placesPromise=this._scriptLoader.loadMapsSdk(this._apiKey).then((t=>{if(!t.places.PlacesService)throw new Error("`PlacesService` is undefined");return new t.places.PlacesService(e)}))),this._placesPromise}}const z=({initialValue:e,onToggleOpen:t=n.noop,inputProps:s={},fields:r,onSelect:l=n.noop,nextElement:o,isAutocompleteEnabled:i,onChange:d=n.noop,componentRestrictions:c,types:u,apiKey:m})=>{const[p,g]=(0,a.useState)([]),[h,f]=(0,a.useState)("off"),_=(0,a.useRef)();_.current||(_.current=new H(m));return a.createElement(K,{defaultHighlightedIndex:-1,initialHighlightedIndex:-1,initialValue:e,inputProps:Object.assign(Object.assign({},s),{autoComplete:h}),items:p,listTestId:"address-autocomplete-suggestions",onChange:e=>{if(d(e,!1),!i)return g([]),void f("off");(e=>{f(e&&e.length?"nope":"off")})(e),(e=>{if(!e)return void g([]);const t=_.current;t&&t.getAutocompleteService().then((t=>{t.getPlacePredictions({input:e,types:u||["geocode"],componentRestrictions:c},(e=>{const t=(e=>(e||[]).map((e=>({label:e.description,value:e.structured_formatting.main_text,highlightedSlices:e.matched_substrings,id:e.place_id}))))(null!=e?e:void 0);g(t)}))}))})(e)},onSelect:e=>{const t=_.current;t&&t.getPlacesServices().then((t=>{t.getDetails({placeId:e.id,fields:r||["address_components","name"]},(t=>{o&&o.focus(),l(t,e)}))}))},onToggleOpen:t},a.createElement("div",{className:"co-googleAutocomplete-footer"}))},G=(0,a.memo)((({field:{default:e,name:t,maxLength:s},countryCode:n,supportedCountries:l,parentFieldName:i,nextElement:d,apiKey:c,onSelect:u,onChange:m,onToggleOpen:p,isFloatingLabelEnabled:g})=>{const h=i?`${i}.${t}`:t,{themeV2:f}=(0,r.w)(),_=(0,a.useMemo)((()=>a.createElement(o.A,{id:"address.address_line_1_label"})),[]),b=function(e){return`${A(e)}Label`}(t),v=(0,a.useMemo)((()=>({className:I()("form-input optimizedCheckout-form-input",{"floating-input":g},{"floating-form-field-input":f}),id:C(t),"aria-labelledby":b,placeholder:g?" ":e,labelText:g?_:null,maxLength:s||void 0})),[t,b,e,_,s]),y=(0,a.useCallback)((({field:e})=>a.createElement(z,{apiKey:c,componentRestrictions:n?{country:n}:void 0,initialValue:e.value,inputProps:v,isAutocompleteEnabled:!!n&&l.includes(n),nextElement:d,onChange:m,onSelect:u,onToggleOpen:p})),[c,n,v,d,m,u,p,l]),E=g?null:a.createElement(N.A,{additionalClassName:f?"body-regular":"",htmlFor:v.id,id:b,isFloatingLabelEnabled:g},_);return a.createElement("div",{className:I()("dynamic-form-field dynamic-form-field--addressLineAutocomplete",{"floating-form-field":g}),"data-test":"google-autocomplete-form-field"},a.createElement(x.A,{input:y,isFloatingLabelEnabled:g,label:E,name:h,themeV2:f}))})),q=({formFields:e,fieldName:t,countryCode:s,onAutocompleteToggle:y,shouldShowSaveAddress:E,setFieldValue:S=n.noop,onChange:P=n.noop,type:w})=>{const{language:k}=(0,l.Y)(),{themeV2:I}=(0,r.w)(),{checkoutState:{data:{getConfig:N,getBillingCountries:x,getShippingCountries:T}}}=(0,i.Q)(),F=N(),L=(w===v.A.Billing?x():T())||u.M,V=(null==F?void 0:F.checkoutSettings.googleMapsApiKey)||"",j=!!F&&(0,m.A)(F.checkoutSettings),$=["US","CA","AU","NZ","GB"],M=(0,a.useRef)(null),B=(0,a.useRef)(null);(0,a.useEffect)((()=>{const{current:e}=M;e&&(B.current=e.querySelector('[autocomplete="address-line2"]'))}),[]);const K=(0,a.useCallback)(((t,s)=>{const n=e.filter((e=>e.custom&&e.fieldType===d.A.DATE)).map((e=>e.name));(t===b||n.includes(t))&&S(t,s),P(t,s)}),[e,S,P]),U=(0,a.useCallback)((e=>t=>{K(e,t)}),[K]),R=(0,a.useCallback)(((e,t)=>{t||K(b,e)}),[K]),D=(0,a.useCallback)(((e,t)=>{const{value:s}=t,a=function(e,t=[]){if(!e||!e.address_components)return{};const s=O.create(e),n=s.getState(),a=s.getCountry(),r=t&&t.find((e=>a===e.code)),l=s.getStreet2(),o="AU"===a?s.getStreet():void 0;return Object.assign({address1:o,address2:l,city:s.getCity(),countryCode:a,postalCode:s.getPostCode()},n?function(e,t=[]){const s=t.find((({code:t,name:s})=>t===e||s===e));return s?{stateOrProvince:s.name,stateOrProvinceCode:s.code}:{stateOrProvince:t.length?"":e,stateOrProvinceCode:""}}(n,r&&r.subdivisions):{})}(e,L);(0,n.forIn)(a,((e,t)=>{t===b&&void 0===e||(S(t,e),P(t,e))}));const r=a.address1?a.address1:s;r&&K(b,r)}),[L,S,P,K]),H=(0,a.useCallback)(((e,t)=>e.default&&"dropdown"!==e.fieldType?e.default:t&&k.translate(t)),[k]);return a.createElement(a.Fragment,null,a.createElement(p.A,null,a.createElement("div",{className:"checkout-address",ref:M},e.map((e=>{const n=e.name,r=_[n];return"address1"===n&&V&&s&&$.includes(s)?a.createElement(G,{apiKey:V,countryCode:s,field:e,isFloatingLabelEnabled:j,key:e.id,nextElement:B.current||void 0,onChange:R,onSelect:D,onToggleOpen:y,parentFieldName:t,supportedCountries:$}):a.createElement(c.A,{autocomplete:f[e.name],extraClass:`dynamic-form-field--${A(n)}`,field:e,inputId:C(n),isFloatingLabelEnabled:j,key:`${e.id}-${e.name}`,label:e.custom?e.label:a.createElement(o.A,{id:h[e.name]}),onChange:U(n),parentFieldName:e.custom?t?`${t}.customFields`:"customFields":t,placeholder:H(e,r),themeV2:I})})))),E&&a.createElement(g.A,{labelContent:a.createElement(o.A,{id:"address.save_in_addressbook"}),name:t?`${t}.shouldSaveAddress`:"shouldSaveAddress",themeV2:I}))}},39886:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(31635),a=s(6663);function r(e){const{customFields:t}=e,s=(0,n.__rest)(e,["customFields"]),r=e.shouldSaveAddress;return Object.assign(Object.assign({},s),{shouldSaveAddress:r,customFields:(0,a.A)(t)})}},49102:(e,t,s)=>{s.d(t,{A:()=>f});var n=s(70355),a=s(72769),r=s(49655),l=s(38989),o=s(35172),i=s(67113),d=s(55150),c=s(68512),u=s(63650),m=s(75794);const p=(0,c.A)((({selectedAddress:e,language:t,type:s,showSingleLineAddress:l,placeholderText:o})=>{const{themeV2:i}=(0,d.w)(),[c,p]=(0,n.useState)(!1);return n.createElement("a",{"aria-controls":"addressDropdown","aria-expanded":c,"aria-label":t.translate("address.enter_or_select_address_action"),className:"button dropdown-button dropdown-toggle--select","data-test":"address-select-button",href:"#",id:"addressToggle",onBlur:()=>p(!1),onClick:(0,a.A)((()=>p(!c)))},n.createElement((()=>e?l?n.createElement(u.A,{address:e,type:s}):n.createElement(m.A,{address:e,type:s}):n.createElement("span",{className:i?"body-regular":"","data-test":"address-select-placeholder"},null!=o?o:n.createElement(r.A,{id:"address.enter_address_action"}))),null))}));var g=s(95108);const h=({addresses:e,onSelectAddress:t,onUseNewAddress:s,selectedAddress:l,type:o})=>n.createElement("ul",{className:"dropdown-menu instrumentSelect-dropdownMenu",id:"addressDropdown"},n.createElement("li",{className:"dropdown-menu-item dropdown-menu-item--select"},n.createElement("a",{"data-test":"add-new-address",href:"#",onClick:(0,a.A)((()=>s(l)))},n.createElement(r.A,{id:"address.enter_address_action"}))),e.map((e=>n.createElement("li",{className:"dropdown-menu-item dropdown-menu-item--select","data-test":"address-select-option",key:e.id},n.createElement("a",{"data-test":"address-select-option-action",href:"#",onClick:(0,a.A)((()=>t(e)))},n.createElement(m.A,{address:e,type:o})))))),f=(0,n.memo)((({addresses:e,selectedAddress:t,type:s,showSingleLineAddress:a,onSelectAddress:r,onUseNewAddress:d,placeholderText:c})=>{const{shouldShowPayPalFastlaneLabel:u}=(0,l.A)();return n.createElement("div",{className:"form-field"},n.createElement("div",{className:"dropdown--select"},n.createElement(i.A,{dropdown:n.createElement(h,{addresses:e,onSelectAddress:e=>{(0,g.A)(t,e)||r(e)},onUseNewAddress:()=>{d(t)},selectedAddress:t,type:s})},n.createElement(p,{addresses:e,placeholderText:c,selectedAddress:t,showSingleLineAddress:a,type:s}))),u&&n.createElement(o.A,null))}))},63650:(e,t,s)=>{s.d(t,{A:()=>d,k:()=>i});var n=s(3375),a=s.n(n),r=s(69440),l=s(70355),o=s(55150);const i=({firstName:e,lastName:t,address1:s,address2:n,city:a,countryCode:r,stateOrProvince:l,postalCode:o})=>{const i=[s,n,a,l,r,o].filter(Boolean).join(", ");return e&&t&&i?`${e} ${t}, ${i}`:""},d=({address:e})=>{const{themeV2:t}=(0,o.w)();return!(0,r.isEmpty)(e)?l.createElement("div",{className:"vcard checkout-address--static","data-test":"static-address"},l.createElement("p",{className:a()("address-entry",{"body-regular":t})},i(e))):null}},67113:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(70355),a=s(75514),r=s(77175),l=s(32657),o=s(91605);const i=({placement:e="bottom-start",dropdown:t,children:s})=>{const[i,d]=(0,n.useState)(!1),c=(0,n.useCallback)((()=>document.getElementById(o.B)||document.getElementById(o.S)),[]),u=(0,n.useCallback)((()=>{i&&d(!1)}),[i]),m=(0,n.useCallback)((()=>{i||d(!0)}),[i]),p=(0,n.useCallback)((()=>{i?u():m()}),[i,u,m]);return(0,n.useEffect)((()=>{const e=c();return i?null==e||e.addEventListener("click",u):null==e||e.removeEventListener("click",u),()=>{null==e||e.removeEventListener("click",u)}}),[i,u,c]),n.createElement(r.mS,null,n.createElement(l.O,null,(({ref:e})=>n.createElement("div",{className:"dropdownTrigger",onClick:p,ref:e},s))),n.createElement(a.N,{modifiers:[{name:"hide",enabled:!1},{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}],placement:e},(({ref:e,style:s})=>i?n.createElement("div",{className:"dropdownMenu",ref:e,style:Object.assign(Object.assign({},s),{width:"100%",zIndex:1})},t):null)))}},69070:(e,t,s)=>{s.d(t,{A:()=>u});var n=s(70355),a=s(55150),r=s(49655),l=s(60833),o=s(22375),i=s(54454),d=s(28407),c=s(43586);const u=()=>{const{themeV2:e}=(0,a.w)(),t=(0,n.useCallback)((e=>n.createElement(d.A,{hidden:!0,htmlFor:e},n.createElement(r.A,{id:"shipping.order_comment_label"}))),[]),s=(0,n.useCallback)((({field:t})=>n.createElement(i.A,Object.assign({},t,{autoComplete:"off",id:"orderComment",maxLength:2e3,themeV2:e}))),[]),u=(0,n.useMemo)((()=>n.createElement(c.A,{themeV2:e},n.createElement(r.A,{id:"shipping.order_comment_label"}))),[]);return n.createElement(l.A,{legend:u,testId:"checkout-shipping-comments"},n.createElement(o.A,{id:"orderComment",input:s,label:t,name:"orderComment"}))}},74027:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(79877);function a(e){return(0,n.A)(e.lineItems.physicalItems.filter((e=>!e.addedByPromotion&&!e.parentId)))}},87650:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(69440),a=s(95108),r=s(33318);function l(e,t,s){return!(!e||!(0,r.A)(e,s))&&(0,n.some)(t,(t=>(0,a.A)(t,e)))}},91605:(e,t,s)=>{s.d(t,{B:()=>n,S:()=>a});const n="checkout-app",a="micro-app-ng-checkout"},95108:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(69440);function a(e,t){return!(!e||!t)&&((0,n.isEqual)(r(e),r(t))&&function(e,t){if(e.stateOrProvince&&e.stateOrProvince===t.stateOrProvince)return!0;if(e.stateOrProvinceCode&&e.stateOrProvinceCode===t.stateOrProvinceCode)return!0;return e.stateOrProvince===t.stateOrProvince&&e.stateOrProvinceCode===t.stateOrProvinceCode}(e,t))}function r(e){return(0,n.omit)(Object.assign(Object.assign({},e),{customFields:(e.customFields||[]).filter((({fieldValue:e})=>!!e))}),["id","shouldSaveAddress","stateOrProvince","stateOrProvinceCode","type","email","country"])}}}]);
//# sourceMappingURL=2843-e4d7ebf6.js.map