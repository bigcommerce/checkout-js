"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[964],{7258:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var s=n(31635),r=n(2543),i=n(96540),a=n(84509),o=n(58852),d=n(88536),l=n(27178),u=n(92561),c=n(36983),g=n(43081),m=n(17430),p=n(38009),A=n(34760),h=n(25221),f=n(68561),v=n(6466),b=n(42828),y=n(36195),_=n(21315),C=n(71684),E=n(42241),S=n(66280),F=n(90109),k=n(34325),w=n(83915),I=n(53435),M=n(17448),U=n(74921),B=n(85565),z=n(38511),L=n(70440);const N=(0,v.A)((0,h.bk)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,n=e.customerMessage,r=e.billingAddress;return(0,s.__assign)((0,s.__assign)({},(0,k.A)(t(r&&r.countryCode),r)),{orderComment:n})},isInitialValid:function(e){var t=e.billingAddress,n=e.getFields,s=e.language;return!!t&&(0,w.A)({language:s,formFields:n(t.countryCode)}).isValidSync(t)},validationSchema:function(e){var t=e.language,n=e.getFields;return"amazonpay"===e.methodId?(0,f.RZ)((function(e){return(0,I.A)({translate:(0,w.X)(t),formFields:n(e&&e.countryCode)})})):(0,f.RZ)((function(e){return(0,w.A)({language:t,formFields:n(e&&e.countryCode)})}))},enableReinitialize:!0})((function(e){var t=e.googleMapsApiKey,n=e.billingAddress,r=e.countriesWithAutocomplete,d=e.customer,l=d.addresses,u=d.isGuest,c=e.getFields,g=e.countries,m=e.isUpdating,p=e.setFieldValue,A=e.shouldShowOrderComments,h=e.values,f=e.methodId,v=e.isFloatingLabelEnabled,k=e.updateAddress,w=e.onUnhandledError,I=(0,i.useState)(!1),N=I[0],K=I[1],O=(0,i.useRef)(null),P=(0,y.A)(),R=P.isPayPalFastlaneEnabled,V=P.paypalFastlaneAddresses,x=(0,b.I)().newFontStyle,W="amazonpay"===f,Z=c(h.countryCode),G=Z.filter((function(e){return e.custom})),J=G.length>0,T=W&&J?G:Z,D=R?V:l,H=(null==D?void 0:D.length)>0,X=n&&(0,C.A)(n,D,c(n.countryCode)),j=function(e){return(0,s.__awaiter)(void 0,void 0,void 0,(function(){var t;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:K(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,k(e)];case 2:return n.sent(),[3,5];case 3:return(t=n.sent())instanceof Error&&w(t),[3,5];case 4:return K(!1),[7];case 5:return[2]}}))}))};return i.createElement(B.A,{autoComplete:"on"},W&&n&&i.createElement("div",{className:"form-fieldset"},i.createElement(L.A,{address:n})),i.createElement(z.A,{id:"checkoutBillingAddress",ref:O},H&&!W&&i.createElement(z.A,{id:"billingAddresses"},i.createElement(_.A,{isLoading:N},i.createElement(E.A,{addresses:D,onSelectAddress:j,onUseNewAddress:function(){j({})},selectedAddress:X?n:void 0,type:S.A.Billing}))),!X&&i.createElement(o.A,{isLoading:N},i.createElement(F.A,{countries:g,countriesWithAutocomplete:r,countryCode:h.countryCode,formFields:T,googleMapsApiKey:t,isFloatingLabelEnabled:v,setFieldValue:p,shouldShowSaveAddress:!u}))),A&&i.createElement(M.A,null),i.createElement("div",{className:"form-actions"},i.createElement(U.Ay,{className:x?"body-bold":"",disabled:m||N,id:"checkout-billing-continue",isLoading:m||N,type:"submit",variant:U.Ak.Primary},i.createElement(a.A,{id:"common.continue_action"}))))})));var K=n(22576);function O(e){var t=(0,K.A)(e);return t&&["amazonpay"].indexOf(t.providerId)>-1?t.providerId:void 0}var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return(0,s.__awaiter)(t,void 0,void 0,(function(){var t,n,r,i,a,o,u,c,g,m,p=e.orderComment,A=(0,s.__rest)(e,["orderComment"]);return(0,s.__generator)(this,(function(e){switch(e.label){case 0:t=this.props,n=t.updateAddress,r=t.updateCheckout,i=t.customerMessage,a=t.billingAddress,o=t.navigateNextStep,u=t.onUnhandledError,c=[],(g=(0,d.A)(A))&&!(0,l.A)(g,a)&&c.push(n(g)),i!==p&&c.push(r({customerMessage:p})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(c)];case 2:return e.sent(),o(),[3,4];case 3:return(m=e.sent())instanceof Error&&u(m),[3,4];case 4:return[2]}}))}))},t}return(0,s.__extends)(t,e),t.prototype.componentDidMount=function(){return(0,s.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,a,o;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:e=this.props,t=e.initialize,n=e.onReady,i=void 0===n?r.noop:n,a=e.onUnhandledError,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,t()];case 2:return s.sent(),i(),[3,4];case 3:return(o=s.sent())instanceof Error&&a(o),[3,4];case 4:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.updateAddress,n=e.isInitializing,r=e.newFontStyle,d=(0,s.__rest)(e,["updateAddress","isInitializing","newFontStyle"]);return i.createElement(o.A,{isLoading:n},i.createElement("div",{className:"checkout-form"},i.createElement("div",{className:"form-legend-container"},i.createElement(A.A,{newFontStyle:r,testId:"billing-address-heading"},i.createElement(a.A,{id:"billing.billing_address_heading"}))),i.createElement(N,(0,s.__assign)({},d,{onSubmit:this.handleSubmit,updateAddress:t}))))},t}(i.Component);const R=(0,u.A)((function(e){var t=e.checkoutService,n=e.checkoutState,s=n.data,r=s.getCheckout,i=s.getConfig,a=s.getCart,o=s.getCustomer,d=s.getBillingAddress,l=s.getBillingAddressFields,u=s.getBillingCountries,A=n.statuses,h=A.isLoadingBillingCountries,f=A.isUpdatingBillingAddress,v=A.isUpdatingCheckout,b=i(),y=o(),_=r(),C=a();if(!(b&&y&&_&&C))return null;var E=b.checkoutSettings,S=E.enableOrderComments,F=E.googleMapsApiKey;return{billingAddress:d(),countries:u()||c.M,countriesWithAutocomplete:["US","CA","AU","NZ","GB"],customer:y,customerMessage:_.customerMessage,getFields:l,googleMapsApiKey:F,initialize:t.loadBillingAddressFields,isInitializing:h(),isUpdating:f()||v(),methodId:O(_),shouldShowOrderComments:S&&(0,p.A)(C)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout,isFloatingLabelEnabled:(0,g.A)(b.checkoutSettings),newFontStyle:(0,m.A)(b.checkoutSettings,"CHECKOUT-7962.update_font_style_on_checkout_page")}}))(P)}}]);
//# sourceMappingURL=billing-37e1e73d.js.map