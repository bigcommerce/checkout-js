"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[3467],{4676:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var n=a(31635),i=a(70355);var o=a(68512),r=a(45293),s=a(22437),c=a(69440),d=a(72769),l=a(49655),m=a(91182),u=a(67874),p=a(98310);const g=(0,o.A)(({language:e,method:t,onSignOut:a})=>i.createElement("div",{className:"signout-link"},i.createElement(l.A,{id:"remote.sign_out_before_action"})," ",i.createElement("a",{href:"#",onClick:(0,d.A)(a)},i.createElement(l.A,{data:{providerName:(0,p.A)(e)(t)},id:"remote.sign_out_action"}))," ",i.createElement(l.A,{id:"remote.sign_out_after_action"})));class h extends i.Component{constructor(){super(...arguments),this.handleSignOut=()=>(0,n.__awaiter)(this,void 0,void 0,function*(){const{method:e,signOut:t,onSignOut:a=c.noop,onSignOutError:n=c.noop}=this.props;try{yield t({methodId:e.id}),a(),window.location.reload()}catch(e){n(e)}})}componentDidMount(){return(0,n.__awaiter)(this,void 0,void 0,function*(){const{initializePayment:e,method:t,onUnhandledError:a=c.noop}=this.props;this.toggleSubmit();try{yield e({gatewayId:t.gateway,methodId:t.id})}catch(e){a(e)}})}componentWillUnmount(){return(0,n.__awaiter)(this,void 0,void 0,function*(){const{deinitializePayment:e,disableSubmit:t,method:a,onUnhandledError:n=c.noop}=this.props;t(a,!1);try{yield e({gatewayId:a.gateway,methodId:a.id})}catch(e){n(e)}})}componentDidUpdate(e){const{method:t,isPaymentDataRequired:a}=this.props,{method:n,isPaymentDataRequired:i}=e;t.initializationData===n.initializationData&&a===i||this.toggleSubmit()}render(){const{isInitializing:e=!1,isPaymentSelected:t}=this.props;return i.createElement(m.A,{hideContentWhenLoading:!0,isLoading:e},i.createElement("div",{className:"paymentMethod paymentMethod--walletButton"},t?this.renderPaymentView():this.renderSignInView()))}renderSignInView(){const{buttonId:e,language:t,signInButtonClassName:a,signInButtonLabel:n,method:o}=this.props;return i.createElement("a",{className:a,href:"#",id:e,onClick:(0,d.A)()},n||i.createElement(l.A,{data:{providerName:(0,p.A)(t)(o)},id:"remote.sign_in_action"}))}renderPaymentView(){const{accountMask:e,buttonId:t,cardName:a,cardType:n,editButtonClassName:o,editButtonLabel:r,expiryMonth:s,expiryYear:c,shouldShowEditButton:m,method:u}=this.props;return i.createElement(i.Fragment,null,a&&i.createElement("p",{"data-test":"payment-method-wallet-card-name"},i.createElement("strong",null,i.createElement(l.A,{id:"payment.credit_card_name_label"}),":")," ",a),e&&i.createElement("p",{"data-test":"payment-method-wallet-card-type"},i.createElement("strong",null,`${n}:`)," ",e),s&&c&&i.createElement("p",{"data-test":"payment-method-wallet-card-expiry"},i.createElement("strong",null,i.createElement(l.A,{id:"payment.credit_card_expiration_date_label"}),":")," ",`${s}/${c}`),m&&i.createElement("p",null,i.createElement("a",{className:o,href:"#",id:t,onClick:(0,d.A)()},r||i.createElement(l.A,{id:"remote.select_different_card_action"}))),i.createElement(g,{method:u,onSignOut:this.handleSignOut}))}toggleSubmit(){const{disableSubmit:e,method:t,isPaymentDataRequired:a}=this.props;y(t.initializationData)||!a?e(t,!1):e(t,!0)}}function y(e){if(e){if(e.card_information)return{accountMask:_(e.card_information.number),cardType:e.card_information.type};if(e.cardData)return{accountMask:_(e.cardData.accountMask),cardType:e.cardData.cardType,expiryMonth:e.cardData.expMonth,expiryYear:e.cardData.expYear};if(e.accountNum){const{card:t}=(0,s.number)(e.accountNum);return{accountMask:_(e.accountMask),expiryMonth:e.expDate&&`${e.expDate}`.substr(0,2),expiryYear:e.expDate&&`${e.expDate}`.substr(2,2),cardType:t?t.niceType:""}}}}function _(e="",t="****"){return e.includes("*")?e:`${t} ${e}`}const b=(0,o.A)((0,u.A)((0,r.A)(function({checkoutService:e,checkoutState:t},{method:a}){const{data:{getBillingAddress:n,getCheckout:i,isPaymentDataRequired:o}}=t,r=n(),s=i();if(!r||!s)return null;const d=y(a.initializationData);return Object.assign(Object.assign({},d),{cardName:d&&[r.firstName,r.lastName].join(" "),isPaymentDataRequired:o(),isPaymentSelected:(0,c.some)(s.payments,{providerId:a.id}),signOut:e.signOutCustomer})})(h)));const f=(0,r.A)(function({checkoutState:e}){const{data:{getConfig:t}}=e,a=t();return a?{storeLanguage:a.storeProfile.storeLanguage}:null})((0,o.A)(e=>{var{initializePayment:t,language:a,storeLanguage:o}=e,r=(0,n.__rest)(e,["initializePayment","language","storeLanguage"]);const s=(0,i.useCallback)(e=>t(Object.assign(Object.assign({},e),{masterpass:{walletButton:"walletButton"}})),[t]),{config:{testMode:c},initializationData:{checkoutId:d,isMasterpassSrcEnabled:l}}=r.method,m=o.replace("-","_").toLowerCase();const u=(0,i.useMemo)(()=>i.createElement("img",{alt:a.translate("payment.masterpass_name_text"),id:"mpbutton",src:l?`https://${c?"sandbox.":""}src.mastercard.com/assets/img/btn/src_chk_btn_126x030px.svg?locale=${m}&paymentmethod=master,visa,amex,discover&checkoutid=${d}`:"https://masterpass.com/dyn/img/btn/global/mp_chk_btn_126x030px.svg"}),[d,a,m,c,l]);return i.createElement(b,Object.assign({},r,{buttonId:"walletButton",initializePayment:s,signInButtonLabel:u}))}))}}]);
//# sourceMappingURL=masterpass-payment-method-93723c00.js.map