{"version":3,"file":"hosted-credit-card-payment-method-e94bb92a.js","mappings":"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","sources":["webpack://checkout/./packages/hosted-credit-card-integration/src/HostedCreditCardPaymentMethod.tsx","webpack://checkout/@bigcommerce/checkout-sdk/webpack/bootstrap","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-vaulted-instrument.ts","webpack://checkout/@bigcommerce/checkout-sdk/webpack/runtime/define property getters","webpack://checkout/@bigcommerce/checkout-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/is-request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/missing-data-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-initialized-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cardinal-integration/src/cardinal-three-d-secure-flow.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/standard-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/set-prototype-of.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-failed-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cardinal-integration/src/cardinal.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cardinal-integration/src/cardinal-client.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-client-unavailable-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cardinal-integration/src/cardinal-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/to-resolvable-module.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/invalid-argument-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/order-finalization-not-required-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-argument-invalid-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/credit-card-integration/src/credit-card-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cybersource-integration/src/cybersource/cybersource-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cybersource-integration/src/cybersource/create-cybersource-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cardinal-integration/src/cardinal-three-d-secure-flow-v2.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-credit-card-instrument.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cybersource-integration/src/cybersourcev2/cybersourcev2-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cybersource-integration/src/cybersourcev2/create-cybersourcev2-payment-strategy.ts","webpack://checkout/./packages/core/src/app/payment/creditCard/getCreditCardInputStyles.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardCustomerCodeField.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/InstrumentSelect.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/CardInstrumentFieldset.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardCodeRequired.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardCodeRequiredSelector.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardNumberRequiredSelector.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/isInstrumentCardNumberRequired.ts","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/getHostedCreditCardValidationSchema.ts","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/getHostedInstrumentValidationSchema.ts","webpack://checkout/./packages/core/src/app/ui/form/TextInputIframeContainer.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconLock.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconHelp.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconCardCodeVisa.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconCardCodeAmex.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardCodeTooltip.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardCodeField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardExpiryField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardNameField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardNumberField.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardFieldset.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/HostedCreditCardValidation.tsx","webpack://checkout/./packages/core/src/app/payment/hostedCreditCard/withHostedCreditCardFieldset.tsx","webpack://checkout/@bigcommerce/checkout-sdk/./packages/legacy-integration/src/legacy-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/legacy-integration/src/create-legacy-payment-strategy.ts","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardCodeField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardExpiryField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/formatCreditCardExpiryDate.ts","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardNameField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardNumberField.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/formatCreditCardNumber.ts","webpack://checkout/./packages/core/src/app/payment/creditCard/CreditCardFieldset.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/getCreditCardValidationSchema.ts","webpack://checkout/./packages/core/src/app/payment/storedInstrument/CreditCardValidation.tsx","webpack://checkout/./packages/core/src/app/payment/storedInstrument/getInstrumentValidationSchema.ts","webpack://checkout/./packages/core/src/app/payment/paymentMethod/CreditCardPaymentMethod.tsx","webpack://checkout/./packages/core/src/app/payment/creditCard/configureCardValidator.ts","webpack://checkout/./packages/core/src/app/payment/paymentMethod/HostedCreditCardPaymentMethod.tsx"],"sourcesContent":["import React, { type FunctionComponent } from 'react';\n\nimport {\n    type PaymentMethodProps,\n    type PaymentMethodResolveId,\n    toResolvableComponent,\n} from '@bigcommerce/checkout/payment-integration-api';\n\nimport { HostedCreditCardComponent } from './components';\n\nconst HostedCreditCardPaymentMethod: FunctionComponent<PaymentMethodProps> = ({\n    method,\n    checkoutService,\n    checkoutState,\n    paymentForm,\n    language,\n    onUnhandledError,\n}) => {\n    return (\n        <HostedCreditCardComponent\n            checkoutService={checkoutService}\n            checkoutState={checkoutState}\n            language={language}\n            method={method}\n            onUnhandledError={onUnhandledError}\n            paymentForm={paymentForm}\n        />\n    );\n};\n\nexport default toResolvableComponent<PaymentMethodProps, PaymentMethodResolveId>(\n    HostedCreditCardPaymentMethod,\n    [\n        {\n            id: 'hosted-credit-card',\n        },\n        { id: 'credit_card', gateway: 'bluesnapdirect' },\n        { id: 'credit_card', gateway: 'checkoutcom' },\n\n        { id: 'tdonlinemart' },\n    ],\n);\n","// The require scope\nvar __webpack_require__ = {};\n\n","import {\n    FormattedPayload,\n    FormattedVaultedInstrument,\n    HostedVaultedInstrument,\n    PaymentInstrumentPayload,\n    VaultedInstrument,\n} from './payment';\n\nexport default function isVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is VaultedInstrument {\n    return Boolean((instrument as VaultedInstrument).instrumentId);\n}\n\nexport function isHostedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is HostedVaultedInstrument {\n    return (\n        Boolean((instrument as HostedVaultedInstrument).instrumentId) &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccNumber') &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccCvv')\n    );\n}\n\nexport function isFormattedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is FormattedPayload<FormattedVaultedInstrument> {\n    const formattedInstrument = (instrument as FormattedPayload<FormattedVaultedInstrument>)\n        .formattedPayload;\n\n    if (!formattedInstrument) {\n        return false;\n    }\n\n    return (\n        typeof formattedInstrument.bigpay_token === 'string' ||\n        Boolean(formattedInstrument.bigpay_token && formattedInstrument.bigpay_token.token)\n    );\n}\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import RequestError from './request-error';\n\n// Have to use `as` https://stackoverflow.com/questions/73987044/typeguarding-an-unknown-nested-object should be fixed in 4.8+\nconst isRequestError = (error: unknown): error is RequestError => {\n    return typeof error === 'object' && error !== null && 'body' in error;\n};\n\nexport default isRequestError;\n","import StandardError from './standard-error';\n\nexport enum MissingDataErrorType {\n    MissingBillingAddress,\n    MissingCart,\n    MissingCheckout,\n    MissingConsignments,\n    MissingCustomer,\n    MissingCheckoutConfig,\n    MissingOrder,\n    MissingOrderConfig,\n    MissingOrderId,\n    MissingPayment,\n    MissingPaymentId,\n    MissingPaymentInstrument,\n    MissingPaymentMethod,\n    MissingPaymentRedirectUrl,\n    MissingPaymentStatus,\n    MissingPaymentToken,\n    MissingShippingAddress,\n}\n\n/**\n * Throw this error when data that is expected to exist is missing. Usually it\n * is due to the fact that certain data has not been retrieved from or saved to\n * the server yet. And such data is required to perform certain actions.\n */\nexport default class MissingDataError extends StandardError {\n    constructor(public subtype: MissingDataErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'MissingDataError';\n        this.type = 'missing_data';\n    }\n}\n\nfunction getErrorMessage(type: MissingDataErrorType): string {\n    switch (type) {\n        case MissingDataErrorType.MissingBillingAddress:\n            return 'Unable to proceed because billing address data is unavailable.';\n\n        case MissingDataErrorType.MissingCart:\n            return 'Unable to proceed because cart data is unavailable.';\n\n        case MissingDataErrorType.MissingConsignments:\n            return 'Unable to proceed because consignments data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckout:\n            return 'Unable to proceed because checkout data is unavailable.';\n\n        case MissingDataErrorType.MissingCustomer:\n            return 'Unable to proceed because customer data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckoutConfig:\n        case MissingDataErrorType.MissingOrderConfig:\n            return 'Unable to proceed because configuration data is unavailable.';\n\n        case MissingDataErrorType.MissingOrder:\n            return 'Unable to proceed because order data is unavailable.';\n\n        case MissingDataErrorType.MissingOrderId:\n            return 'Unable to proceed because order ID is unavailable or not generated yet.';\n\n        case MissingDataErrorType.MissingPayment:\n            return 'Unable to proceed because payment data is unavailable.';\n\n        case MissingDataErrorType.MissingPaymentToken:\n            return 'Unable to proceed because the token required to submit a payment is missing.';\n\n        case MissingDataErrorType.MissingPaymentMethod:\n            return 'Unable to proceed because payment method data is unavailable or not properly configured.';\n\n        case MissingDataErrorType.MissingShippingAddress:\n            return 'Unable to proceed because shipping address data is unavailable.';\n\n        default:\n            return 'Unable to proceed because the required data is unavailable.';\n    }\n}\n","import StandardError from './standard-error';\n\nexport enum NotInitializedErrorType {\n    CheckoutButtonNotInitialized,\n    CustomerNotInitialized,\n    PaymentNotInitialized,\n    ShippingNotInitialized,\n    SpamProtectionNotInitialized,\n}\n\n/**\n * Throw this error if a method requires a certain initialization call to be\n * made first. Some objects can be constructed but they cannot be used until a\n * separate initialization call is made.\n */\nexport default class NotInitializedError extends StandardError {\n    constructor(public subtype: NotInitializedErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'NotInitializedError';\n        this.type = 'not_initialized';\n    }\n}\n\nfunction getErrorMessage(type: NotInitializedErrorType): string {\n    switch (type) {\n        case NotInitializedErrorType.CustomerNotInitialized:\n            return 'Unable to proceed because the customer step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.PaymentNotInitialized:\n            return 'Unable to proceed because the payment step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.ShippingNotInitialized:\n            return 'Unable to proceed because the shipping step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.SpamProtectionNotInitialized:\n            return 'Unable to proceed because the checkout spam protection has not been initialized.';\n\n        default:\n            return 'Unable to proceed because the required component has not been initialized.';\n    }\n}\n","import { merge, some } from 'lodash';\n\nimport {\n    HostedForm,\n    isRequestError,\n    isVaultedInstrument,\n    OrderRequestBody,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CardinalClient, { CardinalOrderData } from './cardinal-client';\n\nexport default class CardinalThreeDSecureFlow {\n    constructor(\n        private _paymentIntegrationService: PaymentIntegrationService,\n        private _cardinalClient: CardinalClient,\n    ) {}\n\n    async prepare(method: PaymentMethod): Promise<void> {\n        await this._cardinalClient.load(method.id, method.config.testMode);\n        await this._cardinalClient.configure(await this._getClientToken(method));\n    }\n\n    async start(\n        execute: PaymentStrategy['execute'],\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n        hostedForm?: HostedForm,\n    ): Promise<void> {\n        const { getCardInstrument, getPaymentMethodOrThrow } =\n            this._paymentIntegrationService.getState();\n\n        const { payment: { methodId = '', paymentData = {} } = {} } = payload;\n        const instrument =\n            isVaultedInstrument(paymentData) && getCardInstrument(paymentData.instrumentId);\n        const bin = instrument ? instrument.iin : hostedForm && hostedForm.getBin();\n\n        if (bin) {\n            await this._cardinalClient.runBinProcess(bin);\n        }\n\n        try {\n            return await execute(\n                merge(payload, {\n                    payment: {\n                        paymentData: {\n                            threeDSecure: { token: getPaymentMethodOrThrow(methodId).clientToken },\n                        },\n                    },\n                }),\n                options,\n            );\n        } catch (error) {\n            if (\n                !isRequestError(error) ||\n                !some(error.body.errors, { code: 'three_d_secure_required' })\n            ) {\n                throw error;\n            }\n\n            const threeDSecure = await this._cardinalClient.getThreeDSecureData(\n                error.body.three_ds_result,\n                this._getOrderData(),\n            );\n\n            if (!hostedForm) {\n                await this._paymentIntegrationService.submitPayment(\n                    merge(payload.payment, {\n                        paymentData: { threeDSecure },\n                    }),\n                );\n\n                return;\n            }\n\n            await hostedForm.submit(\n                merge(payload.payment, {\n                    paymentData: { threeDSecure },\n                }),\n            );\n        }\n    }\n\n    private async _getClientToken(method: PaymentMethod): Promise<string> {\n        if (method.clientToken) {\n            return method.clientToken;\n        }\n\n        await this._paymentIntegrationService.loadPaymentMethod(method.id);\n\n        const paymentMethod = this._paymentIntegrationService\n            .getState()\n            .getPaymentMethodOrThrow(method.id);\n\n        return paymentMethod.clientToken || '';\n    }\n\n    private _getOrderData(): CardinalOrderData {\n        const state = this._paymentIntegrationService.getState();\n        const billingAddress = state.getBillingAddressOrThrow();\n        const shippingAddress = state.getShippingAddress();\n        const checkout = state.getCheckoutOrThrow();\n        const order = state.getOrderOrThrow();\n\n        return {\n            billingAddress,\n            shippingAddress,\n            currencyCode: checkout.cart.currency.code,\n            id: order.orderId.toString(),\n            amount: checkout.cart.cartAmount,\n        };\n    }\n}\n","import CustomError from './custom-error';\nimport setPrototypeOf from './set-prototype-of';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a payment method experiences some kind of\n * failure (i.e.: its client library returns a rejected promise). And there is\n * no other error type that is more specific than this one.\n */\nexport default class PaymentMethodFailedError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method has thrown an unexpected error.',\n        );\n\n        this.name = 'PaymentMethodFailedError';\n        this.type = 'payment_method_client_invalid';\n    }\n}\n","import { ThreeDSecure, ThreeDSecureToken } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport const CardinalSignatureValidationErrors = [100004, 1010, 1011, 1020];\n\nexport interface CardinalSDK {\n    configure(params: CardinalConfiguration): void;\n    on(params: CardinalEventType, callback: CardinalEventMap[CardinalEventType]): void;\n    off(params: CardinalEventType): void;\n    setup<K extends keyof CardinalInitializationDataMap>(\n        initializationType: K,\n        initializationData: CardinalInitializationDataMap[K],\n    ): void;\n    trigger(\n        event: CardinalTriggerEvents,\n        data?: string,\n    ): Promise<CardinalBinProcessResponse | void>;\n    continue(\n        paymentBrand: CardinalPaymentBrand,\n        continueObject: CardinalContinue,\n        order: CardinalPartialOrder,\n    ): void;\n    start(paymentBrand: CardinalPaymentBrand, order: CardinalPartialOrder, jwt?: string): void;\n}\n\nexport interface CardinalWindow extends Window {\n    Cardinal?: CardinalSDK;\n}\n\nexport enum CardinalEventType {\n    SetupCompleted = 'payments.setupComplete',\n    Validated = 'payments.validated',\n}\n\nexport type setupCompleteFn = (setupCompleteData: CardinalSetupCompletedData) => void;\nexport type validatedFn = (data: CardinalValidatedData, jwt?: string) => void;\n\nexport interface CardinalEventMap {\n    [CardinalEventType.SetupCompleted]: setupCompleteFn;\n    [CardinalEventType.Validated]: validatedFn;\n}\n\nexport type CardinalConfiguration = Partial<{\n    logging: {\n        level: string;\n    };\n    payment: {\n        view: string;\n        framework: string;\n        displayLoading: boolean;\n    };\n}>;\n\nexport interface CardinalSetupCompletedData {\n    sessionId: string;\n    modules: CardinalModuleState[];\n}\n\nexport interface CardinalModuleState {\n    loaded: boolean;\n    module: string;\n}\n\nexport enum CardinalInitializationType {\n    Init = 'init',\n    Complete = 'complete',\n    Confirm = 'confirm',\n}\n\nexport interface CardinalInitializationDataMap {\n    [CardinalInitializationType.Init]: CardinalInitTypeData;\n    [CardinalInitializationType.Complete]: CardinalCompleteTypeData;\n    [CardinalInitializationType.Confirm]: CardinalConfirmTypeData;\n}\n\nexport interface CardinalInitTypeData {\n    jwt: string;\n}\n\nexport interface CardinalCompleteTypeData {\n    Status: string;\n}\n\nexport interface CardinalConfirmTypeData {\n    jwt: string;\n    cardinalResponseJwt: string;\n}\n\nexport interface CardinalValidatedData {\n    ActionCode?: CardinalValidatedAction;\n    ErrorDescription: string;\n    ErrorNumber: number;\n    Validated?: boolean;\n    Payment?: CardinalPayment;\n}\n\nexport interface CardinalPayment {\n    ExtendedData?: CardinalCCAExtendedData;\n    ProcessorTransactionId: string;\n    Type: CardinalPaymentType;\n}\n\nexport interface CardinalBinProcessResponse {\n    Status: boolean;\n}\n\nexport interface CardinalContinue {\n    AcsUrl: string;\n    Payload: string;\n}\n\nexport interface CardinalPartialOrder {\n    OrderDetails: CardinalOrderDetails;\n    Consumer?: CardinalConsumer;\n}\n\nexport interface CardinalConsumer {\n    Email1?: string;\n    Email2?: string;\n    ShippingAddress?: CardinalAddress;\n    BillingAddress?: CardinalAddress;\n    Account?: CardinalAccount;\n}\n\nexport interface CardinalAccount {\n    AccountNumber: number;\n    ExpirationMonth: number;\n    ExpirationYear: number;\n    NameOnAccount: string;\n    CardCode: number;\n}\n\nexport interface CardinalAddress {\n    FullName?: string;\n    FirstName: string;\n    MiddleName?: string;\n    LastName: string;\n    Address1: string;\n    Address2?: string;\n    Address3?: string;\n    City: string;\n    State: string;\n    PostalCode: string;\n    CountryCode: string;\n    Phone1?: string;\n    Phone2?: string;\n}\n\nexport interface CardinalOrderDetails {\n    OrderNumber: string;\n    Amount: number;\n    CurrencyCode: string;\n    OrderDescription?: string;\n    OrderChannel: string;\n    TransactionId?: string;\n}\n\nexport type CardinalCCAExtendedData = Partial<{\n    CAVV: string;\n    ECIFlag: string;\n    PAResStatus: string;\n    SignatureVerification: string;\n    XID: string;\n    UCAFIndicator: string;\n    ChallengeCancel: string;\n}>;\n\nexport enum CardinalValidatedAction {\n    Success = 'SUCCESS',\n    NoAction = 'NOACTION',\n    Failure = 'FAILURE',\n    Error = 'ERROR',\n}\n\nexport enum CardinalPaymentType {\n    CCA = 'CCA',\n    Paypal = 'Paypal',\n    Wallet = 'Wallet',\n    VisaCheckout = 'VisaCheckout',\n    ApplePay = 'ApplePay',\n    DiscoverWallet = 'DiscoverWallet',\n}\n\nexport enum CardinalTriggerEvents {\n    BinProcess = 'bin.process',\n}\n\nexport enum CardinalPaymentBrand {\n    CCA = 'cca',\n}\n\nexport enum CardinalSignatureVerification {\n    Yes = 'Y',\n    No = 'N',\n}\n\nexport type CardinalThreeDSecureToken = Pick<ThreeDSecure, 'xid'> | ThreeDSecureToken;\n","import { includes, noop } from 'lodash';\n\nimport {\n    Address,\n    BillingAddress,\n    CreditCardInstrument,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    PaymentMethodFailedError,\n    ThreeDSecureToken,\n    ThreeDsResult,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    CardinalAccount,\n    CardinalAddress,\n    CardinalConsumer,\n    CardinalEventType,\n    CardinalInitializationType,\n    CardinalPartialOrder,\n    CardinalPaymentBrand,\n    CardinalSDK,\n    CardinalSignatureValidationErrors,\n    CardinalSignatureVerification,\n    CardinalTriggerEvents,\n    CardinalValidatedAction,\n    CardinalValidatedData,\n} from './cardinal';\nimport CardinalScriptLoader from './cardinal-script-loader';\n\nexport type CardinalSupportedPaymentInstrument = CreditCardInstrument | VaultedInstrument;\n\nexport interface CardinalOrderData {\n    billingAddress: BillingAddress;\n    shippingAddress?: Address;\n    currencyCode: string;\n    id: string;\n    amount: number;\n    paymentData?: CreditCardInstrument;\n}\n\nexport default class CardinalClient {\n    private _provider = '';\n    private _testMode = false;\n    private _sdk?: Promise<CardinalSDK>;\n    private _configurationToken = '';\n\n    constructor(private _scriptLoader: CardinalScriptLoader) {}\n\n    load(provider: string, testMode = false): Promise<void> {\n        this._provider = provider;\n        this._testMode = testMode;\n\n        if (!this._sdk) {\n            this._sdk = this._scriptLoader.load(provider, testMode);\n        }\n\n        return this._sdk.then(noop);\n    }\n\n    configure(clientToken: string): Promise<void> {\n        if (this._configurationToken) {\n            if (this._configurationToken === clientToken) {\n                return Promise.resolve();\n            }\n\n            this._sdk = this._scriptLoader.load(`${this._provider}.${Date.now()}`, this._testMode);\n        }\n\n        return this._getClientSDK().then(\n            (client) =>\n                new Promise<void>((resolve, reject) => {\n                    client.on(CardinalEventType.SetupCompleted, () => {\n                        client.off(CardinalEventType.SetupCompleted);\n                        client.off(CardinalEventType.Validated);\n\n                        this._configurationToken = clientToken;\n\n                        resolve();\n                    });\n\n                    client.on(CardinalEventType.Validated, (data: CardinalValidatedData) => {\n                        client.off(CardinalEventType.SetupCompleted);\n                        client.off(CardinalEventType.Validated);\n\n                        switch (data.ActionCode) {\n                            case CardinalValidatedAction.Error:\n                                if (includes(CardinalSignatureValidationErrors, data.ErrorNumber)) {\n                                    reject(\n                                        new MissingDataError(\n                                            MissingDataErrorType.MissingPaymentMethod,\n                                        ),\n                                    );\n                                }\n\n                                reject(new PaymentMethodFailedError(data.ErrorDescription));\n                                break;\n                        }\n                    });\n\n                    client.setup(CardinalInitializationType.Init, {\n                        jwt: clientToken,\n                    });\n                }),\n        );\n    }\n\n    runBinProcess(binNumber: string): Promise<void> {\n        return this._getClientSDK()\n            .then((client) =>\n                client.trigger(CardinalTriggerEvents.BinProcess, binNumber).catch(noop),\n            )\n            .then((result) => {\n                if (!result || !result.Status) {\n                    throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n                }\n            });\n    }\n\n    getThreeDSecureData(\n        threeDSecureData: ThreeDsResult,\n        orderData: CardinalOrderData,\n    ): Promise<ThreeDSecureToken> {\n        return this._getClientSDK().then((client) => {\n            return new Promise<ThreeDSecureToken>((resolve, reject) => {\n                client.on(\n                    CardinalEventType.Validated,\n                    (data: CardinalValidatedData, jwt?: string) => {\n                        client.off(CardinalEventType.Validated);\n\n                        if (!jwt) {\n                            return reject(\n                                new PaymentMethodFailedError(\n                                    data.ErrorDescription\n                                        ? data.ErrorDescription\n                                        : 'An error was encountered while processing the transaction.',\n                                ),\n                            );\n                        }\n\n                        if (!data.ActionCode) {\n                            return resolve({ token: jwt });\n                        }\n\n                        switch (data.ActionCode) {\n                            case CardinalValidatedAction.Success:\n                                return resolve({ token: jwt });\n\n                            case CardinalValidatedAction.NoAction:\n                                if (data.ErrorNumber > 0) {\n                                    return reject(\n                                        new PaymentMethodFailedError(data.ErrorDescription),\n                                    );\n                                } else if (\n                                    !data.Payment ||\n                                    !data.Payment.ExtendedData ||\n                                    data.Payment.ExtendedData.SignatureVerification !==\n                                        CardinalSignatureVerification.Yes\n                                ) {\n                                    return reject(\n                                        new PaymentMethodFailedError(\n                                            'Transaction signature could not be validated.',\n                                        ),\n                                    );\n                                }\n\n                                return resolve({ token: jwt });\n\n                            case CardinalValidatedAction.Failure:\n                                return reject(\n                                    new PaymentMethodFailedError(\n                                        'User failed authentication or an error was encountered while processing the transaction.',\n                                    ),\n                                );\n\n                            case CardinalValidatedAction.Error:\n                                return reject(new PaymentMethodFailedError(data.ErrorDescription));\n                        }\n                    },\n                );\n\n                const continueObject = {\n                    AcsUrl: threeDSecureData.acs_url,\n                    Payload: threeDSecureData.merchant_data,\n                };\n\n                const partialOrder = this._mapToPartialOrder(\n                    orderData,\n                    threeDSecureData.payer_auth_request,\n                );\n\n                client.continue(CardinalPaymentBrand.CCA, continueObject, partialOrder);\n            });\n        });\n    }\n\n    private _mapToPartialOrder(\n        orderData: CardinalOrderData,\n        transactionId: string,\n    ): CardinalPartialOrder {\n        const consumer: CardinalConsumer = {\n            BillingAddress: this._mapToCardinalAddress(orderData.billingAddress),\n        };\n\n        if (orderData.paymentData) {\n            consumer.Account = this._mapToCardinalAccount(orderData.paymentData);\n        }\n\n        if (orderData.billingAddress.email) {\n            consumer.Email1 = orderData.billingAddress.email;\n        }\n\n        if (orderData.shippingAddress) {\n            consumer.ShippingAddress = this._mapToCardinalAddress(orderData.shippingAddress);\n        }\n\n        return {\n            Consumer: consumer,\n            OrderDetails: {\n                OrderNumber: orderData.id,\n                Amount: orderData.amount,\n                CurrencyCode: orderData.currencyCode,\n                OrderChannel: 'S',\n                TransactionId: transactionId,\n            },\n        };\n    }\n\n    private _mapToCardinalAccount(paymentData: CreditCardInstrument): CardinalAccount {\n        return {\n            AccountNumber: Number(paymentData.ccNumber),\n            ExpirationMonth: Number(paymentData.ccExpiry.month),\n            ExpirationYear: Number(paymentData.ccExpiry.year),\n            NameOnAccount: paymentData.ccName,\n            CardCode: Number(paymentData.ccCvv),\n        };\n    }\n\n    private _mapToCardinalAddress(address: Address): CardinalAddress {\n        const cardinalAddress: CardinalAddress = {\n            FirstName: address.firstName,\n            LastName: address.lastName,\n            Address1: address.address1,\n            City: address.city,\n            State: address.stateOrProvince,\n            PostalCode: address.postalCode,\n            CountryCode: address.countryCode,\n        };\n\n        if (address.address2) {\n            cardinalAddress.Address2 = address.address2;\n        }\n\n        if (address.phone) {\n            cardinalAddress.Phone1 = address.phone;\n        }\n\n        return cardinalAddress;\n    }\n\n    private _getClientSDK(): Promise<CardinalSDK> {\n        if (!this._sdk) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        return this._sdk;\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when the client library of a payment method fails\n * to load, or for some reason, it is inaccessible.\n */\nexport default class PaymentMethodClientUnavailableError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method is not loaded or ready to be used.',\n        );\n\n        this.name = 'PaymentMethodClientUnavailableError';\n        this.type = 'payment_method_client_unavailable';\n    }\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { CardinalSDK, CardinalWindow } from './cardinal';\n\nconst SDK_TEST_URL = 'https://songbirdstag.cardinalcommerce.com/edge/v1/songbird.js';\n\nconst SDK_PROD_URL = 'https://static.client.cardinaltrusted.com/songbird/v2.0.0/songbird.js';\n\nexport default class CardinalScriptLoader {\n    constructor(private _scriptLoader: ScriptLoader, private _window: CardinalWindow = window) {}\n\n    load(provider: string, testMode?: boolean): Promise<CardinalSDK> {\n        const url = testMode ? SDK_TEST_URL : SDK_PROD_URL;\n\n        return this._scriptLoader.loadScript(`${url}?v=${provider}`).then(() => {\n            if (!this._window.Cardinal) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n\n            return this._window.Cardinal;\n        });\n    }\n}\n","import ResolvableModule from './resolvable-module';\n\nexport default function toResolvableModule<TModule, TIdentifier>(\n    module: TModule,\n    resolveIds: TIdentifier[],\n): ResolvableModule<TModule, TIdentifier> {\n    return Object.assign(module, { resolveIds });\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we are trying to make an order finalization request for a\n * payment method that does not require such procedure.\n */\nexport default class OrderFinalizationNotRequiredError extends StandardError {\n    constructor() {\n        super('The current order does not need to be finalized at this stage.');\n\n        this.name = 'OrderFinalizationNotRequiredError';\n        this.type = 'order_finalization_not_required';\n    }\n}\n","import InvalidArgumentError from './invalid-argument-error';\n\n/**\n * This error should be thrown when we are unable to submit a payment because\n * the caller has not provided all the required fields, i.e.: if an argument is\n * missing or it is not the expected data type.\n */\nexport default class PaymentArgumentInvalidError extends InvalidArgumentError {\n    constructor(invalidFields?: string[]) {\n        let message = 'Unable to submit payment for the order because the payload is invalid.';\n\n        if (invalidFields) {\n            message = `${message} Make sure the following fields are provided correctly: ${invalidFields.join(\n                ', ',\n            )}.`;\n        }\n\n        super(message);\n\n        this.name = 'PaymentArgumentInvalidError';\n    }\n}\n","import { isNil, values } from 'lodash';\n\nimport {\n    HostedForm,\n    InvalidArgumentError,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithCreditCardPaymentInitializeOptions } from './credit-card-payment-initialize-options';\n\nexport default class CreditCardPaymentStrategy implements PaymentStrategy {\n    protected _hostedForm?: HostedForm;\n    protected _shouldRenderHostedForm?: boolean;\n\n    constructor(protected _paymentIntegrationService: PaymentIntegrationService) {}\n\n    execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        return this._isHostedPaymentFormEnabled(\n            payload.payment?.methodId,\n            payload.payment?.gatewayId,\n        ) && this._shouldRenderHostedForm\n            ? this._executeWithHostedForm(payload, options)\n            : this._executeWithoutHostedForm(payload, options);\n    }\n\n    initialize(\n        options?: PaymentInitializeOptions & WithCreditCardPaymentInitializeOptions,\n    ): Promise<void> {\n        if (\n            !this._isHostedPaymentFormEnabled(options?.methodId, options?.gatewayId) ||\n            !this._isHostedFieldAvailable(options)\n        ) {\n            this._shouldRenderHostedForm = false;\n\n            return Promise.resolve();\n        }\n\n        const formOptions = options && options.creditCard && options.creditCard.form;\n        const state = this._paymentIntegrationService.getState();\n        const { paymentSettings: { bigpayBaseUrl: host = '' } = {} } =\n            state.getStoreConfigOrThrow();\n\n        if (!formOptions) {\n            throw new InvalidArgumentError();\n        }\n\n        const form = this._paymentIntegrationService.createHostedForm(host, formOptions);\n\n        return form.attach().then(() => {\n            this._shouldRenderHostedForm = true;\n            this._hostedForm = form;\n\n            return Promise.resolve();\n        });\n    }\n\n    deinitialize(): Promise<void> {\n        if (this._hostedForm) {\n            this._hostedForm.detach();\n        }\n\n        return Promise.resolve();\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    protected async _executeWithoutHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const paymentData = payment && payment.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        await this._paymentIntegrationService.submitPayment({ ...payment, paymentData });\n    }\n\n    protected async _executeWithHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const form = this._hostedForm;\n\n        if (!form) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        if (!payment || !payment.methodId) {\n            throw new PaymentArgumentInvalidError(['payment.methodId']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        await form.validate().then(() => form.submit(payment));\n    }\n\n    protected _isHostedPaymentFormEnabled(methodId?: string, gatewayId?: string): boolean {\n        if (!methodId) {\n            return false;\n        }\n\n        const state = this._paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(methodId, gatewayId);\n\n        return paymentMethod.config.isHostedFormEnabled === true;\n    }\n\n    private _isHostedFieldAvailable(\n        options?: PaymentInitializeOptions & WithCreditCardPaymentInitializeOptions,\n    ): boolean {\n        return !values(options && options.creditCard && options.creditCard.form.fields).every(\n            isNil,\n        );\n    }\n}\n","import { CardinalThreeDSecureFlow } from '@bigcommerce/checkout-sdk/cardinal-integration';\nimport { CreditCardPaymentStrategy } from '@bigcommerce/checkout-sdk/credit-card-integration';\nimport {\n    OrderRequestBody,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default class CyberSourcePaymentStrategy extends CreditCardPaymentStrategy {\n    constructor(\n        _paymentIntegrationService: PaymentIntegrationService,\n        private _threeDSecureFlow: CardinalThreeDSecureFlow,\n    ) {\n        super(_paymentIntegrationService);\n    }\n\n    async initialize(options: PaymentInitializeOptions): Promise<void> {\n        await super.initialize(options);\n\n        const { getPaymentMethodOrThrow } = this._paymentIntegrationService.getState();\n        const paymentMethod = getPaymentMethodOrThrow(options.methodId);\n\n        if (paymentMethod.config.is3dsEnabled) {\n            await this._threeDSecureFlow.prepare(paymentMethod);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment: { methodId = '' } = {} } = payload;\n        const { getPaymentMethodOrThrow } = this._paymentIntegrationService.getState();\n        const paymentMethod = getPaymentMethodOrThrow(methodId);\n\n        if (paymentMethod.config.is3dsEnabled) {\n            return this._threeDSecureFlow.start(\n                super.execute.bind(this),\n                payload,\n                options,\n                this._hostedForm,\n            );\n        }\n\n        return super.execute(payload, options);\n    }\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CardinalClient,\n    CardinalScriptLoader,\n    CardinalThreeDSecureFlow,\n} from '@bigcommerce/checkout-sdk/cardinal-integration';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CyberSourcePaymentStrategy from './cybersource-payment-strategy';\n\nconst createCyberSourcePaymentStrategy: PaymentStrategyFactory<CyberSourcePaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new CyberSourcePaymentStrategy(\n        paymentIntegrationService,\n        new CardinalThreeDSecureFlow(\n            paymentIntegrationService,\n            new CardinalClient(new CardinalScriptLoader(getScriptLoader())),\n        ),\n    );\n};\n\nexport default toResolvableModule(createCyberSourcePaymentStrategy, [{ id: 'cybersource' }]);\n","import { merge, some } from 'lodash';\n\nimport {\n    HostedForm,\n    isCreditCardInstrument,\n    isRequestError,\n    isVaultedInstrument,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    PaymentIntegrationSelectors,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { CardinalThreeDSecureToken } from './cardinal';\nimport CardinalClient, { CardinalOrderData } from './cardinal-client';\n\nexport default class CardinalThreeDSecureFlowV2 {\n    constructor(\n        private _paymentIntegrationService: PaymentIntegrationService,\n        private _cardinalClient: CardinalClient,\n    ) {}\n\n    async prepare(method: PaymentMethod): Promise<void> {\n        await this._cardinalClient.load(method.id, method.config.testMode);\n    }\n\n    async start(\n        execute: PaymentStrategy['execute'],\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n        hostedForm?: HostedForm,\n    ): Promise<void> {\n        const { getCardInstrument } = this._paymentIntegrationService.getState();\n        const { payment = { methodId: '' } } = payload;\n        const { paymentData = {} } = payment;\n\n        try {\n            return await execute(payload, options);\n        } catch (error) {\n            if (isRequestError(error) && error.body?.status === 'additional_action_required') {\n                const token = error.body.additional_action_required?.data?.token;\n                const xid = error.body.three_ds_result?.payer_auth_request;\n\n                await this._cardinalClient.configure(token);\n\n                const bin = this._getBin(paymentData, getCardInstrument, hostedForm);\n\n                if (bin) {\n                    await this._cardinalClient.runBinProcess(bin);\n                }\n\n                try {\n                    return await this._submitPayment(payment, { xid }, hostedForm);\n                } catch (err) {\n                    if (\n                        isRequestError(err) &&\n                        some(err.body.errors, { code: 'three_d_secure_required' })\n                    ) {\n                        const threeDsResult = err.body.three_ds_result;\n                        const threeDsToken = threeDsResult?.payer_auth_request;\n\n                        await this._cardinalClient.getThreeDSecureData(\n                            threeDsResult,\n                            this._getOrderData(),\n                        );\n\n                        return this._submitPayment(payment, { token: threeDsToken }, hostedForm);\n                    }\n\n                    throw err;\n                }\n            }\n\n            throw error;\n        }\n    }\n\n    private _getOrderData(): CardinalOrderData {\n        const store = this._paymentIntegrationService.getState();\n        const billingAddress = store.getBillingAddressOrThrow();\n        const shippingAddress = store.getShippingAddress();\n        const {\n            cart: {\n                currency: { code: currencyCode },\n                cartAmount: amount,\n            },\n        } = store.getCheckoutOrThrow();\n        const id = store.getOrderOrThrow().orderId.toString();\n\n        return { billingAddress, shippingAddress, currencyCode, id, amount };\n    }\n\n    private async _submitPayment(\n        payment: OrderPaymentRequestBody,\n        threeDSecure: CardinalThreeDSecureToken,\n        hostedForm?: HostedForm,\n    ): Promise<void> {\n        const paymentPayload = merge({}, payment, { paymentData: { threeDSecure } });\n\n        if (!hostedForm) {\n            await this._paymentIntegrationService.submitPayment(paymentPayload);\n        }\n\n        await hostedForm?.submit(paymentPayload);\n    }\n\n    private _getBin(\n        paymentData: NonNullable<OrderPaymentRequestBody['paymentData']>,\n        getCardInstrument: PaymentIntegrationSelectors['getCardInstrument'],\n        hostedForm?: HostedForm,\n    ): string {\n        const instrument =\n            isVaultedInstrument(paymentData) && getCardInstrument(paymentData.instrumentId);\n        const ccNumber = isCreditCardInstrument(paymentData) && paymentData.ccNumber;\n        const hostedFormBin = hostedForm ? hostedForm.getBin() : ccNumber;\n        const bin = instrument ? instrument.iin : hostedFormBin;\n\n        return bin || '';\n    }\n}\n","import isVaultedInstrument from './is-vaulted-instrument';\nimport { CreditCardInstrument } from './payment';\n\nexport default function isCreditCardInstrument(\n    instrument: unknown,\n): instrument is CreditCardInstrument {\n    const card = instrument as CreditCardInstrument;\n\n    return (\n        !isVaultedInstrument(card) &&\n        typeof card.ccName === 'string' &&\n        typeof card.ccNumber === 'string' &&\n        typeof card.ccExpiry === 'object' &&\n        typeof card.ccExpiry.month === 'string' &&\n        typeof card.ccExpiry.year === 'string'\n    );\n}\n","import { CardinalThreeDSecureFlowV2 } from '@bigcommerce/checkout-sdk/cardinal-integration';\nimport { CreditCardPaymentStrategy } from '@bigcommerce/checkout-sdk/credit-card-integration';\nimport {\n    OrderRequestBody,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default class CyberSourceV2PaymentStrategy extends CreditCardPaymentStrategy {\n    constructor(\n        _paymentIntegrationService: PaymentIntegrationService,\n        private _threeDSecureFlow: CardinalThreeDSecureFlowV2,\n    ) {\n        super(_paymentIntegrationService);\n    }\n\n    async initialize(options: PaymentInitializeOptions): Promise<void> {\n        await super.initialize(options);\n\n        const { getPaymentMethodOrThrow } = this._paymentIntegrationService.getState();\n        const paymentMethod = getPaymentMethodOrThrow(options.methodId);\n\n        if (paymentMethod.config.is3dsEnabled) {\n            await this._threeDSecureFlow.prepare(paymentMethod);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment: { methodId = '' } = {} } = payload;\n        const { getPaymentMethodOrThrow } = this._paymentIntegrationService.getState();\n        const paymentMethod = getPaymentMethodOrThrow(methodId);\n\n        if (paymentMethod.config.is3dsEnabled) {\n            return this._threeDSecureFlow.start(\n                super.execute.bind(this),\n                payload,\n                options,\n                this._hostedForm,\n            );\n        }\n\n        return super.execute(payload, options);\n    }\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CardinalClient,\n    CardinalScriptLoader,\n    CardinalThreeDSecureFlowV2,\n} from '@bigcommerce/checkout-sdk/cardinal-integration';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CyberSourceV2PaymentStrategy from './cybersourcev2-payment-strategy';\n\nconst createCyberSourceV2PaymentStrategy: PaymentStrategyFactory<CyberSourceV2PaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new CyberSourceV2PaymentStrategy(\n        paymentIntegrationService,\n        new CardinalThreeDSecureFlowV2(\n            paymentIntegrationService,\n            new CardinalClient(new CardinalScriptLoader(getScriptLoader())),\n        ),\n    );\n};\n\nexport default toResolvableModule(createCyberSourceV2PaymentStrategy, [\n    { id: 'cybersourcev2' },\n    { id: 'bnz' },\n]);\n","import { noop } from 'lodash';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { getAppliedStyles } from '@bigcommerce/checkout/dom-utils';\nimport { FormContext } from '@bigcommerce/checkout/ui';\n\nimport { FormFieldContainer, TextInput } from '../../ui/form';\n\nexport enum CreditCardInputStylesType {\n    Default = 'default',\n    Error = 'error',\n    Focus = 'focus',\n}\n\nexport default function getCreditCardInputStyles(\n    containerId: string,\n    properties: string[],\n    type: CreditCardInputStylesType = CreditCardInputStylesType.Default,\n): Promise<{ [key: string]: string }> {\n    const container = document.createElement('div');\n    const parentContainer = document.getElementById(containerId);\n\n    if (!parentContainer) {\n        throw new Error(\n            'Unable to retrieve input styles as the provided container ID is not valid.',\n        );\n    }\n\n    parentContainer.appendChild(container);\n\n    return new Promise((resolve) => {\n        const callbackRef = (element: HTMLInputElement | null) => {\n            if (!element) {\n                return;\n            }\n\n            resolve(getAppliedStyles(element, properties));\n\n            ReactDOM.unmountComponentAtNode(container);\n\n            if (container.parentElement) {\n                container.parentElement.removeChild(container);\n            }\n        };\n\n        ReactDOM.render(\n            <FormContext.Provider value={{ isSubmitted: true, setSubmitted: noop }}>\n                <FormFieldContainer hasError={type === CreditCardInputStylesType.Error}>\n                    <TextInput\n                        appearFocused={type === CreditCardInputStylesType.Focus}\n                        ref={callbackRef}\n                    />\n                </FormFieldContainer>\n            </FormContext.Provider>,\n            container,\n        );\n    });\n}\n","import { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\n\nexport interface CreditCardCustomerCodeFieldProps {\n    name: string;\n}\n\nconst CreditCardCustomerCodeField: FunctionComponent<CreditCardCustomerCodeFieldProps> = ({\n    name,\n}) => {\n    const renderInput = useCallback(\n        ({ field }: FieldProps) => <TextInput {...field} id={field.name} />,\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => (\n            <>\n                <TranslatedString id=\"payment.credit_card_customer_code_label\" />{' '}\n                <small className=\"optimizedCheckout-contentSecondary\">\n                    <TranslatedString id=\"common.optional_text\" />\n                </small>\n            </>\n        ),\n        [],\n    );\n\n    return <FormField input={renderInput} labelContent={labelContent} name={name} />;\n};\n\nexport default memo(CreditCardCustomerCodeField);\n","import { type CardInstrument } from '@bigcommerce/checkout-sdk';\nimport { expirationDate } from 'card-validator';\nimport classNames from 'classnames';\nimport creditCardType from 'credit-card-type';\nimport { type FieldProps } from 'formik';\nimport { find, noop } from 'lodash';\nimport React, { type FunctionComponent, PureComponent, type ReactNode, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { CreditCardIcon } from '@bigcommerce/checkout/ui';\n\nimport { DropdownTrigger } from '../../ui/dropdown';\n\nimport mapFromInstrumentCardType from './mapFromInstrumentCardType';\n\nexport interface InstrumentSelectProps extends FieldProps<string> {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nexport interface InstrumentSelectValues {\n    instrumentId: string;\n}\n\nclass InstrumentSelect extends PureComponent<InstrumentSelectProps> {\n    componentDidMount() {\n        const { selectedInstrumentId } = this.props;\n\n        // FIXME: Used setTimeout here because setFieldValue call doesnot set value if called before formik is properly mounted.\n        //        This ensures that update Field value is called after formik has mounted.\n        // See GitHub issue: https://github.com/jaredpalmer/formik/issues/930\n        setTimeout(() => this.updateFieldValue(selectedInstrumentId));\n    }\n\n    componentDidUpdate(prevProps: Readonly<InstrumentSelectProps>) {\n        const { selectedInstrumentId: prevSelectedInstrumentId } = prevProps;\n        const { selectedInstrumentId } = this.props;\n\n        if (prevSelectedInstrumentId !== selectedInstrumentId) {\n            this.updateFieldValue(selectedInstrumentId);\n        }\n    }\n\n    componentWillUnmount() {\n        const { selectedInstrumentId, field } = this.props;\n\n        if (field.value === '' && selectedInstrumentId !== undefined) {\n            this.updateFieldValue();\n        }\n    }\n\n    render(): ReactNode {\n        const {\n            field,\n            instruments,\n            onSelectInstrument,\n            onUseNewInstrument,\n            selectedInstrumentId,\n            shouldHideExpiryDate = false,\n        } = this.props;\n\n        const selectedInstrument = find(instruments, { bigpayToken: selectedInstrumentId });\n\n        return (\n            <div className=\"instrumentSelect\">\n                <DropdownTrigger\n                    dropdown={\n                        <InstrumentMenu\n                            instruments={instruments}\n                            onSelectInstrument={onSelectInstrument}\n                            onUseNewInstrument={onUseNewInstrument}\n                            selectedInstrumentId={selectedInstrumentId}\n                            shouldHideExpiryDate={shouldHideExpiryDate}\n                        />\n                    }\n                >\n                    <InstrumentSelectButton\n                        instrument={selectedInstrument}\n                        shouldHideExpiryDate={shouldHideExpiryDate}\n                        testId=\"instrument-select\"\n                    />\n\n                    <input type=\"hidden\" {...field} />\n                </DropdownTrigger>\n            </div>\n        );\n    }\n\n    private updateFieldValue(instrumentId = ''): void {\n        const { form, field } = this.props;\n\n        form.setFieldValue(field.name, instrumentId);\n    }\n}\n\ninterface InstrumentMenuProps {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nconst InstrumentMenu: FunctionComponent<InstrumentMenuProps> = ({\n    instruments,\n    selectedInstrumentId,\n    shouldHideExpiryDate = false,\n    onSelectInstrument,\n    onUseNewInstrument,\n}) => {\n    return (\n        <ul\n            className=\"instrumentSelect-dropdownMenu instrumentSelect-dropdownMenuNext dropdown-menu\"\n            data-test=\"instrument-select-menu\"\n        >\n            {instruments.map((instrument) => (\n                <li\n                    className={classNames('instrumentSelect-option dropdown-menu-item', {\n                        'instrumentSelect-option--selected':\n                            instrument.bigpayToken === selectedInstrumentId,\n                    })}\n                    key={instrument.bigpayToken}\n                >\n                    <InstrumentOption\n                        instrument={instrument}\n                        onClick={onSelectInstrument}\n                        shouldHideExpiryDate={shouldHideExpiryDate}\n                        testId=\"instrument-select-option\"\n                    />\n                </li>\n            ))}\n\n            <li className=\"instrumentSelect-option instrumentSelect-option--addNew dropdown-menu-item\">\n                <InstrumentUseNewButton\n                    onClick={onUseNewInstrument}\n                    testId=\"instrument-select-option-use-new\"\n                />\n            </li>\n        </ul>\n    );\n};\n\ninterface InstrumentSelectButtonProps {\n    instrument?: CardInstrument;\n    shouldHideExpiryDate?: boolean;\n    testId?: string;\n    onClick?(): void;\n}\n\nconst InstrumentSelectButton: FunctionComponent<InstrumentSelectButtonProps> = ({\n    instrument,\n    shouldHideExpiryDate = false,\n    testId,\n    onClick,\n}) => {\n    if (!instrument) {\n        return (\n            <InstrumentUseNewButton\n                className=\"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input\"\n                testId={testId}\n            />\n        );\n    }\n\n    return (\n        <InstrumentMenuItem\n            className=\"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input\"\n            instrument={instrument}\n            onClick={onClick}\n            shouldHideExpiryDate={shouldHideExpiryDate}\n            testId={testId}\n        />\n    );\n};\n\ninterface InstrumentOptionProps {\n    instrument: CardInstrument;\n    testId?: string;\n    shouldHideExpiryDate?: boolean;\n    onClick?(token: string): void;\n}\n\nconst InstrumentOption: FunctionComponent<InstrumentOptionProps> = ({\n    instrument,\n    shouldHideExpiryDate = false,\n    onClick = noop,\n}) => {\n    const handleClick = useCallback(() => {\n        onClick(instrument.bigpayToken);\n    }, [onClick, instrument]);\n\n    return (\n        <InstrumentMenuItem\n            instrument={instrument}\n            onClick={handleClick}\n            shouldHideExpiryDate={shouldHideExpiryDate}\n            testId=\"instrument-select-option\"\n        />\n    );\n};\n\ninterface InstrumentMenuItemProps {\n    className?: string;\n    instrument: CardInstrument;\n    testId?: string;\n    shouldHideExpiryDate?: boolean;\n    onClick?(): void;\n}\n\nconst InstrumentMenuItem: FunctionComponent<InstrumentMenuItemProps> = ({\n    className,\n    instrument,\n    testId,\n    shouldHideExpiryDate = false,\n    onClick,\n}) => {\n    const cardType = mapFromInstrumentCardType(instrument.brand);\n    const cardInfo = creditCardType.getTypeInfo(cardType);\n    const isExpired = !expirationDate({\n        month: instrument.expiryMonth,\n        year: instrument.expiryYear,\n    }).isValid;\n\n    return (\n        <button className={className} data-test={testId} onClick={onClick} type=\"button\">\n            <div\n                className={classNames('instrumentSelect-details', {\n                    'instrumentSelect-details--expired': isExpired,\n                })}\n            >\n                <CreditCardIcon cardType={cardType} />\n\n                <div className=\"instrumentSelect-card\" data-test={`${testId}-last4`}>\n                    {cardInfo ? (\n                        <TranslatedString\n                            data={{ cardTitle: cardInfo.niceType, endingIn: instrument.last4 }}\n                            id=\"payment.instrument_ending_in_text\"\n                        />\n                    ) : (\n                        <TranslatedString\n                            data={{ endingIn: instrument.last4 }}\n                            id=\"payment.instrument_default_ending_in_text\"\n                        />\n                    )}\n                </div>\n\n                {!shouldHideExpiryDate && (\n                    <div\n                        className={classNames('instrumentSelect-expiry', {\n                            'instrumentSelect-expiry--expired': isExpired,\n                        })}\n                        data-test={`${testId}-expiry`}\n                    >\n                        {isExpired ? (\n                            <TranslatedString\n                                data={{\n                                    expiryDate: `${instrument.expiryMonth}/${instrument.expiryYear}`,\n                                }}\n                                id=\"payment.instrument_expired_text\"\n                            />\n                        ) : (\n                            <TranslatedString\n                                data={{\n                                    expiryDate: `${instrument.expiryMonth}/${instrument.expiryYear}`,\n                                }}\n                                id=\"payment.instrument_expires_text\"\n                            />\n                        )}\n                    </div>\n                )}\n            </div>\n        </button>\n    );\n};\n\ninterface InstrumentUseNewButtonProps {\n    className?: string;\n    testId?: string;\n    onClick?(): void;\n}\n\nconst InstrumentUseNewButton: FunctionComponent<InstrumentUseNewButtonProps> = ({\n    className,\n    testId,\n    onClick = noop,\n}) => (\n    <button className={className} data-test={testId} onClick={onClick} type=\"button\">\n        <div className=\"instrumentSelect-details instrumentSelect-details--addNew\">\n            <CreditCardIcon />\n\n            <div className=\"instrumentSelect-card\">\n                <TranslatedString id=\"payment.instrument_add_card_action\" />\n            </div>\n        </div>\n    </button>\n);\n\nexport default InstrumentSelect;\n","import { type CardInstrument } from '@bigcommerce/checkout-sdk';\nimport { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { BasicFormField, Fieldset, Legend } from '../../ui/form';\nimport { ModalTrigger, type ModalTriggerModalProps } from '../../ui/modal';\n\nimport InstrumentSelect from './InstrumentSelect';\nimport ManageInstrumentsModal from './ManageInstrumentsModal';\n\nexport interface CardInstrumentFieldsetProps {\n    instruments: CardInstrument[];\n    selectedInstrumentId?: string;\n    shouldHideExpiryDate?: boolean;\n    validateInstrument?: React.ReactNode;\n    onDeleteInstrument?(instrumentId: string): void;\n    onSelectInstrument(id: string): void;\n    onUseNewInstrument(): void;\n}\n\nexport enum UntrustedShippingCardVerificationType {\n    CVV = 'cvv',\n    PAN = 'pan'\n}\n\nconst CardInstrumentFieldset: FunctionComponent<CardInstrumentFieldsetProps> = ({\n    instruments,\n    onDeleteInstrument,\n    onSelectInstrument,\n    onUseNewInstrument,\n    selectedInstrumentId,\n    shouldHideExpiryDate = false,\n    validateInstrument = null,\n}) => {\n    const renderInput = useCallback(\n        (field: FieldProps<string>) => (\n            <InstrumentSelect\n                {...field}\n                instruments={instruments}\n                onSelectInstrument={onSelectInstrument}\n                onUseNewInstrument={onUseNewInstrument}\n                selectedInstrumentId={selectedInstrumentId}\n                shouldHideExpiryDate={shouldHideExpiryDate}\n            />\n        ),\n        [\n            instruments,\n            onSelectInstrument,\n            onUseNewInstrument,\n            selectedInstrumentId,\n            shouldHideExpiryDate,\n        ],\n    );\n\n    const renderModal = useCallback(\n        (props: ModalTriggerModalProps) => (\n            <ManageInstrumentsModal\n                instruments={instruments}\n                onDeleteInstrument={onDeleteInstrument}\n                {...props}\n            />\n        ),\n        [instruments, onDeleteInstrument],\n    );\n\n    return (\n        <Fieldset\n            additionalClassName=\"instrumentFieldset\"\n            legend={\n                <Legend hidden>\n                    <TranslatedString id=\"payment.instrument_text\" />\n                </Legend>\n            }\n        >\n            <ModalTrigger modal={renderModal}>\n                {({ onClick }) => (\n                    <button className=\"instrumentModal-trigger\" onClick={onClick} type=\"button\">\n                        <TranslatedString id=\"payment.instrument_manage_button\" />\n                    </button>\n                )}\n            </ModalTrigger>\n\n            <BasicFormField name=\"instrumentId\" render={renderInput} />\n\n            <div style={{ display: selectedInstrumentId ? undefined : 'none' }}>\n                {validateInstrument}\n            </div>\n        </Fieldset>\n    );\n};\n\nexport default memo(CardInstrumentFieldset);\n","import { type LineItemMap, type PaymentInstrument, type PaymentMethod } from '@bigcommerce/checkout-sdk';\n\nimport { UntrustedShippingCardVerificationType } from './CardInstrumentFieldset';\n\nexport const PROVIDERS_WITHOUT_CARD_CODE = ['bluesnapdirect'];\n\nexport interface IsInstrumentCardCodeRequiredState {\n    instrument: PaymentInstrument;\n    lineItems: LineItemMap;\n    paymentMethod: PaymentMethod;\n}\n\nexport default function isInstrumentCardCodeRequired({\n    instrument,\n    lineItems,\n    paymentMethod,\n}: IsInstrumentCardCodeRequiredState): boolean {\n    if (PROVIDERS_WITHOUT_CARD_CODE.includes(instrument.provider)) {\n        return false;\n    }\n\n    // If there's a digital item in the cart, always show CVV field\n    if (lineItems.digitalItems.length > 0 || lineItems.giftCertificates.length > 0) {\n        return true;\n    }\n\n    // If the shipping address is trusted, show CVV field based on the merchant's configuration\n    if (instrument.trustedShippingAddress) {\n        return !!paymentMethod.config.isVaultingCvvEnabled;\n    }\n\n    // If the shipping address is untrusted, card verficiation mode has set with cvv, card code is required\n    if ('untrustedShippingCardVerificationMode' in instrument && instrument.untrustedShippingCardVerificationMode === UntrustedShippingCardVerificationType.CVV) {\n        return true;\n    }\n\n    // Otherwise, if the shipping address is untrusted, show CVV field if the\n    // merchant either requires it for regular card or stored card payments.\n    return !!(paymentMethod.config.isVaultingCvvEnabled || paymentMethod.config.cardCode);\n}\n","import { type CheckoutSelectors, type Instrument, type PaymentMethod } from '@bigcommerce/checkout-sdk';\nimport { createSelector } from 'reselect';\n\nimport isInstrumentCardCodeRequired from './isInstrumentCardCodeRequired';\n\nconst isInstrumentCardCodeRequiredSelector = createSelector(\n    ({ data }: CheckoutSelectors) => {\n        const cart = data.getCart();\n\n        return cart && cart.lineItems;\n    },\n    (lineItems) => (instrument: Instrument, method: PaymentMethod) => {\n        if (!lineItems) {\n            return false;\n        }\n\n        return isInstrumentCardCodeRequired({\n            instrument,\n            lineItems,\n            paymentMethod: method,\n        });\n    },\n);\n\nexport default isInstrumentCardCodeRequiredSelector;\n","import { type CheckoutSelectors, type Instrument } from '@bigcommerce/checkout-sdk';\nimport { createSelector } from 'reselect';\n\nimport isInstrumentCardNumberRequired from './isInstrumentCardNumberRequired';\n\nconst isInstrumentCardNumberRequiredSelector = createSelector(\n    ({ data }: CheckoutSelectors) => {\n        const cart = data.getCart();\n\n        return cart && cart.lineItems;\n    },\n    (lineItems) => (instrument: Instrument) => {\n        if (!lineItems) {\n            return false;\n        }\n\n        return isInstrumentCardNumberRequired({\n            lineItems,\n            instrument,\n        });\n    },\n);\n\nexport default isInstrumentCardNumberRequiredSelector;\n","import { type Instrument, type LineItemMap } from '@bigcommerce/checkout-sdk';\n\nimport { UntrustedShippingCardVerificationType } from './CardInstrumentFieldset';\n\nexport interface IsInstrumentCardNumberRequiredState {\n    lineItems: LineItemMap;\n    instrument: Instrument;\n}\n\nexport default function isInstrumentCardNumberRequired({\n    lineItems,\n    instrument,\n}: IsInstrumentCardNumberRequiredState): boolean {\n    if (lineItems.physicalItems.length === 0) {\n        return false;\n    }\n\n    if (instrument.trustedShippingAddress) {\n        return false;\n    }  \n    \n    return !(instrument.untrustedShippingCardVerificationMode === UntrustedShippingCardVerificationType.CVV);\n}\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { object, type ObjectSchema, string } from 'yup';\n\nexport interface HostedCreditCardValidationSchemaOptions {\n    language: LanguageService;\n}\n\nexport interface HostedCreditCardValidationSchemaShape {\n    hostedForm: {\n        errors: {\n            cardCode: string;\n            cardExpiry: string;\n            cardName: string;\n            cardNumber: string;\n        };\n    };\n}\n\nexport default memoize(function getHostedCreditCardValidationSchema({\n    language,\n}: HostedCreditCardValidationSchemaOptions): ObjectSchema<HostedCreditCardValidationSchemaShape> {\n    return object().shape<HostedCreditCardValidationSchemaShape>({\n        hostedForm: object().required().shape<HostedCreditCardValidationSchemaShape[\"hostedForm\"]>({\n            errors: object().required().shape<HostedCreditCardValidationSchemaShape[\"hostedForm\"][\"errors\"]>({\n                cardCode: string()\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_invalid_error'),\n                        test: (value) => value !== 'invalid_card_code',\n                    }),\n\n                cardExpiry: string()\n                    .test({\n                        message: language.translate(\n                            'payment.credit_card_expiration_required_error',\n                        ),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_expiration_invalid_error'),\n                        test: (value) => value !== 'invalid_card_expiry',\n                    }),\n\n                cardName: string()\n                    .test({\n                        message: language.translate('payment.credit_card_name_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_name_invalid_error'),\n                        test: (value) => value !== 'invalid_card_name',\n                    }),\n\n                cardNumber: string()\n                    .test({\n                        message: language.translate('payment.credit_card_number_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_number_invalid_error'),\n                        test: (value) => value !== 'invalid_card_number',\n                    }),\n            }),\n        }),\n    });\n});\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { object, type ObjectSchema, string } from 'yup';\n\nexport interface HostedInstrumentValidationSchemaOptions {\n    language: LanguageService;\n    isCardExpiryRequired?: boolean;\n}\n\nexport interface HostedInstrumentValidationSchemaShape {\n    hostedForm: {\n        errors: {\n            cardCodeVerification: string;\n            cardNumberVerification: string;\n        };\n    };\n    instrumentId: string;\n}\n\nexport default memoize(function getHostedInstrumentValidationSchema({\n    language,\n    isCardExpiryRequired,\n}: HostedInstrumentValidationSchemaOptions): ObjectSchema<HostedInstrumentValidationSchemaShape> {\n    return object().shape<HostedInstrumentValidationSchemaShape>({\n        instrumentId: string().required(),\n\n        hostedForm: object().required().shape<HostedInstrumentValidationSchemaShape[\"hostedForm\"]>({\n            errors: object().required().shape<HostedInstrumentValidationSchemaShape[\"hostedForm\"][\"errors\"]>({\n                cardCodeVerification: string()\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_cvv_invalid_error'),\n                        test: (value) => value !== 'invalid_card_code',\n                    }),\n\n                cardNumberVerification: string()\n                    .test({\n                        message: language.translate('payment.credit_card_number_required_error'),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_number_invalid_error'),\n                        test: (value) => value !== 'invalid_card_number',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_number_mismatch_error'),\n                        test: (value) => value !== 'mismatched_card_number',\n                    }),\n\n            ...(isCardExpiryRequired ? {\n                cardExpiryVerification: string()\n                    .test({\n                        message: language.translate(\n                            'payment.credit_card_expiration_required_error',\n                        ),\n                        test: (value) => value !== 'required',\n                    })\n                    .test({\n                        message: language.translate('payment.credit_card_expiration_invalid_error'),\n                        test: (value) => value !== 'invalid_card_expiry',\n                    }),\n            } : {})\n            }),\n        }),\n    });\n});\n","import classNames from 'classnames';\nimport React, { type FunctionComponent, type HTMLAttributes } from 'react';\n\nexport interface TextInputIframeContainerProps extends HTMLAttributes<HTMLDivElement> {\n    additionalClassName?: string;\n    appearFocused?: boolean;\n    testId?: string;\n}\n\nconst TextInputIframeContainer: FunctionComponent<TextInputIframeContainerProps> = ({\n    additionalClassName,\n    appearFocused,\n    testId,\n    ...props\n}) => (\n    <div\n        {...props}\n        className={classNames(\n            'form-input',\n            'optimizedCheckout-form-input',\n            { 'form-input--focus': appearFocused },\n            { 'optimizedCheckout-form-input--focus': appearFocused },\n            additionalClassName,\n        )}\n        data-test={testId}\n    />\n);\n\nexport default TextInputIframeContainer;\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconLock: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconLock);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconHelp: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconHelp);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconCardCodeVisa: FunctionComponent = () => (\n    <svg height=\"54\" viewBox=\"0 0 88 54\" width=\"88\" xmlns=\"http://www.w3.org/2000/svg\">\n        <title>CVV visa, mc, disc</title>\n        <g fill=\"none\" fillRule=\"evenodd\">\n            <rect fill=\"#DEDEDE\" height=\"54\" rx=\"3\" width=\"88\" />\n            <path d=\"M0 5h88v12H0z\" fill=\"#838383\" />\n            <path d=\"M3 23h82v10H3z\" fill=\"#FFF\" />\n            <path\n                d=\"M69.81 29.053c.015.297.13.502.343.616.11.058.233.088.37.088.258 0 .477-.107.66-.32.18-.215.31-.65.384-1.306-.12.19-.267.322-.444.4-.176.076-.366.114-.57.114-.412 0-.74-.13-.98-.386-.24-.257-.36-.588-.36-.993 0-.388.12-.73.357-1.025.237-.295.587-.443 1.05-.443.623 0 1.054.28 1.29.842.133.31.2.696.2 1.16 0 .525-.08.99-.238 1.394-.26.674-.703 1.01-1.327 1.01-.42 0-.737-.11-.954-.328-.217-.22-.325-.494-.325-.825h.544zm1.4-1.09c.176-.14.265-.387.265-.737 0-.315-.08-.55-.238-.705-.16-.153-.36-.23-.606-.23-.262 0-.47.088-.625.264-.155.177-.232.412-.232.707 0 .28.068.502.203.667.136.164.352.246.65.246.213 0 .408-.07.584-.21zm3.414-.563c.133-.132.2-.29.2-.474 0-.16-.064-.306-.19-.44-.13-.133-.323-.2-.585-.2-.26 0-.447.067-.563.2-.115.134-.173.29-.173.47 0 .202.075.36.224.473.15.112.326.17.53.17.237 0 .422-.067.556-.2zm.097 2.118c.165-.135.247-.336.247-.603 0-.277-.084-.487-.254-.63-.17-.144-.386-.216-.652-.216-.256 0-.466.072-.628.22-.163.145-.244.348-.244.607 0 .223.074.416.223.58.15.16.38.243.69.243.25 0 .456-.068.62-.202zm-1.735-1.937c-.158-.158-.236-.365-.236-.62 0-.32.114-.594.345-.823.232-.23.56-.344.984-.344.41 0 .732.108.965.325.233.216.35.47.35.758 0 .267-.068.483-.203.65-.076.092-.194.184-.353.274.176.08.316.175.418.28.19.2.284.46.284.778 0 .377-.127.697-.38.96-.253.26-.61.392-1.074.392-.416 0-.77-.113-1.057-.34-.287-.226-.43-.554-.43-.985 0-.253.06-.472.184-.656.124-.186.307-.327.55-.424-.15-.064-.265-.14-.35-.225zm5.614-1.42c.188.248.282.503.282.766h-.532c-.032-.17-.083-.302-.153-.397-.13-.18-.326-.27-.59-.27-.3 0-.54.14-.717.417-.177.278-.276.676-.296 1.194.124-.18.28-.316.467-.405.172-.08.364-.12.575-.12.36 0 .672.115.94.344.266.228.4.57.4 1.025 0 .388-.127.733-.38 1.033-.253.3-.614.45-1.083.45-.4 0-.746-.152-1.037-.456-.29-.304-.437-.816-.437-1.536 0-.532.065-.983.194-1.354.25-.71.705-1.065 1.367-1.065.478 0 .81.124 1 .372zm-.404 3.274c.14-.19.21-.415.21-.674 0-.22-.062-.43-.188-.627-.126-.198-.354-.297-.685-.297-.23 0-.434.076-.608.23-.175.153-.262.385-.262.694 0 .27.08.498.238.683.16.184.38.277.66.277.283 0 .495-.096.636-.286z\"\n                fill=\"#636363\"\n            />\n            <rect height=\"18\" rx=\"40\" stroke=\"#ED6A6A\" strokeWidth=\"2\" width=\"18\" x=\"65\" y=\"19\" />\n        </g>\n    </svg>\n);\n\nexport default withIconContainer(IconCardCodeVisa);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconCardCodeAmex: FunctionComponent = () => (\n    <svg height=\"54\" viewBox=\"0 0 88 54\" width=\"88\" xmlns=\"http://www.w3.org/2000/svg\">\n        <title>CVV amex</title>\n        <g fill=\"none\" fillRule=\"evenodd\">\n            <rect fill=\"#DEDEDE\" height=\"54\" rx=\"3\" width=\"88\" />\n            <text\n                fill=\"#979BA1\"\n                fontFamily=\"Avenir Next\"\n                fontSize=\"6\"\n                fontWeight=\"420\"\n                letterSpacing=\".2\"\n            >\n                <tspan x=\"11\" y=\"35\">\n                    3712 567890 374\n                </tspan>\n                <tspan x=\"70.21\" y=\"35\">\n                    5\n                </tspan>\n            </text>\n            <path\n                d=\"M69.182 26.767h-.55v-3.35l-.762.635-.324-.38 1.142-.926h.494v4.02zm4.19 0H70.75v-.528l1.6-1.59c.122-.126.226-.257.313-.393s.13-.29.13-.46c0-.106-.018-.202-.056-.287-.038-.085-.09-.158-.153-.22-.065-.06-.14-.106-.228-.138-.087-.032-.18-.048-.278-.048-.204 0-.373.065-.505.196-.133.13-.216.298-.25.503l-.54-.09c.023-.153.07-.294.145-.424.074-.132.168-.246.28-.342.115-.097.246-.17.396-.224.15-.053.31-.08.48-.08.166 0 .326.025.48.074.153.05.288.12.406.216.117.094.21.214.28.357.07.145.106.31.106.496 0 .128-.017.248-.05.357-.035.11-.082.214-.14.313-.06.098-.128.192-.208.28-.08.09-.162.178-.25.265l-1.306 1.273h1.97v.494zm1.625-2.328h.176c.114 0 .225-.012.333-.033.107-.02.203-.056.286-.107.084-.052.15-.12.202-.208.05-.087.077-.195.077-.323 0-.104-.018-.196-.056-.277-.038-.08-.09-.15-.156-.207-.067-.057-.142-.102-.227-.134-.085-.032-.175-.048-.27-.048-.17 0-.314.044-.434.13-.12.088-.21.21-.27.364l-.5-.176c.1-.242.257-.433.475-.57.22-.14.47-.208.753-.208.167 0 .325.024.475.07.15.048.28.117.394.208.114.09.204.205.27.34.066.137.1.294.1.472 0 .114-.018.22-.054.318-.036.1-.086.188-.148.267-.063.08-.137.147-.224.204-.087.057-.182.098-.284.125v.01c.117.023.226.063.326.12.1.056.187.127.26.212.07.086.127.183.17.293.04.11.06.23.06.358 0 .2-.036.377-.112.53-.076.154-.176.282-.3.384-.126.102-.27.18-.433.233-.163.053-.33.08-.5.08-.318 0-.598-.073-.84-.216-.242-.144-.418-.368-.528-.67l.51-.17c.06.173.165.315.31.425.146.11.325.164.537.164.102 0 .202-.016.298-.05.097-.03.183-.08.26-.143.074-.064.135-.143.18-.238.046-.095.07-.206.07-.335 0-.14-.032-.257-.092-.352-.06-.095-.14-.17-.236-.23-.097-.06-.205-.1-.327-.125-.12-.025-.24-.037-.357-.037h-.17v-.454zm4.73.953h.58v.47h-.58v.904h-.533v-.903h-1.85v-.5l1.708-2.618h.676v2.647zm-.533-2.016h-.01l-1.273 2.016h1.284v-2.016z\"\n                fill=\"#636363\"\n                opacity=\".9\"\n            />\n            <rect height=\"18\" rx=\"40\" stroke=\"#ED6A6A\" strokeWidth=\"2\" width=\"18\" x=\"65\" y=\"16\" />\n        </g>\n    </svg>\n);\n\nexport default withIconContainer(IconCardCodeAmex);\n","import React, { type FunctionComponent } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { IconCardCodeAmex, IconCardCodeVisa, IconSize } from '../../ui/icon';\n\nimport './CreditCardCodeTooltip.scss';\n\nconst CreditCardCodeTooltip: FunctionComponent = () => (\n    <div className=\"dropdown-menu dropdown-menu--content dropdown-menu--card-code\">\n        <div className=\"form-ccFields-cvvExample\">\n            <div className=\"form-ccFields-cvvExampleDescription\">\n                <p>\n                    <TranslatedString id=\"payment.credit_card_cvv_help_text\" />\n                </p>\n            </div>\n\n            <div className=\"form-ccFields-cvvExampleFigures\">\n                <figure>\n                    <IconCardCodeVisa size={IconSize.Large} />\n                </figure>\n\n                <figure>\n                    <IconCardCodeAmex size={IconSize.Large} />\n                </figure>\n            </div>\n        </div>\n    </div>\n);\n\nexport default CreditCardCodeTooltip;\n","import React, { type FunctionComponent, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\nimport { IconHelp, IconLock } from '../../ui/icon';\nimport { TooltipTrigger } from '../../ui/tooltip';\nimport { CreditCardCodeTooltip } from '../creditCard';\n\nexport interface HostedCreditCardCodeFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardCodeField: FunctionComponent<HostedCreditCardCodeFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => (\n            <>\n                <TextInputIframeContainer\n                    additionalClassName=\"has-icon\"\n                    appearFocused={appearFocused}\n                    id={id}\n                />\n\n                <IconLock />\n            </>\n        ),\n        [id, appearFocused],\n    );\n\n    const labelContent = useMemo(\n        () => (\n            <>\n                <TranslatedString id=\"payment.credit_card_cvv_label\" />\n\n                <TooltipTrigger placement=\"top-start\" tooltip={<CreditCardCodeTooltip />}>\n                    <span className=\"has-tip\">\n                        <IconHelp />\n                    </span>\n                </TooltipTrigger>\n            </>\n        ),\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-ccFields-field--ccCvv\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardCodeField;\n","import React, { type FunctionComponent, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\n\nexport interface HostedCreditCardExpiryFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardExpiryField: FunctionComponent<HostedCreditCardExpiryFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => <TextInputIframeContainer appearFocused={appearFocused} id={id} />,\n        [id, appearFocused],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccExpiry\"\n            input={renderInput}\n            labelContent={<TranslatedString id=\"payment.credit_card_expiration_label\" />}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardExpiryField;\n","import React, { type FunctionComponent, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\n\nexport interface HostedCreditCardNameFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardNameField: FunctionComponent<HostedCreditCardNameFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => <TextInputIframeContainer appearFocused={appearFocused} id={id} />,\n        [id, appearFocused],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccName\"\n            input={renderInput}\n            labelContent={<TranslatedString id=\"payment.credit_card_name_label\" />}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardNameField;\n","import React, { type FunctionComponent, useCallback } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInputIframeContainer } from '../../ui/form';\nimport { IconLock } from '../../ui/icon';\n\nexport interface HostedCreditCardNumberFieldProps {\n    appearFocused: boolean;\n    id: string;\n    name: string;\n}\n\nconst HostedCreditCardNumberField: FunctionComponent<HostedCreditCardNumberFieldProps> = ({\n    appearFocused,\n    id,\n    name,\n}) => {\n    const renderInput = useCallback(\n        () => (\n            <>\n                <TextInputIframeContainer\n                    additionalClassName=\"has-icon\"\n                    appearFocused={appearFocused}\n                    id={id}\n                />\n\n                <IconLock />\n            </>\n        ),\n        [id, appearFocused],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccNumber\"\n            input={renderInput}\n            labelContent={<TranslatedString id=\"payment.credit_card_number_label\" />}\n            name={name}\n        />\n    );\n};\n\nexport default HostedCreditCardNumberField;\n","import React, { type FunctionComponent, type ReactNode } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { Fieldset, Legend } from '../../ui/form';\n\nimport HostedCreditCardCodeField from './HostedCreditCardCodeField';\nimport HostedCreditCardExpiryField from './HostedCreditCardExpiryField';\nimport HostedCreditCardNameField from './HostedCreditCardNameField';\nimport HostedCreditCardNumberField from './HostedCreditCardNumberField';\n\nexport interface HostedCreditCardFieldsetProps {\n    additionalFields?: ReactNode;\n    cardCodeId?: string;\n    cardExpiryId: string;\n    cardNameId?: string;\n    cardNumberId: string;\n    focusedFieldType?: string;\n}\n\nconst HostedCreditCardFieldset: FunctionComponent<HostedCreditCardFieldsetProps> = ({\n    additionalFields,\n    cardCodeId,\n    cardExpiryId,\n    cardNameId,\n    cardNumberId,\n    focusedFieldType,\n}) => (\n    <Fieldset\n        legend={\n            <Legend hidden>\n                <TranslatedString id=\"payment.credit_card_text\" />\n            </Legend>\n        }\n    >\n        <div className=\"form-ccFields\">\n            <HostedCreditCardNumberField\n                appearFocused={focusedFieldType === 'cardNumber'}\n                id={cardNumberId}\n                name=\"hostedForm.errors.cardNumber\"\n            />\n\n            <HostedCreditCardExpiryField\n                appearFocused={focusedFieldType === 'cardExpiry'}\n                id={cardExpiryId}\n                name=\"hostedForm.errors.cardExpiry\"\n            />\n\n            {cardNameId && (\n                <HostedCreditCardNameField\n                    appearFocused={focusedFieldType === 'cardName'}\n                    id={cardNameId}\n                    name=\"hostedForm.errors.cardName\"\n                />\n            )}\n\n            {cardCodeId && (\n                <HostedCreditCardCodeField\n                    appearFocused={focusedFieldType === 'cardCode'}\n                    id={cardCodeId}\n                    name=\"hostedForm.errors.cardCode\"\n                />\n            )}\n\n            {additionalFields}\n        </div>\n    </Fieldset>\n);\n\nexport default HostedCreditCardFieldset;\n","import React, { type FunctionComponent } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport HostedCreditCardCodeField from './HostedCreditCardCodeField';\nimport HostedCreditCardExpiryField from \"./HostedCreditCardExpiryField\";\nimport HostedCreditCardNumberField from './HostedCreditCardNumberField';\n\nexport interface HostedCreditCardValidationProps {\n    cardCodeId?: string;\n    cardNumberId?: string;\n    cardExpiryId?: string;\n    focusedFieldType?: string;\n}\n\nconst HostedCreditCardValidation: FunctionComponent<HostedCreditCardValidationProps> = ({\n    cardCodeId,\n    cardNumberId,\n    cardExpiryId,\n    focusedFieldType,\n}) => (\n    <>\n        {cardNumberId && (\n            <p>\n                <strong>\n                    <TranslatedString id=\"payment.instrument_trusted_shipping_address_title_text\" />\n                </strong>\n\n                <br />\n\n                <TranslatedString id=\"payment.instrument_trusted_shipping_address_text\" />\n            </p>\n        )}\n\n        <div className=\"form-ccFields\">\n            {cardNumberId && (\n                <HostedCreditCardNumberField\n                    appearFocused={focusedFieldType === 'cardNumber'}\n                    id={cardNumberId}\n                    name=\"hostedForm.errors.cardNumberVerification\"\n                />\n            )}\n\n            {cardCodeId && (\n                <HostedCreditCardCodeField\n                    appearFocused={focusedFieldType === 'cardCode'}\n                    id={cardCodeId}\n                    name=\"hostedForm.errors.cardCodeVerification\"\n                />\n            )}\n\n            {cardExpiryId && (\n                <HostedCreditCardExpiryField\n                    appearFocused={focusedFieldType === 'cardExpiry'}\n                    id={cardExpiryId}\n                    name=\"hostedForm.errors.cardExpiryVerification\"\n                />\n            )}\n        </div>\n    </>\n);\n\nexport default HostedCreditCardValidation;\n","import {\n    type CardInstrument,\n    type Instrument,\n    type LegacyHostedFormOptions,\n    type PaymentMethod,\n} from '@bigcommerce/checkout-sdk';\nimport { compact, forIn } from 'lodash';\nimport React, { type ComponentType, type FunctionComponent, type ReactNode, useCallback, useState } from 'react';\nimport { type ObjectSchema } from 'yup';\n\nimport { type CheckoutContextProps } from '@bigcommerce/checkout/contexts';\nimport { type MapToPropsFactory } from '@bigcommerce/checkout/legacy-hoc';\nimport { withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { type PaymentFormValues } from '@bigcommerce/checkout/payment-integration-api';\n\nimport { withCheckout } from '../../checkout';\nimport { connectFormik, type ConnectFormikProps } from '../../common/form';\nimport { withForm, type WithFormProps } from '../../ui/form';\nimport {\n    CreditCardCustomerCodeField,\n    CreditCardInputStylesType,\n    getCreditCardInputStyles,\n} from '../creditCard';\nimport {\n    isInstrumentCardCodeRequiredSelector,\n    isInstrumentCardNumberRequiredSelector,\n    isInstrumentFeatureAvailable,\n} from '../storedInstrument';\n\nimport getHostedCreditCardValidationSchema, {\n    type HostedCreditCardValidationSchemaShape,\n} from './getHostedCreditCardValidationSchema';\nimport getHostedInstrumentValidationSchema, {\n    type HostedInstrumentValidationSchemaShape,\n} from './getHostedInstrumentValidationSchema';\nimport HostedCreditCardFieldset from './HostedCreditCardFieldset';\nimport HostedCreditCardValidation from './HostedCreditCardValidation';\n\nexport interface WithHostedCreditCardFieldsetProps {\n    isUsingMultiShipping?: boolean;\n    method: PaymentMethod;\n}\n\nexport interface WithInjectedHostedCreditCardFieldsetProps {\n    hostedFieldset: ReactNode;\n    hostedStoredCardValidationSchema: ObjectSchema<HostedInstrumentValidationSchemaShape>;\n    hostedValidationSchema: ObjectSchema<HostedCreditCardValidationSchemaShape>;\n    getHostedFormOptions(selectedInstrument?: CardInstrument): Promise<LegacyHostedFormOptions>;\n    getHostedStoredCardValidationFieldset(selectedInstrument?: CardInstrument): ReactNode;\n}\n\ninterface WithCheckoutContextProps {\n    isCardCodeRequired: boolean;\n    isInstrumentFeatureAvailable: boolean;\n    isInstrumentCardCodeRequired(instrument: Instrument, method: PaymentMethod): boolean;\n    isInstrumentCardNumberRequired(instrument: Instrument): boolean;\n}\n\nexport default function withHostedCreditCardFieldset<\n    TProps extends WithHostedCreditCardFieldsetProps,\n>(\n    OriginalComponent: ComponentType<TProps & Partial<WithInjectedHostedCreditCardFieldsetProps>>,\n): ComponentType<Omit<TProps, keyof WithInjectedHostedCreditCardFieldsetProps>> {\n    const Component: FunctionComponent<\n        WithHostedCreditCardFieldsetProps &\n            WithCheckoutContextProps &\n            WithLanguageProps &\n            WithFormProps &\n            ConnectFormikProps<PaymentFormValues>\n    > = ({\n        formik: { setFieldValue, setFieldTouched, submitForm },\n        isCardCodeRequired,\n        isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredProp,\n        isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredProp,\n        isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n        isSubmitted,\n        language,\n        method,\n        setSubmitted,\n        ...rest\n    }) => {\n        const [focusedFieldType, setFocusedFieldType] = useState<string>();\n\n        const getHostedFieldId: (name: string) => string = useCallback(\n            (name) => {\n                return `${compact([method.gateway, method.id]).join('-')}-${name}`;\n            },\n            [method],\n        );\n\n        const getHostedFormOptions: (\n            selectedInstrument?: CardInstrument,\n        ) => Promise<LegacyHostedFormOptions> = useCallback(\n            async (selectedInstrument) => {\n                const styleProps = ['color', 'fontFamily', 'fontSize', 'fontWeight'];\n                const isInstrumentCardNumberRequired = selectedInstrument\n                    ? isInstrumentCardNumberRequiredProp(selectedInstrument)\n                    : false;\n                const isInstrumentCardCodeRequired = selectedInstrument\n                    ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n                    : false;\n                const styleContainerId = selectedInstrument\n                    ? isInstrumentCardCodeRequired\n                        ? getHostedFieldId('ccCvv')\n                        : undefined\n                    : getHostedFieldId('ccNumber');\n\n                return {\n                    fields: selectedInstrument\n                        ? {\n                              cardCodeVerification:\n                                  isInstrumentCardCodeRequired && selectedInstrument\n                                      ? {\n                                            accessibilityLabel: language.translate(\n                                                'payment.credit_card_cvv_label',\n                                            ),\n                                            containerId: getHostedFieldId('ccCvv'),\n                                            instrumentId: selectedInstrument.bigpayToken,\n                                        }\n                                      : undefined,\n                              cardNumberVerification:\n                                  isInstrumentCardNumberRequired && selectedInstrument\n                                      ? {\n                                            accessibilityLabel: language.translate(\n                                                'payment.credit_card_number_label',\n                                            ),\n                                            containerId: getHostedFieldId('ccNumber'),\n                                            instrumentId: selectedInstrument.bigpayToken,\n                                        }\n                                      : undefined,\n                          }\n                        : {\n                              cardCode: isCardCodeRequired\n                                  ? {\n                                        accessibilityLabel: language.translate(\n                                            'payment.credit_card_cvv_label',\n                                        ),\n                                        containerId: getHostedFieldId('ccCvv'),\n                                    }\n                                  : undefined,\n                              cardExpiry: {\n                                  accessibilityLabel: language.translate(\n                                      'payment.credit_card_expiration_label',\n                                  ),\n                                  containerId: getHostedFieldId('ccExpiry'),\n                                  placeholder: language.translate(\n                                      'payment.credit_card_expiration_placeholder_text',\n                                  ),\n                              },\n                              cardName: {\n                                  accessibilityLabel: language.translate(\n                                      'payment.credit_card_name_label',\n                                  ),\n                                  containerId: getHostedFieldId('ccName'),\n                              },\n                              cardNumber: {\n                                  accessibilityLabel: language.translate(\n                                      'payment.credit_card_number_label',\n                                  ),\n                                  containerId: getHostedFieldId('ccNumber'),\n                              },\n                          },\n                    styles: styleContainerId\n                        ? {\n                              default: await getCreditCardInputStyles(styleContainerId, styleProps),\n                              error: await getCreditCardInputStyles(\n                                  styleContainerId,\n                                  styleProps,\n                                  CreditCardInputStylesType.Error,\n                              ),\n                              focus: await getCreditCardInputStyles(\n                                  styleContainerId,\n                                  styleProps,\n                                  CreditCardInputStylesType.Focus,\n                              ),\n                          }\n                        : {},\n                    onBlur: ({ fieldType }) => {\n                        if (focusedFieldType === fieldType) {\n                            setFocusedFieldType(undefined);\n                        }\n                    },\n                    onCardTypeChange: ({ cardType }) => {\n                        setFieldValue('hostedForm.cardType', cardType);\n                    },\n                    onEnter: () => {\n                        setSubmitted(true);\n                        submitForm();\n                    },\n                    onFocus: ({ fieldType }) => {\n                        setFocusedFieldType(fieldType);\n                    },\n                    onValidate: ({ errors = {} }) => {\n                        forIn(errors, (fieldErrors = [], fieldType) => {\n                            const errorKey = `hostedForm.errors.${fieldType}`;\n\n                            setFieldValue(errorKey, fieldErrors[0]?.type ?? '');\n\n                            if (fieldErrors[0]) {\n                                setFieldTouched(errorKey);\n                            }\n                        });\n                    },\n                };\n            },\n            [\n                focusedFieldType,\n                getHostedFieldId,\n                isCardCodeRequired,\n                isInstrumentCardCodeRequiredProp,\n                isInstrumentCardNumberRequiredProp,\n                language,\n                method,\n                setFieldValue,\n                setFieldTouched,\n                setFocusedFieldType,\n                setSubmitted,\n                submitForm,\n            ],\n        );\n\n        const getHostedStoredCardValidationFieldset: (\n            selectedInstrument: CardInstrument,\n        ) => ReactNode = useCallback(\n            (selectedInstrument) => {\n                const isInstrumentCardNumberRequired = selectedInstrument\n                    ? isInstrumentCardNumberRequiredProp(selectedInstrument)\n                    : false;\n                const isInstrumentCardCodeRequired = selectedInstrument\n                    ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n                    : false;\n\n                return (\n                    <HostedCreditCardValidation\n                        cardCodeId={\n                            isInstrumentCardCodeRequired ? getHostedFieldId('ccCvv') : undefined\n                        }\n                        cardNumberId={\n                            isInstrumentCardNumberRequired\n                                ? getHostedFieldId('ccNumber')\n                                : undefined\n                        }\n                        focusedFieldType={focusedFieldType}\n                    />\n                );\n            },\n            [\n                focusedFieldType,\n                getHostedFieldId,\n                isInstrumentCardCodeRequiredProp,\n                isInstrumentCardNumberRequiredProp,\n                method,\n            ],\n        );\n\n        if (!method.config.isHostedFormEnabled) {\n            return <OriginalComponent {...(rest as TProps)} method={method} />;\n        }\n\n        return (\n            <OriginalComponent\n                {...(rest as TProps)}\n                getHostedFormOptions={getHostedFormOptions}\n                getHostedStoredCardValidationFieldset={getHostedStoredCardValidationFieldset}\n                hostedFieldset={\n                    <HostedCreditCardFieldset\n                        additionalFields={\n                            method.config.requireCustomerCode && (\n                                <CreditCardCustomerCodeField name=\"ccCustomerCode\" />\n                            )\n                        }\n                        cardCodeId={isCardCodeRequired ? getHostedFieldId('ccCvv') : undefined}\n                        cardExpiryId={getHostedFieldId('ccExpiry')}\n                        cardNameId={getHostedFieldId('ccName')}\n                        cardNumberId={getHostedFieldId('ccNumber')}\n                        focusedFieldType={focusedFieldType}\n                    />\n                }\n                hostedStoredCardValidationSchema={getHostedInstrumentValidationSchema({ language })}\n                hostedValidationSchema={getHostedCreditCardValidationSchema({ language })}\n                method={method}\n            />\n        );\n    };\n\n    return connectFormik(\n        withForm(withLanguage(withCheckout(mapFromCheckoutProps)(Component))),\n    ) as ComponentType<Omit<TProps, keyof WithInjectedHostedCreditCardFieldsetProps>>;\n}\n\nconst mapFromCheckoutProps: MapToPropsFactory<\n    CheckoutContextProps,\n    WithCheckoutContextProps,\n    WithHostedCreditCardFieldsetProps & ConnectFormikProps<PaymentFormValues>\n> = () => {\n    return ({ checkoutState }, { method }) => {\n        const {\n            data: { getConfig, getCustomer },\n        } = checkoutState;\n\n        const config = getConfig();\n        const customer = getCustomer();\n\n        if (!config || !customer) {\n            return null;\n        }\n\n        const isInstrumentFeatureAvailableProp = isInstrumentFeatureAvailable({\n            config,\n            customer,\n            paymentMethod: method,\n        });\n\n        return {\n            method,\n            isCardCodeRequired: method.config.cardCode || method.config.cardCode === null,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredSelector(checkoutState),\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredSelector(checkoutState),\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n        };\n    };\n};\n","import {\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default class LegacyPaymentStrategy implements PaymentStrategy {\n    constructor(private _paymentIntegrationService: PaymentIntegrationService) {}\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        await this._paymentIntegrationService.submitOrder(payload, options);\n\n        return Promise.resolve();\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    initialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport LegacyPaymentStrategy from './legacy-payment-strategy';\n\nconst createLegacyPaymentStrategy: PaymentStrategyFactory<LegacyPaymentStrategy> = (\n    paymentIntegrationService,\n) => new LegacyPaymentStrategy(paymentIntegrationService);\n\nexport default toResolvableModule(createLegacyPaymentStrategy, [{ id: 'testgateway' }]);\n","import { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\nimport { IconHelp, IconLock } from '../../ui/icon';\nimport { TooltipTrigger } from '../../ui/tooltip';\n\nimport CreditCardCodeTooltip from './CreditCardCodeTooltip';\n\nexport interface CreditCardCodeFieldProps {\n    name: string;\n}\n\nconst CreditCardCodeField: FunctionComponent<CreditCardCodeFieldProps> = ({ name }) => {\n    const renderInput = useCallback(\n        ({ field }: FieldProps) => (\n            <>\n                <TextInput\n                    {...field}\n                    additionalClassName=\"has-icon\"\n                    autoComplete=\"cc-csc\"\n                    id={field.name}\n                    type=\"tel\"\n                />\n\n                <IconLock />\n            </>\n        ),\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => (\n            <>\n                <TranslatedString id=\"payment.credit_card_cvv_label\" />\n\n                <TooltipTrigger placement=\"top-start\" tooltip={<CreditCardCodeTooltip />}>\n                    <span className=\"has-tip\">\n                        <IconHelp />\n                    </span>\n                </TooltipTrigger>\n            </>\n        ),\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-ccFields-field--ccCvv\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default memo(CreditCardCodeField);\n","import { memoizeOne } from '@bigcommerce/memoize';\nimport { type FieldProps } from 'formik';\nimport React, { type ChangeEvent, type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString, withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\n\nimport formatCreditCardExpiryDate from './formatCreditCardExpiryDate';\n\nexport interface CreditCardExpiryFieldProps {\n    name: string;\n}\n\nconst CreditCardExpiryField: FunctionComponent<CreditCardExpiryFieldProps & WithLanguageProps> = ({\n    language,\n    name,\n}) => {\n    const handleChange = useCallback(\n        memoizeOne((field: FieldProps['field'], form: FieldProps['form']) => {\n            return (event: ChangeEvent<any>) => {\n                form.setFieldValue(field.name, formatCreditCardExpiryDate(event.target.value));\n            };\n        }),\n        [],\n    );\n\n    const renderInput = useCallback(\n        ({ field, form }: FieldProps) => (\n            <TextInput\n                {...field}\n                autoComplete=\"cc-exp\"\n                id={field.name}\n                onChange={handleChange(field, form)}\n                placeholder={language.translate('payment.credit_card_expiration_placeholder_text')}\n                type=\"tel\"\n            />\n        ),\n        [handleChange, language],\n    );\n\n    const labelContent = useMemo(\n        () => <TranslatedString id=\"payment.credit_card_expiration_label\" />,\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccExpiry\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default memo(withLanguage(CreditCardExpiryField));\n","export default function formatCreditCardExpiryDate(value: string): string {\n    const separator = '/';\n    const [month = '', year = ''] = value.split(new RegExp(`\\\\s*${separator}\\\\s*`));\n    const trimmedMonth = month.slice(0, 2);\n    const trimmedYear =\n        year.length === 4 ? year.slice(-2) : year ? year.slice(0, 2) : month.slice(2);\n\n    // i.e.: '1'\n    if (value.length < 2) {\n        return month;\n    }\n\n    // ie.: '10 /' (without trailing space)\n    if (value.length > 3 && !trimmedYear) {\n        return trimmedMonth;\n    }\n\n    return `${trimmedMonth} / ${trimmedYear}`;\n}\n","import { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\n\nexport interface CreditCardNameFieldProps {\n    name: string;\n}\n\nconst CreditCardNameField: FunctionComponent<CreditCardNameFieldProps> = ({ name }) => {\n    const renderInput = useCallback(\n        ({ field }: FieldProps) => <TextInput {...field} autoComplete=\"cc-name\" id={field.name} />,\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => <TranslatedString id=\"payment.credit_card_name_label\" />,\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccName\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nexport default memo(CreditCardNameField);\n","import creditCardType from 'credit-card-type';\nimport { type FieldProps } from 'formik';\nimport { max } from 'lodash';\nimport React, {\n    type ChangeEventHandler,\n    type FunctionComponent,\n    memo,\n    type ReactElement,\n    useCallback,\n    useEffect,\n    useMemo,\n    useRef,\n} from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { FormField, TextInput } from '../../ui/form';\nimport { IconLock } from '../../ui/icon';\n\nimport formatCreditCardNumber from './formatCreditCardNumber';\n\nexport interface CreditCardNumberFieldProps {\n    name: string;\n}\n\nconst CreditCardNumberField: FunctionComponent<CreditCardNumberFieldProps> = ({ name }) => {\n    const renderInput = useCallback(\n        ({ field, form }: FieldProps<string>) => (\n            <CreditCardNumberInput field={field} form={form} />\n        ),\n        [],\n    );\n\n    const labelContent = useMemo(\n        () => <TranslatedString id=\"payment.credit_card_number_label\" />,\n        [],\n    );\n\n    return (\n        <FormField\n            additionalClassName=\"form-field--ccNumber\"\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\ninterface CreditCardNumberInputProps {\n    field: FieldProps<string>['field'];\n    form: FieldProps<string>['form'];\n}\n\nconst CreditCardNumberInput: FunctionComponent<CreditCardNumberInputProps> = ({ field, form }): ReactElement => {\n    const inputRef = useRef<HTMLInputElement>(null);\n    const nextSelectionEndRef = useRef(0);\n\n    useEffect(() => {\n        if (inputRef.current && inputRef.current.selectionEnd !== nextSelectionEndRef.current) {\n            inputRef.current.setSelectionRange(nextSelectionEndRef.current, nextSelectionEndRef.current);\n        }\n    });\n\n    const handleChange: ChangeEventHandler<HTMLInputElement> = useCallback(\n        (event) => {\n            const separator = ' ';\n            const { value = '' } = event.target;\n            const { name, value: previousValue = '' } = field;\n            const selectionEnd = inputRef.current && inputRef.current.selectionEnd;\n\n            // Only allow digits and spaces\n            if (new RegExp(`[^\\\\d${separator}]`).test(value)) {\n                return form.setFieldValue(name, previousValue);\n            }\n\n            const maxLength = max(creditCardType(value).map((info) => max(info.lengths)));\n\n            const formattedValue = formatCreditCardNumber(\n                value.replace(new RegExp(separator, 'g'), '').slice(0, maxLength),\n                separator,\n            );\n\n            if (selectionEnd === value.length && value.length < formattedValue.length) {\n                nextSelectionEndRef.current = formattedValue.length;\n            } else {\n                nextSelectionEndRef.current = selectionEnd || 0;\n            }\n\n            void form.setFieldValue(name, formattedValue);\n        },\n        [field, form],\n    );\n\n    return (\n        <>\n            <TextInput\n                {...field}\n                additionalClassName=\"has-icon\"\n                autoComplete=\"cc-number\"\n                id={field.name}\n                onChange={handleChange}\n                ref={inputRef}\n                type=\"tel\"\n            />\n\n            <IconLock />\n        </>\n    );\n};\n\nexport default memo(CreditCardNumberField);\n","import { number } from 'card-validator';\n\nimport unformatCreditCardNumber from './unformatCreditCardNumber';\n\nexport default function formatCreditCardNumber(value: string, separator = ' '): string {\n    const { card } = number(value);\n\n    if (!card) {\n        return value;\n    }\n\n    const unformattedValue = unformatCreditCardNumber(value, separator);\n\n    return card.gaps\n        .filter((gapIndex) => unformattedValue.length > gapIndex)\n        .reduce(\n            (output, gapIndex, index) =>\n                [output.slice(0, gapIndex + index), output.slice(gapIndex + index)].join(separator),\n            unformattedValue,\n        );\n}\n","import React, { type FunctionComponent, memo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { Fieldset, Legend } from '../../ui/form';\n\nimport CreditCardCodeField from './CreditCardCodeField';\nimport CreditCardCustomerCodeField from './CreditCardCustomerCodeField';\nimport CreditCardExpiryField from './CreditCardExpiryField';\nimport CreditCardNameField from './CreditCardNameField';\nimport CreditCardNumberField from './CreditCardNumberField';\n\nexport interface CreditCardFieldsetProps {\n    shouldShowCardCodeField?: boolean;\n    shouldShowCustomerCodeField?: boolean;\n    shouldShowSaveCardField?: boolean;\n}\n\nconst CreditCardFieldset: FunctionComponent<CreditCardFieldsetProps> = ({\n    shouldShowCardCodeField,\n    shouldShowCustomerCodeField,\n}) => (\n    <Fieldset\n        additionalClassName=\"creditCardFieldset\"\n        legend={\n            <Legend hidden>\n                <TranslatedString id=\"payment.credit_card_text\" />\n            </Legend>\n        }\n    >\n        <div className=\"form-ccFields\">\n            <CreditCardNumberField name=\"ccNumber\" />\n\n            <CreditCardExpiryField name=\"ccExpiry\" />\n\n            <CreditCardNameField name=\"ccName\" />\n\n            {shouldShowCardCodeField && <CreditCardCodeField name=\"ccCvv\" />}\n\n            {shouldShowCustomerCodeField && <CreditCardCustomerCodeField name=\"ccCustomerCode\" />}\n        </div>\n    </Fieldset>\n);\n\nexport default memo(CreditCardFieldset);\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { cvv, expirationDate, number } from 'card-validator';\nimport { object, type ObjectSchema, string } from 'yup';\n\nimport { type CreditCardFieldsetValues } from '../paymentMethod';\n\nexport interface CreditCardValidationSchemaOptions {\n    isCardCodeRequired: boolean;\n    language: LanguageService;\n}\n\nexport default memoize(function getCreditCardValidationSchema({\n    isCardCodeRequired,\n    language,\n}: CreditCardValidationSchemaOptions): ObjectSchema<CreditCardFieldsetValues> {\n    const schema = {\n        ccCustomerCode: string(),\n        ccCvv: string(),\n        ccExpiry: string()\n            .required(language.translate('payment.credit_card_expiration_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_expiration_invalid_error'),\n                test: (value) => expirationDate(value).isValid,\n            }),\n        ccName: string()\n            .max(200)\n            .required(language.translate('payment.credit_card_name_required_error')),\n        ccNumber: string()\n            .required(language.translate('payment.credit_card_number_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_number_invalid_error'),\n                test: (value) => number(value).isValid,\n            }),\n    };\n\n    if (isCardCodeRequired) {\n        schema.ccCvv = string()\n            .required(language.translate('payment.credit_card_cvv_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_cvv_invalid_error'),\n                test(value) {\n                    const { card } = number(this.parent.ccNumber);\n\n                    return cvv(value, card && card.code ? card.code.size : undefined).isValid;\n                },\n            });\n    }\n\n    return object(schema);\n});\n","import React from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { CreditCardCodeField, CreditCardNumberField } from '../creditCard';\n\ninterface CreditCardValidationProps {\n    shouldShowCardCodeField: boolean;\n    shouldShowNumberField: boolean;\n}\n\nconst CreditCardValidation: React.FunctionComponent<CreditCardValidationProps> = ({\n    shouldShowNumberField,\n    shouldShowCardCodeField,\n}) => (\n    <>\n        {shouldShowNumberField && (\n            <p>\n                <strong>\n                    <TranslatedString id=\"payment.instrument_trusted_shipping_address_title_text\" />\n                </strong>\n\n                <br />\n\n                <TranslatedString id=\"payment.instrument_trusted_shipping_address_text\" />\n            </p>\n        )}\n\n        <div className=\"form-ccFields\">\n            {shouldShowNumberField && <CreditCardNumberField name=\"ccNumber\" />}\n\n            {shouldShowCardCodeField && <CreditCardCodeField name=\"ccCvv\" />}\n        </div>\n    </>\n);\n\nexport default CreditCardValidation;\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { cvv, number } from 'card-validator';\nimport creditCardType from 'credit-card-type';\nimport { object, type ObjectSchema, string, type StringSchema } from 'yup';\n\nimport type CardInstrumentFieldsetValues from './CardInstrumentFieldsetValues';\nimport mapFromInstrumentCardType from './mapFromInstrumentCardType';\n\nexport interface InstrumentValidationSchemaOptions {\n    instrumentBrand: string;\n    instrumentLast4: string;\n    isCardCodeRequired: boolean;\n    isCardNumberRequired: boolean;\n    language: LanguageService;\n}\n\ninterface InstrumentValidationSchema {\n    ccCvv?: StringSchema;\n    ccNumber?: StringSchema;\n    instrumentId: StringSchema;\n}\n\nexport default memoize(function getInstrumentValidationSchema({\n    instrumentBrand,\n    instrumentLast4,\n    isCardCodeRequired,\n    isCardNumberRequired,\n    language,\n}: InstrumentValidationSchemaOptions): ObjectSchema<CardInstrumentFieldsetValues> {\n    const schema: InstrumentValidationSchema = {\n        instrumentId: string().required(),\n    };\n\n    if (isCardCodeRequired) {\n        schema.ccCvv = string()\n            .required(language.translate('payment.credit_card_cvv_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_cvv_invalid_error'),\n                test(value = '') {\n                    const cardType = mapFromInstrumentCardType(instrumentBrand);\n                    const cardInfo = creditCardType.getTypeInfo(cardType);\n\n                    return cvv(value, cardInfo && cardInfo.code ? cardInfo.code.size : undefined)\n                        .isValid;\n                },\n            });\n    }\n\n    if (isCardNumberRequired) {\n        schema.ccNumber = string()\n            .required(language.translate('payment.credit_card_number_required_error'))\n            .test({\n                message: language.translate('payment.credit_card_number_invalid_error'),\n                test: (value = '') => number(value).isValid,\n            })\n            .test({\n                message: language.translate('payment.credit_card_number_mismatch_error'),\n                test: (value = '') => value.slice(-instrumentLast4.length) === instrumentLast4,\n            });\n    }\n\n    return object(schema);\n});\n","import {\n    type CardInstrument,\n    type CheckoutSelectors,\n    type HostedFieldType,\n    type Instrument,\n    type PaymentInitializeOptions,\n    type PaymentInstrument,\n    type PaymentMethod,\n    type PaymentRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport { createLegacyPaymentStrategy } from '@bigcommerce/checkout-sdk/integrations/legacy';\nimport { memoizeOne } from '@bigcommerce/memoize';\nimport { find, noop } from 'lodash';\nimport React, { Component, type ReactNode } from 'react';\nimport { type ObjectSchema } from 'yup';\n\nimport { type CheckoutContextProps } from '@bigcommerce/checkout/contexts';\nimport { type MapToPropsFactory } from '@bigcommerce/checkout/legacy-hoc';\nimport { withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { type PaymentFormValues } from '@bigcommerce/checkout/payment-integration-api';\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { withCheckout } from '../../checkout';\nimport { connectFormik, type ConnectFormikProps } from '../../common/form';\nimport { withForm, type WithFormProps } from '../../ui/form';\nimport {\n    configureCardValidator,\n    CreditCardFieldset,\n    getCreditCardValidationSchema,\n} from '../creditCard';\nimport {\n    CardInstrumentFieldset,\n    type CardInstrumentFieldsetValues,\n    CreditCardValidation,\n    getInstrumentValidationSchema,\n    isCardInstrument,\n    isInstrumentCardCodeRequiredSelector,\n    isInstrumentCardNumberRequiredSelector,\n    isInstrumentFeatureAvailable,\n} from '../storedInstrument';\nimport StoreInstrumentFieldset from '../StoreInstrumentFieldset';\nimport withPayment, { type WithPaymentProps } from '../withPayment';\n\nimport type CreditCardFieldsetValues from './CreditCardFieldsetValues';\n\nexport interface CreditCardPaymentMethodProps {\n    isInitializing?: boolean;\n    isUsingMultiShipping?: boolean;\n    method: PaymentMethod;\n    cardFieldset?: ReactNode;\n    cardValidationSchema?: ObjectSchema;\n    storedCardValidationSchema?: ObjectSchema;\n    deinitializePayment(options: PaymentRequestOptions): Promise<CheckoutSelectors>;\n    getStoredCardValidationFieldset?(selectedInstrument?: CardInstrument): ReactNode;\n    initializePayment(\n        options: PaymentInitializeOptions,\n        selectedInstrument?: CardInstrument,\n    ): Promise<CheckoutSelectors>;\n    onUnhandledError?(error: Error): void;\n}\n\nexport type CreditCardPaymentMethodValues = CreditCardFieldsetValues | CardInstrumentFieldsetValues;\n\ninterface WithCheckoutCreditCardPaymentMethodProps {\n    instruments: CardInstrument[];\n    isCardCodeRequired: boolean;\n    isCustomerCodeRequired: boolean;\n    isInstrumentFeatureAvailable: boolean;\n    isLoadingInstruments: boolean;\n    isPaymentDataRequired: boolean;\n    shouldShowInstrumentFieldset: boolean;\n    isInstrumentCardCodeRequired(instrument: Instrument, method: PaymentMethod): boolean;\n    isInstrumentCardNumberRequired(instrument: Instrument): boolean;\n    loadInstruments(): Promise<CheckoutSelectors>;\n}\n\ninterface CreditCardPaymentMethodState {\n    focusedHostedFieldType?: HostedFieldType;\n    isAddingNewCard: boolean;\n    selectedInstrumentId?: string;\n    isPreloaderOn: boolean;\n}\n\nclass CreditCardPaymentMethod extends Component<\n    CreditCardPaymentMethodProps &\n        WithCheckoutCreditCardPaymentMethodProps &\n        WithFormProps &\n        WithPaymentProps &\n        WithLanguageProps &\n        ConnectFormikProps<PaymentFormValues>,\n    CreditCardPaymentMethodState\n> {\n    state: CreditCardPaymentMethodState = {\n        isAddingNewCard: false,\n        isPreloaderOn: true,\n    };\n\n    async componentDidMount(): Promise<void> {\n        const {\n            initializePayment,\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            loadInstruments,\n            method,\n            onUnhandledError = noop,\n            setValidationSchema,\n        } = this.props;\n\n        setValidationSchema(method, this.getValidationSchema());\n        configureCardValidator();\n\n        try {\n            if (isInstrumentFeatureAvailableProp) {\n                await loadInstruments();\n            }\n\n            await initializePayment(\n                {\n                    gatewayId: method.gateway,\n                    methodId: method.id,\n                    integrations: [createLegacyPaymentStrategy],\n                },\n                this.getSelectedInstrument(),\n            ).then(() => this.setState({ isPreloaderOn: false }));\n        } catch (error) {\n            onUnhandledError(error);\n        }\n    }\n\n    async componentWillUnmount(): Promise<void> {\n        const {\n            deinitializePayment,\n            method,\n            onUnhandledError = noop,\n            setValidationSchema,\n        } = this.props;\n\n        setValidationSchema(method, null);\n\n        try {\n            await deinitializePayment({\n                gatewayId: method.gateway,\n                methodId: method.id,\n            });\n        } catch (error) {\n            onUnhandledError(error);\n        }\n    }\n\n    async componentDidUpdate(\n        _prevProps: Readonly<CreditCardPaymentMethodProps>,\n        prevState: Readonly<CreditCardPaymentMethodState>,\n    ): Promise<void> {\n        const {\n            deinitializePayment,\n            initializePayment,\n            method,\n            onUnhandledError = noop,\n            setValidationSchema,\n        } = this.props;\n\n        const { isAddingNewCard, selectedInstrumentId } = this.state;\n\n        setValidationSchema(method, this.getValidationSchema());\n\n        if (\n            selectedInstrumentId !== prevState.selectedInstrumentId ||\n            isAddingNewCard !== prevState.isAddingNewCard\n        ) {\n            try {\n                await deinitializePayment({\n                    gatewayId: method.gateway,\n                    methodId: method.id,\n                });\n\n                await initializePayment(\n                    {\n                        gatewayId: method.gateway,\n                        methodId: method.id,\n                        integrations: [createLegacyPaymentStrategy],\n                    },\n                    this.getSelectedInstrument(),\n                );\n\n            } catch (error) {\n                onUnhandledError(error);\n            }\n        }\n    }\n\n    render(): ReactNode {\n        const {\n            cardFieldset,\n            getStoredCardValidationFieldset,\n            instruments,\n            isInitializing,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredProp,\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredProp,\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            isLoadingInstruments,\n            shouldShowInstrumentFieldset,\n            method,\n        } = this.props;\n\n        const { isAddingNewCard, isPreloaderOn } = this.state;\n\n        const selectedInstrument = this.getSelectedInstrument();\n        const shouldShowCreditCardFieldset = !shouldShowInstrumentFieldset || isAddingNewCard;\n        const isLoading = isInitializing || isLoadingInstruments || isPreloaderOn;\n        const shouldShowNumberField = selectedInstrument\n            ? isInstrumentCardNumberRequiredProp(selectedInstrument)\n            : false;\n        const shouldShowCardCodeField = selectedInstrument\n            ? isInstrumentCardCodeRequiredProp(selectedInstrument, method)\n            : false;\n\n        return (\n            <LoadingOverlay hideContentWhenLoading isLoading={isLoading}>\n                <div className=\"paymentMethod paymentMethod--creditCard\" data-test='credit-cart-payment-method'>\n                    {shouldShowInstrumentFieldset && (\n                        <CardInstrumentFieldset\n                            instruments={instruments}\n                            onDeleteInstrument={this.handleDeleteInstrument}\n                            onSelectInstrument={this.handleSelectInstrument}\n                            onUseNewInstrument={this.handleUseNewCard}\n                            selectedInstrumentId={\n                                selectedInstrument && selectedInstrument.bigpayToken\n                            }\n                            validateInstrument={\n                                getStoredCardValidationFieldset ? (\n                                    getStoredCardValidationFieldset(selectedInstrument)\n                                ) : (\n                                    <CreditCardValidation\n                                        shouldShowCardCodeField={shouldShowCardCodeField}\n                                        shouldShowNumberField={shouldShowNumberField}\n                                    />\n                                )\n                            }\n                        />\n                    )}\n\n                    {shouldShowCreditCardFieldset && !cardFieldset && (\n                        <CreditCardFieldset\n                            shouldShowCardCodeField={\n                                method.config.cardCode || method.config.cardCode === null\n                            }\n                            shouldShowCustomerCodeField={method.config.requireCustomerCode}\n                        />\n                    )}\n\n                    {shouldShowCreditCardFieldset && cardFieldset}\n\n                    {isInstrumentFeatureAvailableProp && (\n                        <StoreInstrumentFieldset\n                            instrumentId={selectedInstrument && selectedInstrument.bigpayToken}\n                        />\n                    )}\n                </div>\n            </LoadingOverlay>\n        );\n    }\n\n    private getSelectedInstrument(): CardInstrument | undefined {\n        const { instruments } = this.props;\n        const { selectedInstrumentId = this.getDefaultInstrumentId() } = this.state;\n\n        return find(instruments, { bigpayToken: selectedInstrumentId });\n    }\n\n    private getDefaultInstrumentId(): string | undefined {\n        const { isAddingNewCard } = this.state;\n\n        if (isAddingNewCard) {\n            return;\n        }\n\n        const { instruments } = this.props;\n        const defaultInstrument =\n            instruments.find((instrument) => instrument.defaultInstrument) || instruments[0];\n\n        return defaultInstrument && defaultInstrument.bigpayToken;\n    }\n\n    private getValidationSchema(): ObjectSchema | null {\n        const {\n            cardValidationSchema,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredProp,\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredProp,\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            isPaymentDataRequired,\n            language,\n            method,\n            storedCardValidationSchema,\n        } = this.props;\n\n        if (!isPaymentDataRequired) {\n            return null;\n        }\n\n        const selectedInstrument = this.getSelectedInstrument();\n\n        if (isInstrumentFeatureAvailableProp && selectedInstrument) {\n            return (\n                storedCardValidationSchema ||\n                getInstrumentValidationSchema({\n                    instrumentBrand: selectedInstrument.brand,\n                    instrumentLast4: selectedInstrument.last4,\n                    isCardCodeRequired: isInstrumentCardCodeRequiredProp(\n                        selectedInstrument,\n                        method,\n                    ),\n                    isCardNumberRequired: isInstrumentCardNumberRequiredProp(selectedInstrument),\n                    language,\n                })\n            );\n        }\n\n        return (\n            cardValidationSchema ||\n            getCreditCardValidationSchema({\n                isCardCodeRequired: method.config.cardCode === true,\n                language,\n            })\n        );\n    }\n\n    private handleUseNewCard: () => void = () => {\n        const {\n            formik: { setFieldValue },\n        } = this.props;\n\n        setFieldValue('hostedForm.cardType', '');\n\n        this.setState({\n            isAddingNewCard: true,\n            selectedInstrumentId: undefined,\n        });\n    };\n\n    private handleSelectInstrument: (id: string) => void = (id) => {\n        const {\n            formik: { setFieldValue },\n        } = this.props;\n\n        setFieldValue('hostedForm.cardType', '');\n\n        this.setState({\n            isAddingNewCard: false,\n            selectedInstrumentId: id,\n        });\n    };\n\n    private handleDeleteInstrument: (id: string) => void = (id) => {\n        const {\n            instruments,\n            formik: { setFieldValue },\n        } = this.props;\n        const { selectedInstrumentId } = this.state;\n\n        if (instruments.length === 0) {\n            this.setState({\n                isAddingNewCard: true,\n                selectedInstrumentId: undefined,\n            });\n\n            setFieldValue('instrumentId', '');\n        } else if (selectedInstrumentId === id) {\n            this.setState({\n                selectedInstrumentId: this.getDefaultInstrumentId(),\n            });\n\n            setFieldValue('instrumentId', this.getDefaultInstrumentId());\n        }\n    };\n}\n\nconst mapFromCheckoutProps: MapToPropsFactory<\n    CheckoutContextProps,\n    WithCheckoutCreditCardPaymentMethodProps,\n    CreditCardPaymentMethodProps & ConnectFormikProps<PaymentFormValues>\n> = () => {\n    const filterInstruments = memoizeOne((instruments: PaymentInstrument[] = []) =>\n        instruments.filter(isCardInstrument),\n    );\n\n    return (context, props) => {\n        const { method } = props;\n\n        const { checkoutService, checkoutState } = context;\n\n        const {\n            data: { getConfig, getCustomer, getInstruments, isPaymentDataRequired },\n            statuses: { isLoadingInstruments },\n        } = checkoutState;\n\n        const config = getConfig();\n        const customer = getCustomer();\n\n        if (!config || !customer || !method) {\n            return null;\n        }\n\n        const instruments = filterInstruments(getInstruments(method));\n        const isInstrumentFeatureAvailableProp = isInstrumentFeatureAvailable({\n            config,\n            customer,\n            paymentMethod: method,\n        });\n\n        return {\n            instruments,\n            isCardCodeRequired: method.config.cardCode || method.config.cardCode === null,\n            isCustomerCodeRequired: !!method.config.requireCustomerCode,\n            isInstrumentCardCodeRequired: isInstrumentCardCodeRequiredSelector(checkoutState),\n            isInstrumentCardNumberRequired: isInstrumentCardNumberRequiredSelector(checkoutState),\n            isInstrumentFeatureAvailable: isInstrumentFeatureAvailableProp,\n            isLoadingInstruments: isLoadingInstruments(),\n            isPaymentDataRequired: isPaymentDataRequired(),\n            loadInstruments: checkoutService.loadInstruments,\n            shouldShowInstrumentFieldset:\n                isInstrumentFeatureAvailableProp && instruments.length > 0,\n        };\n    };\n};\n\nexport default connectFormik(\n    withForm(\n        withLanguage(withPayment(withCheckout(mapFromCheckoutProps)(CreditCardPaymentMethod))),\n    ),\n);\n","import { creditCardType } from 'card-validator';\n\nexport default function configureCardValidator(): void {\n    const discoverInfo = creditCardType.getTypeInfo('discover');\n    const visaInfo = creditCardType.getTypeInfo('visa');\n\n    // Need to support 13 digit PAN because some gateways only provide test credit card numbers in this format.\n    creditCardType.updateCard('visa', {\n        lengths: [13, ...(visaInfo.lengths || [])],\n    });\n\n    // Add support for 8-BIN Discover Cards.\n    creditCardType.updateCard('discover', {\n        patterns: [...(discoverInfo.patterns || []), [810, 817]],\n    });\n\n    // Add support for Mada-BIN Cards.\n    creditCardType.addCard({\n        niceType: 'Mada',\n        type: 'mada',\n        patterns: [\n            400861, 401757, 407197, 407395, 409201, 410685, 412565, 417633, 419593, 422817, 422818,\n            422819, 428331, 428671, 428672, 428673, 431361, 432328, 434107, 439954, 440533, 440647,\n            440795, 445564, 446393, 446404, 446672, 455036, 455708, 457865, 458456, 462220, 468540,\n            468541, 468542, 468543, 483010, 483011, 483012, 484783, 486094, 486095, 486096, 489317,\n            489318, 489319, 493428, 504300, 506968, 508160, 513213, 520058, 521076, 524130, 524514,\n            529415, 529741, 530060, 530906, 531095, 531196, 532013, 535825, 535989, 536023, 537767,\n            539931, 543085, 543357, 549760, 554180, 557606, 558848, 585265, 588845, 588846, 588847,\n            588848, 588849, 588850, 588851, 588982, 588983, 589005, 589206, 604906, 605141, 636120,\n            968201, 968202, 968203, 968204, 968205, 968206, 968207, 968208, 968209, 968210, 968211,\n        ],\n        gaps: [4, 8, 12],\n        lengths: [16, 18, 19],\n        code: {\n            name: 'CVV',\n            size: 3,\n        },\n    });\n}\n","import { createCBAMPGSPaymentStrategy } from '@bigcommerce/checkout-sdk/integrations/cba-mpgs';\nimport { createCreditCardPaymentStrategy } from '@bigcommerce/checkout-sdk/integrations/credit-card';\nimport { createCyberSourcePaymentStrategy, createCyberSourceV2PaymentStrategy } from '@bigcommerce/checkout-sdk/integrations/cybersource';\nimport { createSagePayPaymentStrategy } from '@bigcommerce/checkout-sdk/integrations/sagepay';\nimport React, { type FunctionComponent, useCallback } from 'react';\n\nimport {\n    withHostedCreditCardFieldset,\n    type WithInjectedHostedCreditCardFieldsetProps,\n} from '../hostedCreditCard';\n\nimport CreditCardPaymentMethod, { type CreditCardPaymentMethodProps } from './CreditCardPaymentMethod';\n\nexport type HostedCreditCardPaymentMethodProps = Omit<\n    CreditCardPaymentMethodProps,\n    | 'cardFieldset'\n    | 'cardValidationSchema'\n    | 'storedCardValidationSchema'\n    | 'getStoredCardValidationFieldset'\n>;\n\nconst HostedCreditCardPaymentMethod: FunctionComponent<\n    HostedCreditCardPaymentMethodProps & WithInjectedHostedCreditCardFieldsetProps\n> = ({\n    getHostedFormOptions,\n    getHostedStoredCardValidationFieldset,\n    hostedFieldset,\n    hostedStoredCardValidationSchema,\n    hostedValidationSchema,\n    initializePayment,\n    ...rest\n}) => {\n    const initializeHostedCreditCardPayment: CreditCardPaymentMethodProps['initializePayment'] =\n        useCallback(\n            async (options, selectedInstrument) => {\n                return initializePayment({\n                    ...options,\n                    integrations: [\n                        ...options.integrations ?? [],\n                        createCreditCardPaymentStrategy,\n                        createCyberSourcePaymentStrategy,\n                        createCyberSourceV2PaymentStrategy,\n                        createSagePayPaymentStrategy,\n                        createCBAMPGSPaymentStrategy,\n                    ],\n                    creditCard: getHostedFormOptions && {\n                        form: await getHostedFormOptions(selectedInstrument),\n                    },\n                });\n            },\n            [getHostedFormOptions, initializePayment],\n        );\n\n    return (\n        <CreditCardPaymentMethod\n            {...rest}\n            cardFieldset={hostedFieldset}\n            cardValidationSchema={hostedValidationSchema}\n            getStoredCardValidationFieldset={getHostedStoredCardValidationFieldset}\n            initializePayment={initializeHostedCreditCardPayment}\n            storedCardValidationSchema={hostedStoredCardValidationSchema}\n        />\n    );\n};\n\nexport default withHostedCreditCardFieldset(HostedCreditCardPaymentMethod);\n"],"names":["method","checkoutService","checkoutState","paymentForm","language","onUnhandledError","id","gateway","__webpack_require__","isVaultedInstrument","instrument","Boolean","instrumentId","d","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","error","MissingDataErrorType","NotInitializedErrorType","CardinalThreeDSecureFlow","constructor","_paymentIntegrationService","_cardinalClient","prepare","this","load","config","testMode","configure","_getClientToken","start","execute","payload","options","hostedForm","getCardInstrument","getPaymentMethodOrThrow","getState","payment","methodId","paymentData","bin","iin","getBin","runBinProcess","merge","threeDSecure","token","clientToken","some","body","errors","code","getThreeDSecureData","three_ds_result","_getOrderData","submitPayment","submit","loadPaymentMethod","state","billingAddress","getBillingAddressOrThrow","shippingAddress","getShippingAddress","checkout","getCheckoutOrThrow","order","getOrderOrThrow","currencyCode","cart","currency","orderId","toString","amount","cartAmount","StandardError","Error","message","super","name","type","setPrototypeOf","__proto__","captureStackTrace","stack","MissingBillingAddress","MissingCart","MissingCheckout","MissingConsignments","MissingCustomer","MissingCheckoutConfig","MissingOrder","MissingOrderConfig","MissingOrderId","MissingPayment","MissingPaymentId","MissingPaymentInstrument","MissingPaymentMethod","MissingPaymentRedirectUrl","MissingPaymentStatus","MissingPaymentToken","MissingShippingAddress","MissingDataError","subtype","PaymentMethodFailedError","CheckoutButtonNotInitialized","CustomerNotInitialized","PaymentNotInitialized","ShippingNotInitialized","SpamProtectionNotInitialized","NotInitializedError","CardinalSignatureValidationErrors","CardinalEventType","CardinalInitializationType","CardinalValidatedAction","CardinalPaymentType","CardinalTriggerEvents","CardinalPaymentBrand","CardinalSignatureVerification","SetupCompleted","Validated","Init","Complete","Confirm","Success","NoAction","Failure","CCA","Paypal","Wallet","VisaCheckout","ApplePay","DiscoverWallet","BinProcess","Yes","No","CardinalClient","_scriptLoader","_provider","_testMode","_configurationToken","provider","_sdk","then","noop","Promise","resolve","Date","now","_getClientSDK","client","reject","on","off","data","ActionCode","includes","ErrorNumber","ErrorDescription","setup","jwt","binNumber","trigger","catch","result","Status","threeDSecureData","orderData","Payment","ExtendedData","SignatureVerification","continueObject","AcsUrl","acs_url","Payload","merchant_data","partialOrder","_mapToPartialOrder","payer_auth_request","continue","transactionId","consumer","BillingAddress","_mapToCardinalAddress","Account","_mapToCardinalAccount","email","Email1","ShippingAddress","Consumer","OrderDetails","OrderNumber","Amount","CurrencyCode","OrderChannel","TransactionId","AccountNumber","Number","ccNumber","ExpirationMonth","ccExpiry","month","ExpirationYear","year","NameOnAccount","ccName","CardCode","ccCvv","address","cardinalAddress","FirstName","firstName","LastName","lastName","Address1","address1","City","city","State","stateOrProvince","PostalCode","postalCode","CountryCode","countryCode","address2","Address2","phone","Phone1","PaymentMethodClientUnavailableError","CardinalScriptLoader","_window","window","url","loadScript","Cardinal","toResolvableModule","module","resolveIds","assign","InvalidArgumentError","OrderFinalizationNotRequiredError","PaymentArgumentInvalidError","invalidFields","join","CreditCardPaymentStrategy","_isHostedPaymentFormEnabled","gatewayId","_shouldRenderHostedForm","_executeWithHostedForm","_executeWithoutHostedForm","initialize","_isHostedFieldAvailable","formOptions","creditCard","form","paymentSettings","bigpayBaseUrl","host","getStoreConfigOrThrow","createHostedForm","attach","_hostedForm","deinitialize","detach","finalize","submitOrder","validate","isHostedFormEnabled","values","fields","every","isNil","CyberSourcePaymentStrategy","_threeDSecureFlow","paymentMethod","is3dsEnabled","bind","paymentIntegrationService","getScriptLoader","CardinalThreeDSecureFlowV2","status","additional_action_required","xid","_getBin","_submitPayment","err","threeDsResult","threeDsToken","store","paymentPayload","card","hostedFormBin","CyberSourceV2PaymentStrategy","CreditCardInputStylesType","getCreditCardInputStyles","containerId","properties","Default","container","document","createElement","parentContainer","getElementById","appendChild","FormContext","Provider","value","isSubmitted","setSubmitted","FormFieldContainer","hasError","TextInput","appearFocused","Focus","ref","element","getAppliedStyles","parentElement","removeChild","memo","renderInput","useCallback","field","labelContent","useMemo","TranslatedString","className","FormField","input","InstrumentSelect","PureComponent","componentDidMount","selectedInstrumentId","props","setTimeout","updateFieldValue","componentDidUpdate","prevProps","prevSelectedInstrumentId","componentWillUnmount","undefined","render","instruments","onSelectInstrument","onUseNewInstrument","shouldHideExpiryDate","selectedInstrument","find","bigpayToken","DropdownTrigger","dropdown","InstrumentMenu","InstrumentSelectButton","testId","setFieldValue","map","InstrumentOption","onClick","InstrumentUseNewButton","InstrumentMenuItem","handleClick","cardType","mapFromInstrumentCardType","brand","cardInfo","isExpired","expirationDate","expiryMonth","expiryYear","isValid","CreditCardIcon","cardTitle","niceType","endingIn","last4","expiryDate","UntrustedShippingCardVerificationType","onDeleteInstrument","validateInstrument","renderModal","ManageInstrumentsModal","Fieldset","additionalClassName","legend","Legend","hidden","ModalTrigger","modal","BasicFormField","style","display","PROVIDERS_WITHOUT_CARD_CODE","getCart","lineItems","digitalItems","length","giftCertificates","trustedShippingAddress","isVaultingCvvEnabled","untrustedShippingCardVerificationMode","CVV","cardCode","isInstrumentCardCodeRequired","physicalItems","isInstrumentCardNumberRequired","shape","required","test","translate","cardExpiry","cardName","cardNumber","isCardExpiryRequired","cardCodeVerification","cardNumberVerification","cardExpiryVerification","withIconContainer","height","viewBox","width","xmlns","fill","fillRule","rx","stroke","strokeWidth","x","y","fontFamily","fontSize","fontWeight","letterSpacing","opacity","size","Large","TooltipTrigger","placement","tooltip","additionalFields","cardCodeId","cardExpiryId","cardNameId","cardNumberId","focusedFieldType","mapFromCheckoutProps","getConfig","getCustomer","customer","isInstrumentFeatureAvailableProp","isInstrumentFeatureAvailable","isCardCodeRequired","LegacyPaymentStrategy","autoComplete","withLanguage","handleChange","event","split","RegExp","trimmedMonth","slice","trimmedYear","formatCreditCardExpiryDate","target","onChange","placeholder","CreditCardNumberInput","inputRef","useRef","nextSelectionEndRef","useEffect","current","selectionEnd","setSelectionRange","previousValue","maxLength","max","info","lengths","formattedValue","separator","number","unformattedValue","unformatCreditCardNumber","gaps","filter","gapIndex","reduce","output","index","formatCreditCardNumber","replace","shouldShowCardCodeField","shouldShowCustomerCodeField","schema","ccCustomerCode","parent","cvv","shouldShowNumberField","instrumentBrand","instrumentLast4","isCardNumberRequired","CreditCardPaymentMethod","Component","isAddingNewCard","isPreloaderOn","handleUseNewCard","formik","setState","handleSelectInstrument","handleDeleteInstrument","getDefaultInstrumentId","initializePayment","loadInstruments","setValidationSchema","getValidationSchema","discoverInfo","creditCardType","getTypeInfo","visaInfo","updateCard","patterns","addCard","configureCardValidator","integrations","getSelectedInstrument","deinitializePayment","_prevProps","prevState","cardFieldset","getStoredCardValidationFieldset","isInitializing","isInstrumentCardCodeRequiredProp","isInstrumentCardNumberRequiredProp","isLoadingInstruments","shouldShowInstrumentFieldset","shouldShowCreditCardFieldset","isLoading","LoadingOverlay","hideContentWhenLoading","requireCustomerCode","StoreInstrumentFieldset","defaultInstrument","cardValidationSchema","isPaymentDataRequired","storedCardValidationSchema","getInstrumentValidationSchema","getCreditCardValidationSchema","connectFormik","withForm","withPayment","withCheckout","filterInstruments","isCardInstrument","context","getInstruments","statuses","isCustomerCodeRequired","OriginalComponent","setFieldTouched","submitForm","rest","setFocusedFieldType","useState","getHostedFieldId","compact","getHostedFormOptions","styleProps","styleContainerId","accessibilityLabel","styles","default","focus","onBlur","fieldType","onCardTypeChange","onEnter","onFocus","onValidate","forIn","fieldErrors","errorKey","getHostedStoredCardValidationFieldset","hostedFieldset","hostedStoredCardValidationSchema","getHostedInstrumentValidationSchema","hostedValidationSchema","getHostedCreditCardValidationSchema","initializeHostedCreditCardPayment","c"],"sourceRoot":""}