{"version":3,"file":"2920-41598d65.js","mappings":"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","sources":["webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/missing-data-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/standard-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/set-prototype-of.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-client-unavailable-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/adyen-utils/src/adyenv2/adyenv2-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/to-resolvable-module.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/adyen-utils/src/utils/is-additional-action-error-response.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/browser-info/get-browser-info.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/is-request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-cancelled-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-initialized-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/invalid-argument-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/utility/src/bind-decorator/bind-decorator.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/currency/currency-formatter.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/currency/currency-service.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/util-types/guard.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/utility/src/is-experiment-enabled/is-experiment-enabled.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-card-network-key.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/currency/create-currency-service.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/shipping/items-require-shipping.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-adyenv2-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/sdk-version-headers.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-failed-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-payment-processor.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-additional-action-processable.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-argument-invalid-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/order-finalization-not-required-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/ui/src/loading-indicator/loading-indicator.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-error-object.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-payment-initialize-options.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-key.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/create-google-pay-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-adyenv2-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/adyen-utils/src/adyenv3/adyenv3-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-adyenv3-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-adyenv3-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-authorizenet-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-authorizenet-initialization-data.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-authorizenet-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/content-type.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-checkoutcom-initialization-data.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-checkoutcom-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-threedsecure-result.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-token-object.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-checkoutcom-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-cybersource-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-cybersource-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-orbital-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-orbital-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/stripe-utils/src/stripe.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/stripe-utils/src/stripe-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/stripe-utils/src/stripe-upe/stripe-upe-constants.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-stripe-initialization-data.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-stripe/google-pay-stripe-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-stripe-token-object.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-stripe-request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-stripe/create-google-pay-stripe-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-worldpayaccess-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-worldpayaccess-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/braintree-sdk-verison.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/braintree-sdk-version-manager.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/unsupported-browser-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/braintree.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/braintree-sdk.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/utils/is-braintree-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/braintree-sdk-scripts-integrity.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/braintree-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/braintree-utils/src/isManageableBraintreeSDKVersion.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/cancellable-promise/cancellable-promise.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-braintree-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-braintree-token-object.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-braintree-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-utils/src/paypal-commerce-sdk.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-paypal-commerce-payment-method.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-paypal-commerce/google-pay-paypal-commerce-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/internal-api-headers.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-paypal-commerce/types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-paypal-commerce/google-pay-paypal-commerce-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-paypal-commerce/create-google-pay-paypal-commerce-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/paypal-sdk-helper.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-bigcommerce-payments/types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-bigcommerce-payments/google-pay-bigcommerce-payments-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-bigcommerce-payments/google-pay-bigcommerce-payments-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-bigcommerce-payments/create-google-pay-bigcommerce-payments-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/gateways/google-pay-tdonlinemart-gateway.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/guards/is-google-pay-td-online-mart-additional-action.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/payment/create-google-pay-tdonlinemart-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-implemented-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-adyenv2-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-adyenv3-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-authorizenet-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-checkoutcom-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-cybersource-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-bnz-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-orbital-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-stripe/create-google-pay-stripe-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-stripe/create-google-pay-stripeupe-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-worldpayaccess-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-braintree-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-paypal-commerce/create-google-pay-paypal-commerce-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-bigcommerce-payments/create-google-pay-bigcommerce-payments-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/customer/create-google-pay-tdonlinemart-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/buy-now-cart-creation-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-braintree-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-paypal-commerce/create-google-pay-paypal-commerce-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-bigcommerce-payments/create-google-pay-bigcommerce-payments-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-adyenv2-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-adyenv3-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-authorizenet-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-checkoutcom-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-cybersource-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-orbital-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/google-pay-stripe/create-google-pay-stripe-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-worldpayaccess-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/google-pay-integration/src/factories/button/create-google-pay-tdonlinemart-button-strategy.ts"],"sourcesContent":["import StandardError from './standard-error';\n\nexport enum MissingDataErrorType {\n    MissingBillingAddress,\n    MissingCart,\n    MissingCheckout,\n    MissingConsignments,\n    MissingCustomer,\n    MissingCheckoutConfig,\n    MissingOrder,\n    MissingOrderConfig,\n    MissingOrderId,\n    MissingPayment,\n    MissingPaymentId,\n    MissingPaymentInstrument,\n    MissingPaymentMethod,\n    MissingPaymentRedirectUrl,\n    MissingPaymentStatus,\n    MissingPaymentToken,\n    MissingShippingAddress,\n}\n\n/**\n * Throw this error when data that is expected to exist is missing. Usually it\n * is due to the fact that certain data has not been retrieved from or saved to\n * the server yet. And such data is required to perform certain actions.\n */\nexport default class MissingDataError extends StandardError {\n    constructor(public subtype: MissingDataErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'MissingDataError';\n        this.type = 'missing_data';\n    }\n}\n\nfunction getErrorMessage(type: MissingDataErrorType): string {\n    switch (type) {\n        case MissingDataErrorType.MissingBillingAddress:\n            return 'Unable to proceed because billing address data is unavailable.';\n\n        case MissingDataErrorType.MissingCart:\n            return 'Unable to proceed because cart data is unavailable.';\n\n        case MissingDataErrorType.MissingConsignments:\n            return 'Unable to proceed because consignments data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckout:\n            return 'Unable to proceed because checkout data is unavailable.';\n\n        case MissingDataErrorType.MissingCustomer:\n            return 'Unable to proceed because customer data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckoutConfig:\n        case MissingDataErrorType.MissingOrderConfig:\n            return 'Unable to proceed because configuration data is unavailable.';\n\n        case MissingDataErrorType.MissingOrder:\n            return 'Unable to proceed because order data is unavailable.';\n\n        case MissingDataErrorType.MissingOrderId:\n            return 'Unable to proceed because order ID is unavailable or not generated yet.';\n\n        case MissingDataErrorType.MissingPayment:\n            return 'Unable to proceed because payment data is unavailable.';\n\n        case MissingDataErrorType.MissingPaymentToken:\n            return 'Unable to proceed because the token required to submit a payment is missing.';\n\n        case MissingDataErrorType.MissingPaymentMethod:\n            return 'Unable to proceed because payment method data is unavailable or not properly configured.';\n\n        case MissingDataErrorType.MissingShippingAddress:\n            return 'Unable to proceed because shipping address data is unavailable.';\n\n        default:\n            return 'Unable to proceed because the required data is unavailable.';\n    }\n}\n","import CustomError from './custom-error';\nimport setPrototypeOf from './set-prototype-of';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when the client library of a payment method fails\n * to load, or for some reason, it is inaccessible.\n */\nexport default class PaymentMethodClientUnavailableError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method is not loaded or ready to be used.',\n        );\n\n        this.name = 'PaymentMethodClientUnavailableError';\n        this.type = 'payment_method_client_unavailable';\n    }\n}\n","import { ScriptLoader, StylesheetLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { AdyenClient, AdyenConfiguration, AdyenV2HostWindow } from '../types';\n\nexport default class AdyenV2ScriptLoader {\n    constructor(\n        private _scriptLoader: ScriptLoader,\n        private _stylesheetLoader: StylesheetLoader,\n        private _window: AdyenV2HostWindow = window,\n    ) {}\n\n    async load(configuration: AdyenConfiguration): Promise<AdyenClient> {\n        await Promise.all([\n            this._stylesheetLoader.loadStylesheet(\n                `https://checkoutshopper-${\n                    configuration.environment ?? ''\n                }.adyen.com/checkoutshopper/sdk/3.10.1/adyen.css`,\n                {\n                    prepend: false,\n                    attributes: {\n                        integrity:\n                            'sha384-8ofgICZZ/k5cC5N7xegqFZOA73H9RQ7H13439JfAZW8Gj3qjuKL2isaTD3GMIhDE',\n                        crossorigin: 'anonymous',\n                    },\n                },\n            ),\n            this._scriptLoader.loadScript(\n                `https://checkoutshopper-${\n                    configuration.environment ?? ''\n                }.adyen.com/checkoutshopper/sdk/3.10.1/adyen.js`,\n                {\n                    async: true,\n                    attributes: {\n                        integrity:\n                            'sha384-wG2z9zSQo61EIvyXmiFCo+zB3y0ZB4hsrXVcANmpP8HLthjoQJQPBh7tZKJSV8jA',\n                        crossorigin: 'anonymous',\n                    },\n                },\n            ),\n        ]);\n\n        if (!this._window.AdyenCheckout) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return new this._window.AdyenCheckout(configuration);\n    }\n}\n","import ResolvableModule from './resolvable-module';\n\nexport default function toResolvableModule<TModule, TIdentifier>(\n    module: TModule,\n    resolveIds: TIdentifier[],\n): ResolvableModule<TModule, TIdentifier> {\n    return Object.assign(module, { resolveIds });\n}\n","import { AdyenAdditionalActionErrorResponse } from '../types';\n\nexport default function isAdditionalActionRequiredErrorResponse(\n    param: unknown,\n): param is AdyenAdditionalActionErrorResponse {\n    return (\n        typeof param === 'object' &&\n        param !== null &&\n        'errors' in (param as AdyenAdditionalActionErrorResponse) &&\n        Array.isArray((param as AdyenAdditionalActionErrorResponse).errors) &&\n        'code' in (param as AdyenAdditionalActionErrorResponse).errors[0] &&\n        typeof (param as AdyenAdditionalActionErrorResponse).errors[0].code === 'string' &&\n        'provider_data' in param &&\n        typeof (param as AdyenAdditionalActionErrorResponse).provider_data === 'object'\n    );\n}\n","import BrowserInfo from './browser-info';\n\nexport default function getBrowserInfo(): BrowserInfo {\n    const { navigator } = window;\n\n    let language: string;\n\n    if (navigator.language) {\n        language = navigator.language;\n    } else {\n        language = (navigator as any).userLanguage;\n    }\n\n    return {\n        color_depth: window.screen.colorDepth || 24,\n        java_enabled: typeof navigator.javaEnabled === 'function' ? navigator.javaEnabled() : false,\n        language,\n        screen_height: window.screen.height,\n        screen_width: window.screen.width,\n        time_zone_offset: new Date().getTimezoneOffset().toString(),\n    };\n}\n","import RequestError from './request-error';\n\n// Have to use `as` https://stackoverflow.com/questions/73987044/typeguarding-an-unknown-nested-object should be fixed in 4.8+\nconst isRequestError = (error: unknown): error is RequestError => {\n    return typeof error === 'object' && error !== null && 'body' in error;\n};\n\nexport default isRequestError;\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when the payment flow is cancelled. It could be\n * due to a deliberate user interaction, i.e.: the user clicks on a cancel\n * button which dismisses the payment modal.\n */\nexport default class PaymentMethodCancelledError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Payment process was cancelled.');\n\n        this.name = 'PaymentMethodCancelledError';\n        this.type = 'payment_cancelled';\n    }\n}\n","import StandardError from './standard-error';\n\nexport enum NotInitializedErrorType {\n    CheckoutButtonNotInitialized,\n    CustomerNotInitialized,\n    PaymentNotInitialized,\n    ShippingNotInitialized,\n    SpamProtectionNotInitialized,\n}\n\n/**\n * Throw this error if a method requires a certain initialization call to be\n * made first. Some objects can be constructed but they cannot be used until a\n * separate initialization call is made.\n */\nexport default class NotInitializedError extends StandardError {\n    constructor(public subtype: NotInitializedErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'NotInitializedError';\n        this.type = 'not_initialized';\n    }\n}\n\nfunction getErrorMessage(type: NotInitializedErrorType): string {\n    switch (type) {\n        case NotInitializedErrorType.CustomerNotInitialized:\n            return 'Unable to proceed because the customer step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.PaymentNotInitialized:\n            return 'Unable to proceed because the payment step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.ShippingNotInitialized:\n            return 'Unable to proceed because the shipping step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.SpamProtectionNotInitialized:\n            return 'Unable to proceed because the checkout spam protection has not been initialized.';\n\n        default:\n            return 'Unable to proceed because the required component has not been initialized.';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","/**\n * Decorates a class or a method by binding all its prototype methods or itself\n * to the calling instance respectively.\n */\nfunction bindDecorator<T extends Method>(\n    target: object,\n    key: string,\n    descriptor: TypedPropertyDescriptor<T>,\n): TypedPropertyDescriptor<T>;\nfunction bindDecorator<T extends Constructor<object>>(target: T): T;\n\nfunction bindDecorator(target: any, key?: any, descriptor?: any): any {\n    if (!key || !descriptor) {\n        return bindClassDecorator(target);\n    }\n\n    return bindMethodDecorator(target, key, descriptor);\n}\n\nexport default bindDecorator;\n\n/**\n * Decorates a class by binding all its prototype methods to the calling\n * instance.\n */\nexport function bindClassDecorator<T extends Constructor<object>>(target: T): T {\n    const decoratedTarget = class extends target {};\n\n    Object.getOwnPropertyNames(target.prototype).forEach((key) => {\n        const descriptor = Object.getOwnPropertyDescriptor(target.prototype, key);\n\n        if (!descriptor || key === 'constructor') {\n            return;\n        }\n\n        Object.defineProperty(\n            decoratedTarget.prototype,\n            key,\n            bindMethodDecorator(target.prototype, key, descriptor),\n        );\n    });\n\n    return decoratedTarget;\n}\n\n/**\n * Decorates a method by binding it to the calling instance.\n */\nexport function bindMethodDecorator<T extends Method>(\n    _: object,\n    key: string,\n    descriptor: TypedPropertyDescriptor<T>,\n): TypedPropertyDescriptor<T> {\n    if (typeof descriptor.value !== 'function') {\n        return descriptor;\n    }\n\n    let method: T = descriptor.value;\n\n    return {\n        get() {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            const boundMethod = method.bind(this) as T;\n\n            Object.defineProperty(this, key, {\n                ...descriptor,\n                value: boundMethod,\n            });\n\n            return boundMethod;\n        },\n        set(value) {\n            method = value;\n        },\n    };\n}\n\nexport type Constructor<T> = new (...args: any[]) => T;\nexport type Method = (...args: any[]) => any;\n","import { InvalidArgumentError } from '../errors';\n\nimport { CurrencyConfig } from './currency';\n\nexport default class CurrencyFormatter {\n    private _decimalPlaces: number;\n    private _symbolLocation: string;\n    private _symbol: string;\n    private _thousandsSeparator: string;\n    private _decimalSeparator: string;\n\n    constructor(currencySettings: CurrencyConfig) {\n        if (!currencySettings) {\n            throw new Error('Currency settings missing');\n        }\n\n        const { decimalPlaces, symbolLocation, symbol, thousandsSeparator, decimalSeparator } =\n            currencySettings;\n\n        if (\n            typeof symbolLocation !== 'string' ||\n            typeof symbol !== 'string' ||\n            typeof thousandsSeparator !== 'string' ||\n            typeof decimalSeparator !== 'string' ||\n            typeof decimalPlaces !== 'string'\n        ) {\n            throw new InvalidArgumentError('Invalid currency settings provided');\n        }\n\n        this._decimalPlaces = parseInt(decimalPlaces, 10);\n        this._symbolLocation = symbolLocation;\n        this._symbol = symbol;\n        this._thousandsSeparator = thousandsSeparator;\n        this._decimalSeparator = decimalSeparator;\n    }\n\n    format(amount?: number): string {\n        if (typeof amount !== 'number') {\n            throw new InvalidArgumentError('Invalid amount provided');\n        }\n\n        const formattedNumber = this._formatNumber(amount);\n\n        const formattedCurrency = this._formatCurrency(formattedNumber);\n\n        return amount < 0 ? `-${formattedCurrency}` : formattedCurrency;\n    }\n\n    private _formatNumber(amount: number): string {\n        const positiveAmount = Math.abs(amount);\n        const [integerAmount, decimalAmount = ''] = this._toFixed(\n            positiveAmount,\n            this._decimalPlaces,\n        ).split('.');\n        const parsedIntegerAmount = integerAmount.replace(\n            /\\B(?=(\\d{3})+(?!\\d))/g,\n            this._thousandsSeparator,\n        );\n\n        if (this._decimalPlaces < 1) {\n            return parsedIntegerAmount;\n        }\n\n        return [parsedIntegerAmount, decimalAmount].join(this._decimalSeparator);\n    }\n\n    private _formatCurrency(formattedNumber: string): string {\n        return this._symbolLocation.toLowerCase() === 'left'\n            ? `${this._symbol}${formattedNumber}`\n            : `${formattedNumber}${this._symbol}`;\n    }\n\n    private _toFixed(value: number, precision: number): string {\n        return (+`${Math.round(+`${value}e${precision}`)}e${-precision}`).toFixed(precision);\n    }\n}\n","import { bindDecorator as bind } from '@bigcommerce/checkout-sdk/utility';\n\nimport { StoreConfig } from '../config';\n\nimport CurrencyFormatter from './currency-formatter';\n\n/**\n * Responsible for formatting and converting currencies.\n */\n@bind\nexport default class CurrencyService {\n    private _customerFormatter: CurrencyFormatter;\n    private _storeFormatter: CurrencyFormatter;\n\n    /**\n     * @internal\n     */\n    constructor(private _storeConfig: StoreConfig) {\n        this._customerFormatter = new CurrencyFormatter(this._storeConfig.shopperCurrency);\n        this._storeFormatter = new CurrencyFormatter(this._storeConfig.currency);\n    }\n\n    toCustomerCurrency(amount: number): string {\n        const exchangeRate = this._storeConfig.shopperCurrency.exchangeRate;\n\n        return this._customerFormatter.format(amount * exchangeRate);\n    }\n\n    toStoreCurrency(amount: number): string {\n        return this._storeFormatter.format(amount);\n    }\n}\n","export default function guard<T>(value: T, errorFactory?: () => Error): NonNullable<T> {\n    if (value === undefined || value === null) {\n        throw errorFactory ? errorFactory() : new Error('An unexpected error has occurred.');\n    }\n\n    return value as NonNullable<T>;\n}\n","export interface Features {\n    [featureName: string]: boolean | undefined;\n}\n\nexport default function isExperimentEnabled(\n    features: Features,\n    experimentName: string,\n    fallbackValue = true,\n): boolean {\n    return features[experimentName] ?? fallbackValue;\n}\n","import { BigCommercePaymentsIntent } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    BrowserInfo,\n    BuyNowCartRequestBody,\n    RequestError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { FundingType } from './google-pay-paypal-commerce/types';\n\nexport enum PayPalCommerceIntent {\n    AUTHORIZE = 'authorize',\n    CAPTURE = 'capture',\n}\n\nexport enum StyleButtonLabel {\n    paypal = 'paypal',\n    checkout = 'checkout',\n    buynow = 'buynow',\n    pay = 'pay',\n    installment = 'installment',\n}\n\nexport enum StyleButtonColor {\n    gold = 'gold',\n    blue = 'blue',\n    silver = 'silver',\n    black = 'black',\n    white = 'white',\n}\n\nexport enum StyleButtonShape {\n    pill = 'pill',\n    rect = 'rect',\n}\n\nexport interface PayPalButtonStyleOptions {\n    color?: StyleButtonColor;\n    shape?: StyleButtonShape;\n    height?: number;\n    label?: StyleButtonLabel;\n}\n\nexport interface GooglePayGatewayBaseRequest {\n    apiVersion: 2;\n    apiVersionMinor: 0;\n}\n\nexport enum TotalPriceStatusType {\n    ESTIMATED = 'ESTIMATED',\n    FINAL = 'FINAL',\n    NOT_CURRENTLY_KNOWN = 'NOT_CURRENTLY_KNOWN',\n}\n\ntype GooglePayGatewayBaseResponse = GooglePayGatewayBaseRequest;\n\ninterface GooglePayPaymentMethod<T> {\n    type: string;\n    parameters: T;\n}\n\ntype GooglePayAuthMethod = 'PAN_ONLY' | 'CRYPTOGRAM_3DS';\n\nexport enum GooglePayCardNetwork {\n    AMEX = 'AMEX',\n    DISCOVER = 'DISCOVER',\n    INTERAC = 'INTERAC',\n    JCB = 'JCB',\n    MC = 'MASTERCARD',\n    VISA = 'VISA',\n}\n\nexport interface GooglePayCardParameters {\n    allowedAuthMethods: GooglePayAuthMethod[];\n    allowedCardNetworks: GooglePayCardNetwork[];\n    billingAddressRequired?: boolean;\n    billingAddressParameters?: {\n        format?: 'MIN' | 'FULL';\n        phoneNumberRequired?: boolean;\n    };\n}\n\nexport interface GooglePayBaseCardPaymentMethod\n    extends GooglePayPaymentMethod<GooglePayCardParameters> {\n    type: 'CARD';\n    parameters: GooglePayCardParameters;\n}\n\nexport interface GooglePayIsReadyToPayRequest extends GooglePayGatewayBaseRequest {\n    allowedPaymentMethods: [GooglePayBaseCardPaymentMethod];\n}\n\ninterface GooglePayGatewayBaseParameters {\n    gateway: string;\n}\n\nexport interface GooglePayRegularGatewayParameters extends GooglePayGatewayBaseParameters {\n    gatewayMerchantId: string;\n}\n\nexport interface GooglePayStripeGatewayParameters extends GooglePayGatewayBaseParameters {\n    'stripe:version'?: string;\n    'stripe:publishableKey'?: string;\n}\n\nexport interface GooglePayBraintreeGatewayParameters extends GooglePayGatewayBaseParameters {\n    'braintree:apiVersion'?: string;\n    'braintree:authorizationFingerprint'?: string;\n    'braintree:merchantId'?: string;\n    'braintree:sdkVersion'?: string;\n}\n\nexport interface GooglePayPayPalCommerceGatewayParameters extends GooglePayGatewayBaseParameters {\n    gatewayMerchantId?: string;\n}\n\nexport type GooglePayGatewayParameters =\n    | GooglePayRegularGatewayParameters\n    | GooglePayStripeGatewayParameters\n    | GooglePayBraintreeGatewayParameters;\n\nexport interface GooglePayCardPaymentMethod extends GooglePayBaseCardPaymentMethod {\n    tokenizationSpecification: {\n        type: 'PAYMENT_GATEWAY';\n        parameters: GooglePayGatewayParameters;\n    };\n}\n\nexport interface GooglePayTransactionInfo {\n    /** [!] Required for EEA countries */\n    countryCode?: string;\n    currencyCode: string;\n    totalPriceStatus: TotalPriceStatusType;\n    totalPrice: string;\n}\n\nexport interface GooglePayMerchantInfo {\n    merchantName: string;\n    merchantId: string;\n    authJwt: string;\n}\n\nexport enum CallbackIntentsType {\n    OFFER = 'OFFER',\n    PAYMENT_AUTHORIZATION = 'PAYMENT_AUTHORIZATION',\n    SHIPPING_ADDRESS = 'SHIPPING_ADDRESS',\n    SHIPPING_OPTION = 'SHIPPING_OPTION',\n}\n\nexport interface GooglePayPaymentDataRequest extends GooglePayGatewayBaseRequest {\n    allowedPaymentMethods: [GooglePayCardPaymentMethod];\n    transactionInfo: GooglePayTransactionInfo;\n    merchantInfo: GooglePayMerchantInfo;\n    emailRequired?: boolean;\n    shippingAddressRequired?: boolean;\n    shippingAddressParameters?: {\n        allowedCountryCodes?: string[];\n        phoneNumberRequired?: boolean;\n    };\n    offerInfo: Offers;\n    shippingOptionRequired?: boolean;\n    callbackIntents?: CallbackIntentsType[];\n}\n\nexport interface NewTransactionInfo {\n    newTransactionInfo: {\n        currencyCode: string;\n        totalPrice: string;\n        totalPriceStatus: TotalPriceStatusType;\n    };\n}\n\nexport interface ShippingOptionParameters {\n    defaultSelectedOptionId?: string;\n    shippingOptions?: GoogleShippingOption[];\n}\n\nexport interface NewShippingOptionParameters {\n    newShippingOptionParameters?: ShippingOptionParameters;\n}\n\nexport interface NewOfferInfo {\n    newOfferInfo?: Offers;\n}\n\nexport interface Offers {\n    offers: OfferInfoItem[];\n}\n\nexport interface GooglePayError {\n    message: string;\n    reason: ErrorReasonType;\n    intent: CallbackTriggerType;\n}\n\nexport enum ErrorReasonType {\n    OFFER_INVALID = 'OFFER_INVALID',\n    PAYMENT_DATA_INVALID = 'PAYMENT_DATA_INVALID',\n    SHIPPING_ADDRESS_INVALID = 'SHIPPING_ADDRESS_INVALID',\n    SHIPPING_ADDRESS_UNSERVICEABLE = 'SHIPPING_ADDRESS_UNSERVICEABLE',\n    SHIPPING_OPTION_INVALID = 'SHIPPING_OPTION_INVALID',\n    OTHER_ERROR = 'OTHER_ERROR',\n}\n\nexport interface OfferInfoItem {\n    redemptionCode: string;\n    description: string;\n}\n\nexport interface HandleCouponsOut {\n    newOfferInfo: GooglePayPaymentDataRequest['offerInfo'];\n    error?: GooglePayError;\n}\n\nexport interface GoogleShippingOption {\n    id: string;\n    label?: string;\n}\n\nexport enum CallbackTriggerType {\n    INITIALIZE = 'INITIALIZE',\n    SHIPPING_OPTION = 'SHIPPING_OPTION',\n    SHIPPING_ADDRESS = 'SHIPPING_ADDRESS',\n    OFFER = 'OFFER',\n}\n\nexport interface IntermediatePaymentData {\n    callbackTrigger: CallbackTriggerType;\n    shippingAddress: GooglePayFullBillingAddress;\n    shippingOptionData: GoogleShippingOption;\n    offerData: {\n        redemptionCodes: string[];\n    };\n}\n\nexport interface GooglePayPaymentOptions {\n    paymentDataCallbacks?: {\n        onPaymentDataChanged(\n            intermediatePaymentData: IntermediatePaymentData,\n        ): onPaymentDataChangedOut;\n    };\n}\n\nexport type onPaymentDataChangedOut = Promise<\n    | (NewTransactionInfo & NewShippingOptionParameters & NewOfferInfo & { error?: GooglePayError })\n    | void\n>;\n\nexport type GooglePayRequiredPaymentData = Pick<\n    GooglePayPaymentDataRequest,\n    | 'emailRequired'\n    | 'shippingAddressRequired'\n    | 'shippingAddressParameters'\n    | 'shippingOptionRequired'\n>;\n\ninterface GooglePayMinBillingAddress {\n    name: string;\n    postalCode: string;\n    countryCode: string;\n    phoneNumber?: string;\n}\n\nexport interface GooglePayFullBillingAddress extends GooglePayMinBillingAddress {\n    address1: string;\n    address2: string;\n    address3: string;\n    locality: string;\n    administrativeArea: string;\n    sortingCode: string;\n}\n\ninterface GooglePayCardInfo {\n    cardNetwork: GooglePayCardNetwork;\n    cardDetails: string;\n    billingAddress?: GooglePayFullBillingAddress;\n}\n\ninterface GooglePayPaymentMethodData<T> {\n    description: string;\n    tokenizationData: {\n        type: 'PAYMENT_GATEWAY';\n        token: string;\n    };\n    type: string;\n    info: T;\n}\n\ninterface GooglePayCardData extends GooglePayPaymentMethodData<GooglePayCardInfo> {\n    type: 'CARD';\n}\n\ninterface GooglePayPaymentDataResponse<T> extends GooglePayGatewayBaseResponse {\n    paymentMethodData: GooglePayPaymentMethodData<T>;\n    shippingAddress?: GooglePayFullBillingAddress;\n    email?: string;\n}\n\nexport interface GooglePayCardDataResponse extends GooglePayPaymentDataResponse<GooglePayCardInfo> {\n    paymentMethodData: GooglePayCardData;\n}\n\ninterface GooglePayIsReadyToPayResponse {\n    result: boolean;\n}\n\nexport interface GooglePayButtonOptions {\n    onClick: (event: MouseEvent) => Promise<void>;\n    allowedPaymentMethods: [GooglePayBaseCardPaymentMethod];\n    buttonColor?: GooglePayButtonColor;\n    buttonType?: GooglePayButtonType;\n}\n\nexport interface GooglePaymentsClient {\n    isReadyToPay(request: GooglePayIsReadyToPayRequest): Promise<GooglePayIsReadyToPayResponse>;\n    createButton(options: GooglePayButtonOptions): HTMLElement;\n    loadPaymentData(request: GooglePayPaymentDataRequest): Promise<GooglePayCardDataResponse>;\n    prefetchPaymentData(request: GooglePayPaymentDataRequest): void;\n}\n\ntype GooglePayEnvironment = 'TEST' | 'PRODUCTION';\n\nexport type GooglePaymentsClientConstructor = new (paymentOptions: {\n    environment: GooglePayEnvironment;\n}) => GooglePaymentsClient;\n\nexport interface GooglePayHostWindow extends Window {\n    google?: {\n        payments: {\n            api: {\n                PaymentsClient: GooglePaymentsClientConstructor;\n            };\n        };\n    };\n}\n\ninterface GooglePayBaseInitializationData {\n    card_information?: { type: string; number: string; bin?: string; isNetworkTokenized?: boolean };\n    gateway: string;\n    gatewayMerchantId?: string;\n    googleMerchantId: string;\n    googleMerchantName: string;\n    isThreeDSecureEnabled: boolean;\n    nonce?: string;\n    platformToken: string;\n    storeCountry?: string;\n}\n\nexport interface GooglePayPayPalCommerceInitializationData extends GooglePayBaseInitializationData {\n    merchantId?: string;\n    clientId: string;\n    attributionId?: string;\n    availableAlternativePaymentMethods: FundingType;\n    buttonStyle?: PayPalButtonStyleOptions;\n    buyerCountry?: string;\n    clientToken?: string;\n    enabledAlternativePaymentMethods: FundingType;\n    isDeveloperModeApplicable?: boolean;\n    intent?: PayPalCommerceIntent;\n    isHostedCheckoutEnabled?: boolean;\n    isPayPalCreditAvailable?: boolean;\n    isVenmoEnabled?: boolean;\n    isGooglePayEnabled?: boolean;\n    orderId?: string;\n    shouldRenderFields?: boolean;\n    paymentButtonStyles?: Record<string, PayPalButtonStyleOptions>;\n}\n\nexport interface GooglePayBigCommercePaymentsInitializationData\n    extends GooglePayBaseInitializationData {\n    merchantId?: string;\n    clientId: string;\n    attributionId?: string;\n    availableAlternativePaymentMethods: FundingType;\n    buttonStyle?: PayPalButtonStyleOptions;\n    buyerCountry?: string;\n    clientToken?: string;\n    enabledAlternativePaymentMethods: FundingType;\n    isDeveloperModeApplicable?: boolean;\n    intent?: BigCommercePaymentsIntent;\n    isHostedCheckoutEnabled?: boolean;\n    isPayPalCreditAvailable?: boolean;\n    isVenmoEnabled?: boolean;\n    isGooglePayEnabled?: boolean;\n    orderId?: string;\n    shouldRenderFields?: boolean;\n    paymentButtonStyles?: Record<string, PayPalButtonStyleOptions>;\n}\n\nexport interface GooglePayAuthorizeNetInitializationData extends GooglePayBaseInitializationData {\n    paymentGatewayId: string;\n}\n\nexport interface GooglePayStripeInitializationData extends GooglePayBaseInitializationData {\n    stripeConnectedAccount: string;\n    stripePublishableKey: string;\n    stripeVersion: string;\n    shopperLanguage: string;\n    useNewStripeJsVersion?: boolean;\n}\n\nexport interface GooglePayCheckoutComInitializationData extends GooglePayBaseInitializationData {\n    checkoutcomkey: string;\n}\n\nexport interface GooglePayAdyenV2InitializationData extends GooglePayBaseInitializationData {\n    originKey?: string;\n    clientKey?: string;\n    environment?: string;\n    prefillCardHolderName?: boolean;\n    paymentMethodsResponse: object;\n}\n\nexport interface GooglePayConfig {\n    allowedPaymentMethods: AllowedPaymentMethods[];\n    apiVersion: number;\n    apiVersionMinor: number;\n    countryCode: string;\n    isEligible: boolean;\n    merchantInfo: {\n        merchantId: string;\n        merchantOrigin: string;\n    };\n}\n\nexport interface AllowedPaymentMethods {\n    type: string;\n    parameters: {\n        allowedAuthMethods: string[];\n        allowedCardNetworks: string[];\n        billingAddressRequired: boolean;\n        assuranceDetailsRequired: boolean;\n        billingAddressParameters: {\n            format: string;\n        };\n    };\n    tokenizationSpecification: {\n        type: string;\n        parameters: {\n            gateway: string;\n            gatewayMerchantId: string;\n        };\n    };\n}\n\nexport interface GooglePayAdyenV3InitializationData extends GooglePayBaseInitializationData {\n    clientKey: string;\n    environment?: string;\n    prefillCardHolderName?: boolean;\n    paymentMethodsResponse: object;\n}\n\nexport type GooglePayInitializationData =\n    | GooglePayBaseInitializationData\n    | GooglePayAdyenV2InitializationData\n    | GooglePayAdyenV3InitializationData\n    | GooglePayAuthorizeNetInitializationData\n    | GooglePayStripeInitializationData\n    | GooglePayCheckoutComInitializationData\n    | GooglePayPayPalCommerceInitializationData\n    | GooglePayBigCommercePaymentsInitializationData;\n\nexport interface GooglePaySetExternalCheckoutData {\n    nonce: string;\n    card_information: { type: string; number: string; bin?: string; isNetworkTokenized?: boolean };\n    cart_id?: string;\n}\n\nexport interface GooglePayAdditionalActionProcessable {\n    processAdditionalAction(error: unknown, methodId?: string): Promise<void>;\n}\n\nexport interface GooglePayErrorObject {\n    errorCode?: number;\n    statusCode: 'CANCELED' | 'DEVELOPER_ERROR';\n    statusMessage?: string;\n}\n\nexport interface GooglePayTokenObject {\n    protocolVersion: string;\n    signature: string;\n    signedMessage: string;\n}\n\nexport interface GooglePayStripeTokenObject {\n    id: string;\n}\n\nexport interface GooglePayBraintreeTokenObject {\n    androidPayCards: [\n        {\n            nonce: string;\n            details: {\n                bin: string;\n                isNetworkTokenized?: boolean;\n            };\n        },\n    ];\n}\n\nexport interface GooglePayCheckoutComTokenObject {\n    token: string;\n}\n\nexport interface GooglePayThreeDSecureResult {\n    three_ds_result: {\n        acs_url: string;\n        code: string;\n    };\n}\n\nexport interface GooglePayBuyNowInitializeOptions {\n    getBuyNowCartRequestBody?(): BuyNowCartRequestBody;\n}\n\nexport interface ExtraPaymentData {\n    deviceSessionId?: string;\n    browser_info?: BrowserInfo;\n}\n\nexport type GooglePayButtonColor = 'default' | 'black' | 'white';\nexport type GooglePayButtonType =\n    | 'book'\n    | 'buy'\n    | 'checkout'\n    | 'donate'\n    | 'order'\n    | 'pay'\n    | 'plain'\n    | 'subscribe'\n    | 'long'\n    | 'short';\n\nexport interface TdOnlineMartThreeDSErrorBody {\n    errors?: Array<{ code: string }>;\n    three_ds_result?: {\n        acs_url: string;\n        payer_auth_request: string;\n        merchant_data: string;\n    };\n}\n\nexport type TdOnlineMartAdditionalAction = RequestError<TdOnlineMartThreeDSErrorBody>;\n","import { GooglePayCardNetwork } from '../types';\n\nexport default function isGooglePayCardNetworkKey(\n    card: string,\n): card is keyof typeof GooglePayCardNetwork {\n    return card in GooglePayCardNetwork;\n}\n","import { round } from 'lodash';\n\nimport {\n    AddressRequestBody,\n    BillingAddressRequestBody,\n    createCurrencyService,\n    CurrencyService,\n    guard,\n    InvalidArgumentError,\n    itemsRequireShipping,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    PaymentIntegrationService,\n    PaymentMethod,\n    ShippingOption,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { isExperimentEnabled } from '@bigcommerce/checkout-sdk/utility';\n\nimport isGooglePayCardNetworkKey from '../guards/is-google-pay-card-network-key';\nimport {\n    CallbackIntentsType,\n    CallbackTriggerType,\n    ErrorReasonType,\n    ExtraPaymentData,\n    GooglePayCardDataResponse,\n    GooglePayCardNetwork,\n    GooglePayCardParameters,\n    GooglePayError,\n    GooglePayFullBillingAddress,\n    GooglePayGatewayParameters,\n    GooglePayInitializationData,\n    GooglePayMerchantInfo,\n    GooglePayPaymentDataRequest,\n    GooglePayRequiredPaymentData,\n    GooglePaySetExternalCheckoutData,\n    GooglePayTransactionInfo,\n    HandleCouponsOut,\n    IntermediatePaymentData,\n    ShippingOptionParameters,\n    TotalPriceStatusType,\n} from '../types';\n\nexport default class GooglePayGateway {\n    private _getPaymentMethodFn?: () => PaymentMethod<GooglePayInitializationData>;\n    private _isBuyNowFlow = false;\n    private _shouldRequestShipping = true;\n    private _currencyCode?: string;\n    private _currencyService?: CurrencyService;\n\n    constructor(\n        private _gatewayIdentifier: string,\n        private _paymentIntegrationService: PaymentIntegrationService,\n    ) {}\n\n    mapToShippingAddressRequestBody({\n        shippingAddress,\n    }: GooglePayCardDataResponse): AddressRequestBody | undefined {\n        if (!shippingAddress) {\n            return;\n        }\n\n        const { company = '', phone = '' } =\n            this._paymentIntegrationService.getState().getShippingAddress() || {};\n\n        return this._mapToAddressRequestBody(shippingAddress, company, phone);\n    }\n\n    mapToBillingAddressRequestBody(\n        response: GooglePayCardDataResponse,\n    ): BillingAddressRequestBody | undefined {\n        const { billingAddress } = response.paymentMethodData.info;\n\n        if (!billingAddress) {\n            return;\n        }\n\n        const {\n            company = '',\n            phone = '',\n            email,\n            customFields = [],\n        } = this._paymentIntegrationService.getState().getBillingAddress() || {};\n\n        return {\n            ...this._mapToAddressRequestBody(billingAddress, company, phone, customFields),\n            email: email || response.email,\n        };\n    }\n\n    mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const {\n            paymentMethodData: {\n                tokenizationData: { token: nonce },\n                info: { cardNetwork: type, cardDetails: number },\n            },\n        } = response;\n\n        if (!nonce) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentToken);\n        }\n\n        return Promise.resolve({\n            nonce,\n            card_information: { type, number },\n            ...(this._isBuyNowFlow && {\n                cart_id: this._paymentIntegrationService.getState().getCart()?.id,\n            }),\n        });\n    }\n\n    async getRequiredData(): Promise<GooglePayRequiredPaymentData> {\n        const data: GooglePayRequiredPaymentData = { emailRequired: true };\n\n        if (!this._isShippingAddressRequired()) {\n            return data;\n        }\n\n        const state = await this._paymentIntegrationService.loadShippingCountries();\n        const allowedCountryCodes = state.getShippingCountries()?.map((country) => country.code);\n\n        return {\n            ...data,\n            shippingAddressRequired: true,\n            shippingAddressParameters: {\n                phoneNumberRequired: true,\n                ...(allowedCountryCodes && { allowedCountryCodes }),\n            },\n            shippingOptionRequired: true,\n        };\n    }\n\n    getCallbackIntents(): CallbackIntentsType[] {\n        if (this._isShippingAddressRequired()) {\n            return [\n                CallbackIntentsType.OFFER,\n                CallbackIntentsType.SHIPPING_ADDRESS,\n                CallbackIntentsType.SHIPPING_OPTION,\n            ];\n        }\n\n        return [CallbackIntentsType.OFFER];\n    }\n\n    getCallbackTriggers(): { [key: string]: CallbackTriggerType[] } {\n        const availableTriggers = [\n            CallbackTriggerType.INITIALIZE,\n            CallbackTriggerType.SHIPPING_ADDRESS,\n            CallbackTriggerType.SHIPPING_OPTION,\n            CallbackTriggerType.OFFER,\n        ];\n\n        const initializationTrigger = [CallbackTriggerType.INITIALIZE];\n        const addressChangeTriggers = [\n            CallbackTriggerType.INITIALIZE,\n            CallbackTriggerType.SHIPPING_ADDRESS,\n        ];\n        const shippingOptionsChangeTriggers = [CallbackTriggerType.SHIPPING_OPTION];\n        const offerChangeTriggers = [CallbackTriggerType.OFFER];\n\n        return {\n            availableTriggers,\n            initializationTrigger,\n            addressChangeTriggers,\n            shippingOptionsChangeTriggers,\n            offerChangeTriggers,\n        };\n    }\n\n    getNonce(methodId: string) {\n        const nonce = this._paymentIntegrationService\n            .getState()\n            .getPaymentMethodOrThrow<GooglePayInitializationData>(methodId)\n            .initializationData?.nonce;\n\n        if (!nonce) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentToken);\n        }\n\n        return Promise.resolve(nonce);\n    }\n\n    extraPaymentData(): Promise<undefined | ExtraPaymentData> {\n        return Promise.resolve(undefined);\n    }\n\n    getMerchantInfo(): GooglePayMerchantInfo {\n        const {\n            googleMerchantName: merchantName,\n            googleMerchantId: merchantId,\n            platformToken: authJwt,\n        } = this.getGooglePayInitializationData();\n\n        return { merchantName, merchantId, authJwt };\n    }\n\n    getTransactionInfo(): GooglePayTransactionInfo {\n        let currencyCode: string;\n\n        if (this._isBuyNowFlow) {\n            currencyCode = this._getCurrencyCodeOrThrow();\n        } else {\n            const { getCartOrThrow } = this._paymentIntegrationService.getState();\n\n            currencyCode = getCartOrThrow().currency.code;\n        }\n\n        const countryCode = this.getGooglePayInitializationData().storeCountry;\n\n        return {\n            ...(countryCode && { countryCode }),\n            currencyCode,\n            totalPriceStatus: TotalPriceStatusType.ESTIMATED,\n            totalPrice: '0',\n        };\n    }\n\n    getPaymentGatewayParameters():\n        | Promise<GooglePayGatewayParameters>\n        | GooglePayGatewayParameters {\n        const gatewayMerchantId = this.getGooglePayInitializationData().gatewayMerchantId;\n\n        if (!gatewayMerchantId) {\n            throw new InvalidArgumentError('Unable to proceed, gatewayMerchantId is missing.');\n        }\n\n        return {\n            gateway: this._gatewayIdentifier,\n            gatewayMerchantId,\n        };\n    }\n\n    getCardParameters(): GooglePayCardParameters {\n        const allowedCardNetworks = this.getPaymentMethod()\n            .supportedCards.filter(isGooglePayCardNetworkKey)\n            .map((key) => GooglePayCardNetwork[key]);\n\n        return {\n            allowedAuthMethods: ['PAN_ONLY', 'CRYPTOGRAM_3DS'],\n            allowedCardNetworks,\n            billingAddressRequired: true,\n            billingAddressParameters: {\n                format: 'FULL',\n                phoneNumberRequired: true,\n            },\n        };\n    }\n\n    initialize(\n        getPaymentMethod: () => PaymentMethod<GooglePayInitializationData>,\n        isBuyNowFlow?: boolean,\n        currencyCode?: string,\n    ): Promise<void> {\n        this._getPaymentMethodFn = getPaymentMethod;\n        this._isBuyNowFlow = Boolean(isBuyNowFlow);\n        this._currencyCode = currencyCode;\n\n        if (this._isBuyNowFlow) {\n            this._getCurrencyCodeOrThrow();\n        }\n\n        return Promise.resolve();\n    }\n\n    async handleShippingAddressChange(\n        shippingAddress?: GooglePayFullBillingAddress,\n    ): Promise<ShippingOptionParameters | undefined> {\n        if (shippingAddress) {\n            shippingAddress.name = shippingAddress.name || '';\n            shippingAddress.address1 = shippingAddress.address1 || '';\n        }\n\n        const mappedShippingAddress = this.mapToShippingAddressRequestBody({\n            shippingAddress,\n        } as GooglePayCardDataResponse);\n\n        if (mappedShippingAddress) {\n            await this._paymentIntegrationService.updateShippingAddress(mappedShippingAddress);\n        }\n\n        const state = this._paymentIntegrationService.getState();\n        const consignments = state.getConsignments();\n\n        if (!consignments?.[0]) {\n            // Info: we can not return an empty data because shippingOptions should contain at least one element, it caused a developer exception\n            return;\n        }\n\n        const consignment = consignments[0];\n        const storeConfig = state.getStoreConfigOrThrow();\n\n        if (!this._currencyService) {\n            this._currencyService = createCurrencyService(storeConfig);\n        }\n\n        const availableShippingOptions = (consignment.availableShippingOptions || []).map(\n            this._getGooglePayShippingOption.bind(this),\n        );\n\n        const recommendedShippingOption = consignment.availableShippingOptions?.find(\n            (shippingOption) => shippingOption.isRecommended,\n        );\n\n        if (availableShippingOptions.length) {\n            const selectedShippingOptionId =\n                consignment.selectedShippingOption?.id ||\n                recommendedShippingOption?.id ||\n                availableShippingOptions[0]?.id;\n\n            if (!consignment.selectedShippingOption?.id && availableShippingOptions[0]) {\n                await this.handleShippingOptionChange(\n                    recommendedShippingOption?.id || availableShippingOptions[0].id,\n                );\n            }\n\n            return {\n                defaultSelectedOptionId: selectedShippingOptionId,\n                shippingOptions: availableShippingOptions,\n            };\n        }\n    }\n\n    async handleShippingOptionChange(optionId: string) {\n        if (optionId === 'shipping_option_unselected') {\n            return;\n        }\n\n        return this._paymentIntegrationService.selectShippingOption(optionId);\n    }\n\n    getTotalPrice(): string {\n        const { getCheckoutOrThrow, getCartOrThrow } = this._paymentIntegrationService.getState();\n        const { decimalPlaces } = getCartOrThrow().currency;\n        const totalPrice = round(getCheckoutOrThrow().outstandingBalance, decimalPlaces).toFixed(\n            decimalPlaces,\n        );\n\n        return totalPrice;\n    }\n\n    async handleCoupons(\n        offerData: IntermediatePaymentData['offerData'],\n    ): Promise<HandleCouponsOut> {\n        const { redemptionCodes: newCouponsState = [] } = offerData;\n        const { offers: appliedCoupons } = this.getAppliedCoupons();\n        let error;\n\n        await newCouponsState.reduce(async (promise, code) => {\n            await promise;\n\n            const exists = appliedCoupons.some(({ redemptionCode }) => redemptionCode === code);\n\n            if (exists) {\n                return;\n            }\n\n            const appliedCouponError = await this.applyCoupon(code);\n\n            if (appliedCouponError) {\n                error = appliedCouponError;\n            }\n        }, Promise.resolve());\n\n        await appliedCoupons.reduce(async (promise, coupon) => {\n            await promise;\n\n            const stillExists = newCouponsState.includes(coupon.redemptionCode);\n\n            if (!stillExists) {\n                await this._paymentIntegrationService.removeCoupon(coupon.redemptionCode);\n            }\n        }, Promise.resolve());\n\n        return {\n            newOfferInfo: this.getAppliedCoupons(),\n            error,\n        };\n    }\n\n    getAppliedCoupons(): GooglePayPaymentDataRequest['offerInfo'] {\n        const state = this._paymentIntegrationService.getState();\n        const { coupons } = state.getCheckout() || {};\n\n        const offers = (coupons || []).map((coupon) => {\n            const { displayName, code } = coupon;\n\n            return {\n                redemptionCode: code,\n                description: displayName,\n            };\n        });\n\n        return {\n            offers,\n        };\n    }\n\n    async applyCoupon(code: string): Promise<GooglePayError | void> {\n        let error: GooglePayError | undefined;\n\n        try {\n            await this._paymentIntegrationService.applyCoupon(code);\n        } catch (e) {\n            if (e instanceof Error) {\n                error = {\n                    reason: ErrorReasonType.OFFER_INVALID,\n                    message: e.message,\n                    intent: CallbackTriggerType.OFFER,\n                };\n            }\n\n            return error;\n        }\n    }\n\n    setShouldRequestShipping(isRequired: boolean): void {\n        this._shouldRequestShipping = isRequired;\n    }\n\n    protected getGooglePayInitializationData(): GooglePayInitializationData {\n        return guard(\n            this.getPaymentMethod().initializationData,\n            () => new InvalidArgumentError('Missing initialization data.'),\n        );\n    }\n\n    protected getPaymentMethod(): PaymentMethod<GooglePayInitializationData> {\n        return guard(\n            this._getPaymentMethodFn,\n            () => new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n        )();\n    }\n\n    protected getGatewayIdentifier(): string {\n        return this._gatewayIdentifier;\n    }\n\n    protected setGatewayIdentifier(gateway?: string) {\n        this._gatewayIdentifier = gateway || this.getGatewayIdentifier();\n    }\n\n    private _isShippingAddressRequired(): boolean {\n        const { getCartOrThrow, getStoreConfigOrThrow, getShippingAddress } =\n            this._paymentIntegrationService.getState();\n        const storeConfig = getStoreConfigOrThrow();\n        const features = storeConfig.checkoutSettings.features;\n        const checkWithExperiment = isExperimentEnabled(\n            features,\n            'PI-4290.google_pay_require_shipping_address',\n        );\n\n        let shippingContextRequiresCheck: boolean;\n\n        if (checkWithExperiment) {\n            shippingContextRequiresCheck = this._shouldRequestShipping;\n        } else {\n            shippingContextRequiresCheck = getShippingAddress() === undefined;\n        }\n\n        return shippingContextRequiresCheck && itemsRequireShipping(getCartOrThrow(), storeConfig);\n    }\n\n    private _mapToAddressRequestBody(\n        address: GooglePayFullBillingAddress,\n        company: string,\n        phone: string,\n        customFields?: AddressRequestBody['customFields'],\n    ): AddressRequestBody {\n        const {\n            name,\n            address1,\n            address2,\n            address3,\n            locality: city,\n            administrativeArea: stateOrProvinceCode,\n            countryCode,\n            postalCode,\n            phoneNumber,\n        } = address;\n        const [firstName, lastName] = this._getFirstAndLastName(name);\n\n        return {\n            firstName,\n            lastName,\n            company,\n            address1,\n            address2: `${address2} ${address3}`.trim(),\n            city: city || stateOrProvinceCode,\n            stateOrProvince: stateOrProvinceCode,\n            stateOrProvinceCode,\n            countryCode,\n            postalCode,\n            phone: phoneNumber || phone,\n            customFields: customFields || [],\n        };\n    }\n\n    private _getFirstAndLastName(fullName: string): [string, string] {\n        const nameParts = fullName.split(' ');\n\n        if (nameParts.length === 1) {\n            return [fullName, ''];\n        }\n\n        const firstName = nameParts.slice(0, -1).join(' ');\n        const lastName = nameParts[nameParts.length - 1];\n\n        return [firstName, lastName];\n    }\n\n    private _getCurrencyCodeOrThrow(): string {\n        return guard(\n            this._currencyCode,\n            () =>\n                new InvalidArgumentError(\n                    'Unable to initialize payment because \"options.currencyCode\" argument is not provided.',\n                ),\n        );\n    }\n\n    private _getGooglePayShippingOption({\n        id,\n        cost,\n        description,\n        additionalDescription,\n    }: ShippingOption) {\n        const formattedCost = this._currencyService?.toCustomerCurrency(cost);\n        const state = this._paymentIntegrationService.getState();\n        const isNewShippingOptionsExperimentOn =\n            state.getStoreConfigOrThrow().checkoutSettings.features[\n                'PI-3540.googlepay_new_shipping_options_description'\n            ];\n\n        if (isNewShippingOptionsExperimentOn) {\n            return {\n                id,\n                label: `${formattedCost || cost} ${description}`,\n                description: additionalDescription,\n            };\n        }\n\n        return {\n            id,\n            label: description,\n            description: formattedCost || cost,\n        };\n    }\n}\n","import { StoreConfig } from '../config';\n\nimport CurrencyService from './currency-service';\n\n/**\n * Creates an instance of `CurrencyService`.\n *\n * @remarks\n * ```js\n * const { data } = checkoutService.getState();\n * const config = data.getConfig();\n * const checkout = data.getCheckout();\n * const currencyService = createCurrencyService(config);\n *\n * currencyService.toStoreCurrency(checkout.grandTotal);\n * currencyService.toCustomerCurrency(checkout.grandTotal);\n * ```\n *\n * param config - The config object containing the currency configuration\n * returns an instance of `CurrencyService`.\n */\nexport default function createCurrencyService(config: StoreConfig): CurrencyService {\n    return new CurrencyService(config);\n}\n","import { Cart } from '../cart';\nimport { StoreConfig } from '../config';\n\nconst itemsRequireShipping = (cart?: Cart, config?: StoreConfig) => {\n    if (!cart) {\n        return false;\n    }\n\n    if (cart.lineItems.physicalItems.some((lineItem) => lineItem.isShippingRequired)) {\n        return true;\n    }\n\n    if (config && cart.lineItems.customItems) {\n        return cart.lineItems.customItems.length > 0;\n    }\n\n    return false;\n};\n\nexport default itemsRequireShipping;\n","import {\n    AdyenAction,\n    AdyenAdditionalAction,\n    AdyenAdditionalActionState,\n    AdyenClient,\n    AdyenError,\n    AdyenV2ScriptLoader,\n    isAdditionalActionRequiredErrorResponse,\n} from '@bigcommerce/checkout-sdk/adyen-utils';\nimport {\n    getBrowserInfo,\n    isRequestError,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    Payment,\n    PaymentIntegrationSelectors,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentMethodCancelledError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayInitializationData } from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayAdyenV2 extends GooglePayGateway {\n    private _adyenClient?: AdyenClient;\n    private _service: PaymentIntegrationService;\n\n    constructor(service: PaymentIntegrationService, private _scriptLoader: AdyenV2ScriptLoader) {\n        super('adyen', service);\n\n        this._service = service;\n    }\n\n    async initialize(\n        getPaymentMethod: () => PaymentMethod<GooglePayInitializationData>,\n        isBuyNowFlow?: boolean,\n        currencyCode?: string,\n    ): Promise<void> {\n        await super.initialize(getPaymentMethod, isBuyNowFlow, currencyCode);\n\n        const paymentMethod = super.getPaymentMethod();\n        const state = this._service.getState();\n        const storeConfig = state.getStoreConfig();\n\n        if (!storeConfig) {\n            throw new MissingDataError(MissingDataErrorType.MissingCheckoutConfig);\n        }\n\n        this._adyenClient = await this._scriptLoader.load({\n            environment: paymentMethod.config.testMode ? 'test' : 'live',\n            locale: storeConfig.storeProfile.storeLanguage,\n        });\n\n        return Promise.resolve();\n    }\n\n    async getNonce(methodId: string) {\n        const nonce = await super.getNonce(methodId);\n        const paymentMethod = super.getPaymentMethod();\n\n        return JSON.stringify({\n            type: paymentMethod.method,\n            googlePayToken: nonce,\n            browser_info: getBrowserInfo(),\n        });\n    }\n\n    async processAdditionalAction(error: unknown): Promise<PaymentIntegrationSelectors | void> {\n        if (!isRequestError(error) || !isAdditionalActionRequiredErrorResponse(error.body)) {\n            throw error;\n        }\n\n        const payment = await this._handleAction(error.body.provider_data);\n\n        try {\n            return await this._service.submitPayment(payment);\n        } catch (e) {\n            return this.processAdditionalAction(e);\n        }\n    }\n\n    private _handleAction(additionalAction: AdyenAdditionalAction): Promise<Payment> {\n        return new Promise((resolve, reject) => {\n            const adyenAction: AdyenAction = JSON.parse(additionalAction.action);\n\n            const additionalActionComponent = this._getAdyenClient().createFromAction(adyenAction, {\n                onAdditionalDetails: (additionalActionState: AdyenAdditionalActionState) => {\n                    const paymentPayload = {\n                        methodId: adyenAction.paymentMethodType,\n                        paymentData: {\n                            nonce: JSON.stringify(additionalActionState.data),\n                        },\n                    };\n\n                    resolve(paymentPayload);\n                },\n                size: '05',\n                onError: (error: AdyenError) => reject(error),\n            });\n\n            additionalActionComponent.mount('body');\n\n            reject(new PaymentMethodCancelledError());\n        });\n    }\n\n    private _getAdyenClient(): AdyenClient {\n        if (!this._adyenClient) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        return this._adyenClient;\n    }\n}\n","export const SDK_VERSION_HEADERS = { 'X-Checkout-SDK-Version': LIBRARY_VERSION };\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a payment method experiences some kind of\n * failure (i.e.: its client library returns a rejected promise). And there is\n * no other error type that is more specific than this one.\n */\nexport default class PaymentMethodFailedError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method has thrown an unexpected error.',\n        );\n\n        this.name = 'PaymentMethodFailedError';\n        this.type = 'payment_method_client_invalid';\n    }\n}\n","import { FormPoster } from '@bigcommerce/form-poster';\nimport { RequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    AddressRequestBody,\n    BillingAddressRequestBody,\n    guard,\n    NotInitializedError,\n    NotInitializedErrorType,\n    Omit,\n    PaymentMethod,\n    PaymentMethodFailedError,\n    SDK_VERSION_HEADERS,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayGateway from './gateways/google-pay-gateway';\nimport GooglePayScriptLoader from './google-pay-script-loader';\nimport isGooglePayAdditionalActionProcessable from './guards/is-google-pay-additional-action-processable';\nimport {\n    GooglePayBaseCardPaymentMethod,\n    GooglePayButtonOptions,\n    GooglePayCardDataResponse,\n    GooglePayCardPaymentMethod,\n    GooglePayFullBillingAddress,\n    GooglePayGatewayBaseRequest,\n    GooglePayInitializationData,\n    GooglePayIsReadyToPayRequest,\n    GooglePaymentsClient,\n    GooglePayPaymentDataRequest,\n    GooglePayPaymentOptions,\n    HandleCouponsOut,\n    IntermediatePaymentData,\n    ShippingOptionParameters,\n} from './types';\n\nexport default class GooglePayPaymentProcessor {\n    private _paymentsClient?: GooglePaymentsClient;\n    private _baseRequest: GooglePayGatewayBaseRequest = { apiVersion: 2, apiVersionMinor: 0 };\n    private _baseCardPaymentMethod?: GooglePayBaseCardPaymentMethod;\n    private _cardPaymentMethod?: GooglePayCardPaymentMethod;\n    private _paymentDataRequest?: GooglePayPaymentDataRequest;\n    private _isReadyToPayRequest?: GooglePayIsReadyToPayRequest;\n\n    constructor(\n        private _scriptLoader: GooglePayScriptLoader,\n        private _gateway: GooglePayGateway,\n        private _requestSender: RequestSender,\n        private _formPoster: FormPoster,\n    ) {}\n\n    async initialize(\n        getPaymentMethod: () => PaymentMethod<GooglePayInitializationData>,\n        googlePayPaymentOptions?: GooglePayPaymentOptions,\n        isBuyNowFlow?: boolean,\n        currencyCode?: string,\n    ): Promise<void> {\n        this._paymentsClient = await this._scriptLoader.getGooglePaymentsClient(\n            getPaymentMethod().config.testMode,\n            googlePayPaymentOptions,\n        );\n\n        await this._gateway.initialize(getPaymentMethod, isBuyNowFlow, currencyCode);\n\n        this._buildButtonPayloads();\n    }\n\n    async initializeWidget() {\n        await this._buildWidgetPayloads();\n\n        await this._determineReadinessToPay();\n\n        this._prefetchGooglePaymentData();\n    }\n\n    getNonce(methodId: string) {\n        return this._gateway.getNonce(methodId);\n    }\n\n    async extraPaymentData() {\n        return this._gateway.extraPaymentData();\n    }\n\n    addPaymentButton(\n        containerId: string,\n        options: Omit<GooglePayButtonOptions, 'allowedPaymentMethods'>,\n    ): HTMLElement | undefined {\n        const container = document.querySelector<HTMLElement>(`#${containerId}`);\n\n        if (!container) {\n            return;\n        }\n\n        const paymentButton = this._getPaymentsClient().createButton({\n            ...options,\n            allowedPaymentMethods: [this._getBaseCardPaymentMethod()],\n        });\n\n        return container.appendChild(paymentButton);\n    }\n\n    async showPaymentSheet(): Promise<GooglePayCardDataResponse> {\n        const paymentDataRequest = this._getPaymentDataRequest();\n\n        return this._getPaymentsClient().loadPaymentData(paymentDataRequest);\n    }\n\n    async setExternalCheckoutXhr(\n        provider: string,\n        response: GooglePayCardDataResponse,\n    ): Promise<void> {\n        return this._setExternalCheckout(provider, response);\n    }\n\n    async setExternalCheckoutForm(\n        provider: string,\n        response: GooglePayCardDataResponse,\n        siteLink?: string,\n    ): Promise<void> {\n        return this._setExternalCheckout(provider, response, true, siteLink);\n    }\n\n    mapToBillingAddressRequestBody(\n        response: GooglePayCardDataResponse,\n    ): BillingAddressRequestBody | undefined {\n        return this._gateway.mapToBillingAddressRequestBody(response);\n    }\n\n    mapToShippingAddressRequestBody(\n        response: GooglePayCardDataResponse,\n    ): AddressRequestBody | undefined {\n        return this._gateway.mapToShippingAddressRequestBody(response);\n    }\n\n    processAdditionalAction(error: unknown, methodId?: string): Promise<void> {\n        return isGooglePayAdditionalActionProcessable(this._gateway)\n            ? this._gateway.processAdditionalAction(error, methodId)\n            : Promise.reject(error);\n    }\n\n    async signOut(providerId: string): Promise<void> {\n        await this._requestSender.get(`/remote-checkout/${providerId}/signout`);\n    }\n\n    getCallbackTriggers() {\n        return this._gateway.getCallbackTriggers();\n    }\n\n    setShouldRequestShipping(isRequired: boolean): void {\n        return this._gateway.setShouldRequestShipping(isRequired);\n    }\n\n    async handleShippingAddressChange(\n        shippingAddress: GooglePayFullBillingAddress,\n    ): Promise<ShippingOptionParameters | undefined> {\n        return this._gateway.handleShippingAddressChange(shippingAddress);\n    }\n\n    async handleShippingOptionChange(optionId: string): Promise<void> {\n        await this._gateway.handleShippingOptionChange(optionId);\n    }\n\n    async handleCoupons(\n        offerData: IntermediatePaymentData['offerData'],\n    ): Promise<HandleCouponsOut> {\n        return this._gateway.handleCoupons(offerData);\n    }\n\n    getTotalPrice(): string {\n        return this._gateway.getTotalPrice();\n    }\n\n    async _setExternalCheckout(\n        provider: string,\n        response: GooglePayCardDataResponse,\n        useFormPoster = false,\n        siteLink?: string,\n    ): Promise<void> {\n        const url = '/checkout.php';\n        const body = {\n            action: 'set_external_checkout',\n            provider,\n            ...(await this._gateway.mapToExternalCheckoutData(response)),\n        };\n\n        if (useFormPoster) {\n            return new Promise((resolve) => {\n                this._formPoster.postForm(\n                    siteLink ? `${siteLink}/checkout` : url,\n                    {\n                        ...body,\n                        card_information: JSON.stringify(body.card_information),\n                    },\n                    resolve,\n                );\n            });\n        }\n\n        await this._requestSender.post(url, {\n            headers: {\n                Accept: 'text/html',\n                'Content-Type': 'application/x-www-form-urlencoded',\n                ...SDK_VERSION_HEADERS,\n            },\n            body,\n        });\n    }\n\n    private _prefetchGooglePaymentData(): void {\n        const paymentDataRequest = this._getPaymentDataRequest();\n\n        paymentDataRequest.transactionInfo = this._gateway.getTransactionInfo();\n\n        this._getPaymentsClient().prefetchPaymentData(paymentDataRequest);\n    }\n\n    private async _determineReadinessToPay(): Promise<void> {\n        try {\n            const { result } = await this._getPaymentsClient().isReadyToPay(\n                this._getIsReadyToPayRequest(),\n            );\n\n            if (result === false) {\n                throw new PaymentMethodFailedError(\n                    'Google Pay is not supported by the current device and browser, please try another payment method.',\n                );\n            }\n        } catch (error) {\n            if (error instanceof PaymentMethodFailedError) {\n                throw error;\n            }\n\n            throw new PaymentMethodFailedError();\n        }\n    }\n\n    private _buildButtonPayloads() {\n        this._baseCardPaymentMethod = {\n            type: 'CARD',\n            parameters: this._gateway.getCardParameters(),\n        };\n    }\n\n    private async _buildWidgetPayloads(): Promise<void> {\n        const baseCardPaymentMethod = this._getBaseCardPaymentMethod();\n\n        this._cardPaymentMethod = {\n            ...baseCardPaymentMethod,\n            tokenizationSpecification: {\n                type: 'PAYMENT_GATEWAY',\n                parameters: await this._gateway.getPaymentGatewayParameters(),\n            },\n        };\n        this._paymentDataRequest = {\n            ...this._baseRequest,\n            allowedPaymentMethods: [this._cardPaymentMethod],\n            transactionInfo: this._gateway.getTransactionInfo(),\n            merchantInfo: this._gateway.getMerchantInfo(),\n            ...(await this._gateway.getRequiredData()),\n            callbackIntents: this._gateway.getCallbackIntents(),\n            offerInfo: this._gateway.getAppliedCoupons(),\n        };\n        this._isReadyToPayRequest = {\n            ...this._baseRequest,\n            allowedPaymentMethods: [baseCardPaymentMethod],\n        };\n    }\n\n    private _getBaseCardPaymentMethod(): GooglePayBaseCardPaymentMethod {\n        return this._getOrThrow(this._baseCardPaymentMethod);\n    }\n\n    private _getPaymentDataRequest(): GooglePayPaymentDataRequest {\n        return this._getOrThrow(this._paymentDataRequest);\n    }\n\n    private _getIsReadyToPayRequest(): GooglePayIsReadyToPayRequest {\n        return this._getOrThrow(this._isReadyToPayRequest);\n    }\n\n    private _getPaymentsClient(): GooglePaymentsClient {\n        return this._getOrThrow(this._paymentsClient);\n    }\n\n    private _getOrThrow<T>(value?: T): T {\n        return guard(\n            value,\n            () => new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n        );\n    }\n}\n","import GooglePayGateway from '../gateways/google-pay-gateway';\nimport { GooglePayAdditionalActionProcessable } from '../types';\n\nexport default function isGooglePayAdditionalActionProcessable(\n    gateway: GooglePayGateway,\n): gateway is GooglePayGateway & GooglePayAdditionalActionProcessable {\n    return 'processAdditionalAction' in gateway;\n}\n","import InvalidArgumentError from './invalid-argument-error';\n\n/**\n * This error should be thrown when we are unable to submit a payment because\n * the caller has not provided all the required fields, i.e.: if an argument is\n * missing or it is not the expected data type.\n */\nexport default class PaymentArgumentInvalidError extends InvalidArgumentError {\n    constructor(invalidFields?: string[]) {\n        let message = 'Unable to submit payment for the order because the payload is invalid.';\n\n        if (invalidFields) {\n            message = `${message} Make sure the following fields are provided correctly: ${invalidFields.join(\n                ', ',\n            )}.`;\n        }\n\n        super(message);\n\n        this.name = 'PaymentArgumentInvalidError';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we are trying to make an order finalization request for a\n * payment method that does not require such procedure.\n */\nexport default class OrderFinalizationNotRequiredError extends StandardError {\n    constructor() {\n        super('The current order does not need to be finalized at this stage.');\n\n        this.name = 'OrderFinalizationNotRequiredError';\n        this.type = 'order_finalization_not_required';\n    }\n}\n","import {\n    LoadingIndicatorContainerStyles,\n    LoadingIndicatorStyles,\n} from './loading-indicator-styles';\n\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\n    size: 70,\n    color: '#d9d9d9',\n    backgroundColor: '#ffffff',\n};\n\nexport const DEFAULT_CONTAINER_STYLES = {\n    position: 'fixed',\n    'background-color': 'rgba(0, 0, 0, 0.4)',\n    'z-index': '1000',\n};\n\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\n\ninterface LoadingIndicatorOptions {\n    styles?: LoadingIndicatorStyles;\n    containerStyles?: LoadingIndicatorContainerStyles;\n}\n\nexport default class LoadingIndicator {\n    private container: HTMLElement;\n    private indicator: HTMLElement;\n    private styles: LoadingIndicatorStyles;\n    private containerStyles: LoadingIndicatorContainerStyles;\n\n    constructor(options?: LoadingIndicatorOptions) {\n        this.styles = { ...DEFAULT_STYLES, ...(options && options.styles) };\n        this.containerStyles = { ...(options && options.containerStyles) };\n\n        this.defineAnimation();\n\n        this.container = this.buildContainer();\n        this.indicator = this.buildIndicator();\n\n        this.container.appendChild(this.indicator);\n    }\n\n    show(parentId?: string): void {\n        if (parentId) {\n            const parent = document.getElementById(parentId);\n\n            if (!parent) {\n                throw new Error(\n                    'Unable to attach the loading indicator because the parent ID is not valid.',\n                );\n            }\n\n            parent.appendChild(this.container);\n        }\n\n        this.container.style.visibility = 'visible';\n        this.container.style.opacity = '1';\n    }\n\n    hide(): void {\n        const handleTransitionEnd = () => {\n            this.container.style.visibility = 'hidden';\n\n            this.container.removeEventListener('transitionend', handleTransitionEnd);\n        };\n\n        this.container.addEventListener('transitionend', handleTransitionEnd);\n\n        this.container.style.opacity = '0';\n    }\n\n    private buildContainer(): HTMLElement {\n        const container = document.createElement('div');\n\n        container.style.display = 'block';\n        container.style.bottom = '0';\n        container.style.left = '0';\n        container.style.height = '100%';\n        container.style.width = '100%';\n        container.style.position = 'absolute';\n        container.style.right = '0';\n        container.style.top = '0';\n        container.style.transition = 'all 250ms ease-out';\n        container.style.opacity = '0';\n\n        this.setStyleAttribute(container, this.containerStyles);\n\n        return container;\n    }\n\n    private buildIndicator(): HTMLElement {\n        const indicator = document.createElement('div');\n\n        indicator.style.display = 'block';\n        indicator.style.width = `${this.styles.size}px`;\n        indicator.style.height = `${this.styles.size}px`;\n        indicator.style.borderRadius = `${this.styles.size}px`;\n        indicator.style.border = 'solid 1px';\n        indicator.style.borderColor = `${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`;\n        indicator.style.margin = '0 auto';\n        indicator.style.position = 'absolute';\n        indicator.style.left = '0';\n        indicator.style.right = '0';\n        indicator.style.top = '50%';\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\n        indicator.style.transformStyle = 'preserve-3d';\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\n\n        return indicator;\n    }\n\n    private setStyleAttribute(element: HTMLElement, attrs: { [key: string]: string }): void {\n        Object.keys(attrs).forEach((k) => {\n            element.style.setProperty(k, attrs[k]);\n        });\n    }\n\n    private defineAnimation(): void {\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\n        // We only have to do it once.\n        if (document.getElementById(ROTATION_ANIMATION)) {\n            return;\n        }\n\n        const style = document.createElement('style');\n\n        style.id = ROTATION_ANIMATION;\n\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        document.head?.appendChild(style);\n\n        if (style.sheet instanceof CSSStyleSheet) {\n            // We need to provide the 2nd parameter for IE11, even though it is\n            // 0 by default for all other browsers.\n            style.sheet.insertRule(\n                `\n                @keyframes ${ROTATION_ANIMATION} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `,\n                0,\n            );\n        }\n    }\n}\n","import { GooglePayErrorObject } from '../types';\n\nexport default function isGooglePayErrorObject(error: unknown): error is GooglePayErrorObject {\n    return typeof error === 'object' && error !== null && 'statusCode' in error;\n}\n","/**\n * A set of options that are required to initialize the GooglePay payment method\n *\n * If the customer chooses to pay with GooglePay, they will be asked to\n * enter their payment details via a modal. You can hook into events emitted by\n * the modal by providing the callbacks listed below.\n *\n * ```html\n * <!-- This is where the GooglePay button will be inserted -->\n * <div id=\"wallet-button\"></div>\n * ```\n *\n * ```js\n * service.initializePayment({\n *     // Using GooglePay provided by Braintree as an example\n *     methodId: 'googlepaybraintree',\n *     googlepaybraintree: {\n *         walletButton: 'wallet-button'\n *     },\n * });\n * ```\n *\n * Additional event callbacks can be registered.\n *\n * ```js\n * service.initializePayment({\n *     methodId: 'googlepaybraintree',\n *     googlepaybraintree: {\n *         walletButton: 'wallet-button',\n *         onError(error) {\n *             console.log(error);\n *         },\n *         onPaymentSelect() {\n *             console.log('Selected');\n *         },\n *     },\n * });\n * ```\n */\nexport default interface GooglePayPaymentInitializeOptions {\n    /**\n     * A container for loading spinner.\n     */\n    loadingContainerId?: string;\n\n    /**\n     * This walletButton is used to set an event listener, provide an element ID if you want\n     * users to be able to launch the GooglePay wallet modal by clicking on a button.\n     * It should be an HTML element.\n     */\n    walletButton?: string;\n\n    /**\n     * A callback that gets called when GooglePay fails to initialize or\n     * selects a payment option.\n     *\n     * @param error - The error object describing the failure.\n     */\n    onError?(error: Error): void;\n\n    /**\n     * A callback that gets called when the customer selects a payment option.\n     */\n    onPaymentSelect?(): void;\n}\n\n/**\n * The recognized keys to pass the initialization options for Google Pay.\n */\nexport enum GooglePayKey {\n    ADYEN_V2 = 'googlepayadyenv2',\n    ADYEN_V3 = 'googlepayadyenv3',\n    AUTHORIZE_NET = 'googlepayauthorizenet',\n    BNZ = 'googlepaybnz',\n    BRAINTREE = 'googlepaybraintree',\n    PAYPAL_COMMERCE = 'googlepaypaypalcommerce',\n    BIGCOMMERCE_PAYMENTS = 'googlepay_bigcommerce_payments',\n    CHECKOUT_COM = 'googlepaycheckoutcom',\n    CYBERSOURCE_V2 = 'googlepaycybersourcev2',\n    ORBITAL = 'googlepayorbital',\n    STRIPE = 'googlepaystripe',\n    STRIPE_UPE = 'googlepaystripeupe',\n    STRIPE_OCS = 'googlepaystripeocs',\n    WORLDPAY_ACCESS = 'googlepayworldpayaccess',\n    TD_ONLINE_MART = 'googlepaytdonlinemart',\n}\n\n/**\n * The options that are required to initialize the GooglePay payment method.\n * They can be omitted unless you need to support GooglePay.\n */\nexport type WithGooglePayPaymentInitializeOptions = {\n    [k in GooglePayKey]?: GooglePayPaymentInitializeOptions;\n};\n","import { GooglePayKey } from '../google-pay-payment-initialize-options';\n\nexport default function isGooglePayKey(key: string): key is GooglePayKey {\n    return Object.values<string>(GooglePayKey).includes(key);\n}\n","import { round } from 'lodash';\n\nimport {\n    guard,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    Omit,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodCancelledError,\n    PaymentMethodFailedError,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { DEFAULT_CONTAINER_STYLES, LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport GooglePayPaymentInitializeOptions, {\n    WithGooglePayPaymentInitializeOptions,\n} from './google-pay-payment-initialize-options';\nimport GooglePayPaymentProcessor from './google-pay-payment-processor';\nimport isGooglePayErrorObject from './guards/is-google-pay-error-object';\nimport isGooglePayKey from './guards/is-google-pay-key';\nimport {\n    CallbackTriggerType,\n    ErrorReasonType,\n    GooglePayError,\n    GooglePayInitializationData,\n    GooglePayPaymentOptions,\n    HandleCouponsOut,\n    IntermediatePaymentData,\n    TotalPriceStatusType,\n} from './types';\n\nexport default class GooglePayPaymentStrategy implements PaymentStrategy {\n    private _loadingIndicator: LoadingIndicator;\n    private _loadingIndicatorContainer?: string;\n    private _paymentButton?: HTMLElement;\n    private _clickListener?: (event: MouseEvent) => unknown;\n    private _methodId?: keyof WithGooglePayPaymentInitializeOptions;\n    private _isDeinitializationBlocked = false;\n\n    constructor(\n        protected _paymentIntegrationService: PaymentIntegrationService,\n        protected _googlePayPaymentProcessor: GooglePayPaymentProcessor,\n    ) {\n        this._loadingIndicator = new LoadingIndicator({\n            containerStyles: DEFAULT_CONTAINER_STYLES,\n        });\n    }\n\n    async initialize(\n        options?: PaymentInitializeOptions & WithGooglePayPaymentInitializeOptions,\n    ): Promise<void> {\n        if (!options?.methodId || !isGooglePayKey(options.methodId)) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"methodId\" is not a valid key.',\n            );\n        }\n\n        this._methodId = options.methodId;\n\n        const googlePayOptions = options[this._getMethodId()];\n\n        if (!googlePayOptions?.walletButton) {\n            throw new InvalidArgumentError('Unable to proceed without valid options.');\n        }\n\n        const { walletButton, loadingContainerId, ...callbacks } = googlePayOptions;\n\n        this._loadingIndicatorContainer = loadingContainerId;\n\n        await this._paymentIntegrationService.loadPaymentMethod(this._getMethodId());\n\n        const paymentMethod = this._paymentIntegrationService\n            .getState()\n            .getPaymentMethodOrThrow<GooglePayInitializationData>(this._getMethodId());\n\n        await this._googlePayPaymentProcessor.initialize(\n            () => paymentMethod,\n            this._getGooglePayClientOptions(paymentMethod.initializationData?.storeCountry),\n        );\n\n        this._addPaymentButton(walletButton, callbacks);\n    }\n\n    async execute({ payment }: OrderRequestBody): Promise<void> {\n        if (!payment?.methodId) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        await this._paymentIntegrationService.submitOrder();\n\n        const nonce = await this._googlePayPaymentProcessor.getNonce(payment.methodId);\n        const extraData = await this._googlePayPaymentProcessor.extraPaymentData();\n\n        try {\n            await this._paymentIntegrationService.submitPayment({\n                ...payment,\n                paymentData: { nonce, ...extraData },\n            });\n        } catch (error) {\n            await this._googlePayPaymentProcessor.processAdditionalAction(error, payment.methodId);\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        if (this._isDeinitializationBlocked) {\n            return Promise.resolve();\n        }\n\n        if (this._clickListener) {\n            this._paymentButton?.removeEventListener('click', this._clickListener);\n        }\n\n        this._paymentButton = undefined;\n        this._clickListener = undefined;\n        this._methodId = undefined;\n\n        return Promise.resolve();\n    }\n\n    protected _addPaymentButton(\n        walletButton: string,\n        callbacks: Omit<GooglePayPaymentInitializeOptions, 'walletButton'>,\n    ): void {\n        if (this._paymentButton) {\n            return;\n        }\n\n        const paymentButton = document.getElementById(walletButton);\n\n        if (!paymentButton) {\n            throw new InvalidArgumentError('Unable to proceed without a walletButton.');\n        }\n\n        this._paymentButton = paymentButton;\n        this._clickListener = this._handleClick(callbacks);\n\n        this._paymentButton.addEventListener('click', this._clickListener);\n    }\n\n    protected _handleClick({\n        onPaymentSelect,\n        onError,\n    }: Omit<GooglePayPaymentInitializeOptions, 'walletButton'>): (event: MouseEvent) => unknown {\n        return async (event: MouseEvent) => {\n            event.preventDefault();\n\n            // TODO: Dispatch Widget Actions\n            try {\n                this._googlePayPaymentProcessor.setShouldRequestShipping(false);\n                await this._googlePayPaymentProcessor.initializeWidget();\n                await this._interactWithPaymentSheet();\n            } catch (error) {\n                let err: unknown = error;\n\n                this._toggleLoadingIndicator(false);\n\n                if (isGooglePayErrorObject(error)) {\n                    if (error.statusCode === 'CANCELED') {\n                        throw new PaymentMethodCancelledError();\n                    }\n\n                    err = new PaymentMethodFailedError(JSON.stringify(error));\n                }\n\n                onError?.(\n                    new PaymentMethodFailedError(\n                        'An error occurred while requesting your Google Pay payment details.',\n                    ),\n                );\n\n                throw err;\n            } finally {\n                this._toggleBlockDeinitialization(false);\n            }\n\n            onPaymentSelect?.();\n        };\n    }\n\n    protected async _interactWithPaymentSheet(): Promise<void> {\n        const response = await this._googlePayPaymentProcessor.showPaymentSheet();\n\n        this._toggleBlockDeinitialization(true);\n        this._toggleLoadingIndicator(true);\n\n        const billingAddress =\n            this._googlePayPaymentProcessor.mapToBillingAddressRequestBody(response);\n\n        if (billingAddress) {\n            await this._paymentIntegrationService.updateBillingAddress(billingAddress);\n        }\n\n        await this._googlePayPaymentProcessor.setExternalCheckoutXhr(this._getMethodId(), response);\n\n        await this._paymentIntegrationService.loadCheckout();\n        await this._paymentIntegrationService.loadPaymentMethod(this._getMethodId());\n        this._toggleLoadingIndicator(false);\n        this._toggleBlockDeinitialization(false);\n    }\n\n    protected _getMethodId(): keyof WithGooglePayPaymentInitializeOptions {\n        return guard(\n            this._methodId,\n            () => new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n        );\n    }\n\n    protected async _getIsSignedInOrThrow(): Promise<boolean> {\n        try {\n            return !!(await this._googlePayPaymentProcessor.getNonce(this._getMethodId()));\n        } catch (e) {\n            if (\n                e instanceof MissingDataError &&\n                e.subtype === MissingDataErrorType.MissingPaymentToken\n            ) {\n                return false;\n            }\n\n            throw e;\n        }\n    }\n\n    protected async _handleOfferTrigger(\n        offerData: IntermediatePaymentData['offerData'],\n    ): Promise<Partial<HandleCouponsOut>> {\n        let isSignedIn = false;\n        let errorMessage = 'Sign in to Google Pay first to apply or remove promo codes.';\n\n        try {\n            isSignedIn = await this._getIsSignedInOrThrow();\n        } catch (error) {\n            if (error instanceof MissingDataError) {\n                errorMessage = error.message;\n            }\n        }\n\n        // We can only apply/remove coupons on the payment step only if we are logged into Google Pay, otherwise we will get an error\n        if (isSignedIn) {\n            const { newOfferInfo, error } = await this._googlePayPaymentProcessor.handleCoupons(\n                offerData,\n            );\n\n            return {\n                newOfferInfo,\n                error,\n            };\n        }\n\n        return {\n            error: {\n                reason: ErrorReasonType.OFFER_INVALID,\n                message: errorMessage,\n                intent: CallbackTriggerType.OFFER,\n            },\n        };\n    }\n\n    protected _getGooglePayClientOptions(countryCode?: string): GooglePayPaymentOptions {\n        return {\n            paymentDataCallbacks: {\n                onPaymentDataChanged: async ({ callbackTrigger, offerData }) => {\n                    if (\n                        callbackTrigger !== CallbackTriggerType.INITIALIZE &&\n                        callbackTrigger !== CallbackTriggerType.OFFER\n                    ) {\n                        return;\n                    }\n\n                    const { offerChangeTriggers } =\n                        this._googlePayPaymentProcessor.getCallbackTriggers();\n\n                    const { newOfferInfo = undefined, error: couponsError = undefined } =\n                        offerChangeTriggers.includes(callbackTrigger)\n                            ? await this._handleOfferTrigger(offerData)\n                            : {};\n\n                    // We can add another errors if needed 'couponsError || shippingError || anotherError'\n                    const error: GooglePayError | undefined = couponsError;\n\n                    await this._paymentIntegrationService.loadCheckout();\n\n                    const { getCheckoutOrThrow, getCartOrThrow } =\n                        this._paymentIntegrationService.getState();\n                    const { code: currencyCode, decimalPlaces } = getCartOrThrow().currency;\n                    const totalPrice = round(\n                        getCheckoutOrThrow().outstandingBalance,\n                        decimalPlaces,\n                    ).toFixed(decimalPlaces);\n\n                    return {\n                        newTransactionInfo: {\n                            ...(countryCode && { countryCode }),\n                            currencyCode,\n                            totalPriceStatus: TotalPriceStatusType.FINAL,\n                            totalPrice,\n                        },\n                        ...(newOfferInfo && {\n                            newOfferInfo,\n                        }),\n                        ...(error && {\n                            error,\n                        }),\n                    };\n                },\n            },\n        };\n    }\n\n    private _toggleBlockDeinitialization(isBlocked: boolean) {\n        this._isDeinitializationBlocked = isBlocked;\n    }\n\n    private _toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this._loadingIndicatorContainer) {\n            this._loadingIndicator.show(this._loadingIndicatorContainer);\n        } else {\n            this._loadingIndicator.hide();\n        }\n    }\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayHostWindow, GooglePaymentsClient, GooglePayPaymentOptions } from './types';\n\nexport const GOOGLE_PAY_LIBRARY = 'https://pay.google.com/gp/p/js/pay.js';\n\nexport default class GooglePayScriptLoader {\n    private _paymentsClient?: GooglePaymentsClient;\n    private _window: GooglePayHostWindow = window;\n\n    constructor(private _scriptLoader: ScriptLoader) {}\n\n    async getGooglePaymentsClient(\n        testMode = false,\n        options?: GooglePayPaymentOptions,\n    ): Promise<GooglePaymentsClient> {\n        await this._scriptLoader.loadScript(GOOGLE_PAY_LIBRARY);\n\n        if (!this._window.google) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        if (this._paymentsClient === undefined) {\n            this._paymentsClient = new this._window.google.payments.api.PaymentsClient({\n                environment: testMode ? 'TEST' : 'PRODUCTION',\n                ...(options ?? {}),\n            });\n        }\n\n        return this._paymentsClient;\n    }\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport GooglePayScriptLoader from '../google-pay-script-loader';\n\nexport default function createGooglePayScriptLoader() {\n    return new GooglePayScriptLoader(getScriptLoader());\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader, getStylesheetLoader } from '@bigcommerce/script-loader';\n\nimport { AdyenV2ScriptLoader } from '@bigcommerce/checkout-sdk/adyen-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayAdyenV2Gateway from '../../gateways/google-pay-adyenv2-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAdyenV2PaymentStrategy: PaymentStrategyFactory<GooglePayPaymentStrategy> = (\n    paymentIntegrationService,\n) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayAdyenV2Gateway(\n                paymentIntegrationService,\n                new AdyenV2ScriptLoader(getScriptLoader(), getStylesheetLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayAdyenV2PaymentStrategy, [\n    { id: 'googlepayadyenv2' },\n]);\n","import { ScriptLoader, StylesheetLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { AdyenClient, AdyenConfiguration, AdyenV3HostWindow } from '../types';\n\nexport default class AdyenV3ScriptLoader {\n    constructor(\n        private _scriptLoader: ScriptLoader,\n        private _stylesheetLoader: StylesheetLoader,\n        private _window: AdyenV3HostWindow = window,\n    ) {}\n\n    async load(configuration: AdyenConfiguration): Promise<AdyenClient> {\n        await Promise.all([\n            this._stylesheetLoader.loadStylesheet(\n                `https://checkoutshopper-${\n                    configuration.environment ?? ''\n                }.adyen.com/checkoutshopper/sdk/5.71.1/adyen.css`,\n                {\n                    prepend: false,\n                    attributes: {\n                        integrity:\n                            'sha384-5MvB4RnzvviA3VBT4KYABZ4HXNZG5LRqREEgd41xt/pf/QvKmsj2O9GuNuywRXx9',\n                        crossorigin: 'anonymous',\n                    },\n                },\n            ),\n            this._scriptLoader.loadScript(\n                `https://checkoutshopper-${\n                    configuration.environment ?? ''\n                }.adyen.com/checkoutshopper/sdk/5.71.1/adyen.js`,\n                {\n                    async: true,\n                    attributes: {\n                        integrity:\n                            'sha384-yvY2yFNR4WqIjPqP9MzjI+gJimmaJnAvj4rLHKvgJbgFD5fMuf8zIJrFJOW8Lhhf',\n                        crossorigin: 'anonymous',\n                    },\n                },\n            ),\n        ]);\n\n        if (!this._window.AdyenCheckout) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        const checkout = await this._window.AdyenCheckout(configuration);\n\n        return checkout;\n    }\n}\n","import {\n    AdyenAction,\n    AdyenAdditionalAction,\n    AdyenAdditionalActionState,\n    AdyenClient,\n    AdyenError,\n    AdyenV3ScriptLoader,\n    isAdditionalActionRequiredErrorResponse,\n} from '@bigcommerce/checkout-sdk/adyen-utils';\nimport {\n    getBrowserInfo,\n    isRequestError,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    Payment,\n    PaymentIntegrationSelectors,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentMethodCancelledError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayInitializationData } from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayAdyenV3 extends GooglePayGateway {\n    private _adyenClient?: AdyenClient;\n    private _service: PaymentIntegrationService;\n\n    constructor(service: PaymentIntegrationService, private _scriptLoader: AdyenV3ScriptLoader) {\n        super('adyen', service);\n\n        this._service = service;\n    }\n\n    async initialize(\n        getPaymentMethod: () => PaymentMethod<GooglePayInitializationData>,\n        isBuyNowFlow?: boolean,\n        currencyCode?: string,\n    ): Promise<void> {\n        await super.initialize(getPaymentMethod, isBuyNowFlow, currencyCode);\n\n        const paymentMethod = super.getPaymentMethod();\n        const state = this._service.getState();\n        const storeConfig = state.getStoreConfig();\n\n        if (!storeConfig) {\n            throw new MissingDataError(MissingDataErrorType.MissingCheckoutConfig);\n        }\n\n        this._adyenClient = await this._scriptLoader.load({\n            environment: paymentMethod.config.testMode ? 'test' : 'live',\n            locale: storeConfig.storeProfile.storeLanguage,\n        });\n\n        return Promise.resolve();\n    }\n\n    async processAdditionalAction(error: unknown): Promise<PaymentIntegrationSelectors | void> {\n        if (!isRequestError(error) || !isAdditionalActionRequiredErrorResponse(error.body)) {\n            throw error;\n        }\n\n        const payment = await this._handleAction(error.body.provider_data);\n\n        try {\n            return await this._service.submitPayment(payment);\n        } catch (e) {\n            return this.processAdditionalAction(e);\n        }\n    }\n\n    async getNonce(methodId: string) {\n        const nonce = await super.getNonce(methodId);\n        const paymentMethod = super.getPaymentMethod();\n\n        return JSON.stringify({\n            type: paymentMethod.method,\n            googlePayToken: nonce,\n            browser_info: getBrowserInfo(),\n        });\n    }\n\n    private _handleAction(additionalAction: AdyenAdditionalAction): Promise<Payment> {\n        return new Promise((resolve, reject) => {\n            const adyenAction: AdyenAction = JSON.parse(additionalAction.action);\n\n            const additionalActionComponent = this._getAdyenClient().createFromAction(adyenAction, {\n                onAdditionalDetails: (additionalActionState: AdyenAdditionalActionState) => {\n                    const paymentPayload = {\n                        methodId: adyenAction.paymentMethodType,\n                        paymentData: {\n                            nonce: JSON.stringify(additionalActionState.data),\n                        },\n                    };\n\n                    resolve(paymentPayload);\n                },\n                size: '05',\n                onError: (error: AdyenError) => reject(error),\n            });\n\n            additionalActionComponent.mount('body');\n\n            reject(new PaymentMethodCancelledError());\n        });\n    }\n\n    private _getAdyenClient(): AdyenClient {\n        if (!this._adyenClient) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        return this._adyenClient;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader, getStylesheetLoader } from '@bigcommerce/script-loader';\n\nimport { AdyenV3ScriptLoader } from '@bigcommerce/checkout-sdk/adyen-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayAdyenV3Gateway from '../../gateways/google-pay-adyenv3-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAdyenV3PaymentStrategy: PaymentStrategyFactory<GooglePayPaymentStrategy> = (\n    paymentIntegrationService,\n) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayAdyenV3Gateway(\n                paymentIntegrationService,\n                new AdyenV3ScriptLoader(getScriptLoader(), getStylesheetLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayAdyenV3PaymentStrategy, [\n    { id: 'googlepayadyenv3' },\n]);\n","import { PaymentIntegrationService } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport assertsIsGooglePayAuthorizeNetInitializationData from '../guards/is-google-pay-authorizenet-initialization-data';\nimport {\n    GooglePayCardDataResponse,\n    GooglePayGatewayParameters,\n    GooglePaySetExternalCheckoutData,\n} from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayAuthorizeNetGateway extends GooglePayGateway {\n    constructor(service: PaymentIntegrationService) {\n        super('authorizenet', service);\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        data.nonce = btoa(data.nonce);\n\n        return data;\n    }\n\n    getPaymentGatewayParameters(): GooglePayGatewayParameters {\n        const data = this.getGooglePayInitializationData();\n\n        assertsIsGooglePayAuthorizeNetInitializationData(data);\n\n        return {\n            gateway: this.getGatewayIdentifier(),\n            gatewayMerchantId: data.paymentGatewayId,\n        };\n    }\n}\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayAuthorizeNetInitializationData, GooglePayInitializationData } from '../types';\n\nfunction isGooglePayAuthorizeNetInitializationData(\n    data: GooglePayInitializationData,\n): data is GooglePayAuthorizeNetInitializationData {\n    return 'paymentGatewayId' in data;\n}\n\nexport default function assertsIsGooglePayAuthorizeNetInitializationData(\n    data: GooglePayInitializationData,\n): asserts data is GooglePayAuthorizeNetInitializationData {\n    if (!isGooglePayAuthorizeNetInitializationData(data)) {\n        throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayAuthorizeNetGateway from '../../gateways/google-pay-authorizenet-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAuthorizeNetPaymentStrategy: PaymentStrategyFactory<\n    GooglePayPaymentStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayAuthorizeNetGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayAuthorizeNetPaymentStrategy, [\n    { id: 'googlepayauthorizenet' },\n]);\n","enum ContentType {\n    Json = 'application/json',\n    JsonV1 = 'application/vnd.bc.v1+json',\n}\n\nexport default ContentType;\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayCheckoutComInitializationData, GooglePayInitializationData } from '../types';\n\nfunction isGooglePayCheckoutComInitializationData(\n    data: GooglePayInitializationData,\n): data is GooglePayCheckoutComInitializationData {\n    return 'checkoutcomkey' in data;\n}\n\nexport default function assertIsGooglePayCheckoutComInitializationData(\n    data: GooglePayInitializationData,\n): asserts data is GooglePayCheckoutComInitializationData {\n    if (!isGooglePayCheckoutComInitializationData(data)) {\n        throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n    }\n}\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    ContentType,\n    InvalidArgumentError,\n    isRequestError,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport assertIsGooglePayCheckoutComInitializationData from '../guards/is-google-pay-checkoutcom-initialization-data';\nimport { isGooglePayThreeDSecureResult } from '../guards/is-google-pay-threedsecure-result';\nimport assertIsGooglePayTokenObject from '../guards/is-google-pay-token-object';\nimport {\n    GooglePayAdditionalActionProcessable,\n    GooglePayCardDataResponse,\n    GooglePayCheckoutComTokenObject,\n    GooglePayGatewayParameters,\n    GooglePaySetExternalCheckoutData,\n    GooglePayTokenObject,\n} from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayCheckoutComGateway\n    extends GooglePayGateway\n    implements GooglePayAdditionalActionProcessable\n{\n    constructor(service: PaymentIntegrationService, private _requestSender: RequestSender) {\n        super('checkoutltd', service);\n    }\n\n    processAdditionalAction(error: unknown): Promise<void> {\n        return new Promise((_resolve, reject) => {\n            if (\n                isRequestError(error) &&\n                isGooglePayThreeDSecureResult(error.body) &&\n                error.body.three_ds_result.code === 'three_d_secure_required'\n            ) {\n                return window.location.assign(error.body.three_ds_result.acs_url);\n            }\n\n            reject(error);\n        });\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        let token: unknown;\n\n        try {\n            token = JSON.parse(data.nonce);\n        } catch (error) {\n            throw new InvalidArgumentError('Unable to parse response from Google Pay.');\n        }\n\n        assertIsGooglePayTokenObject(token);\n\n        data.nonce = await this._tokenize(token);\n\n        return data;\n    }\n\n    getPaymentGatewayParameters(): GooglePayGatewayParameters {\n        const data = this.getGooglePayInitializationData();\n\n        assertIsGooglePayCheckoutComInitializationData(data);\n\n        return {\n            gateway: this.getGatewayIdentifier(),\n            gatewayMerchantId: data.checkoutcomkey,\n        };\n    }\n\n    private async _tokenize(token_data: GooglePayTokenObject): Promise<string> {\n        const url = this.getPaymentMethod().config.testMode\n            ? 'https://api.sandbox.checkout.com/tokens'\n            : 'https://api.checkout.com/tokens';\n        const data = this.getGooglePayInitializationData();\n\n        assertIsGooglePayCheckoutComInitializationData(data);\n\n        const { body } = await this._requestSender.post<GooglePayCheckoutComTokenObject>(url, {\n            credentials: false,\n            body: {\n                type: 'googlepay',\n                token_data,\n            },\n            headers: {\n                Authorization: data.checkoutcomkey,\n                'Content-Type': ContentType.Json,\n                'X-XSRF-TOKEN': null,\n            },\n        });\n\n        return body.token;\n    }\n}\n","import { RequestError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayThreeDSecureResult } from '../types';\n\nexport function isGooglePayThreeDSecureResult(\n    body: RequestError['body'],\n): body is GooglePayThreeDSecureResult {\n    if (typeof body !== 'object' || body === null) {\n        return false;\n    }\n\n    const threeDSBody = body as Partial<GooglePayThreeDSecureResult>;\n\n    return (\n        typeof threeDSBody.three_ds_result?.acs_url === 'string' &&\n        typeof threeDSBody.three_ds_result.code === 'string'\n    );\n}\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayTokenObject } from '../types';\n\nfunction isGooglePayTokenObject(token: unknown): token is GooglePayTokenObject {\n    return (\n        typeof token === 'object' &&\n        token !== null &&\n        'protocolVersion' in token &&\n        'signature' in token &&\n        'signedMessage' in token\n    );\n}\n\nexport default function assertIsGooglePayTokenObject(\n    token: unknown,\n): asserts token is GooglePayTokenObject {\n    if (!isGooglePayTokenObject(token)) {\n        throw new MissingDataError(MissingDataErrorType.MissingPaymentToken);\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCheckoutComGateway from '../../gateways/google-pay-checkoutcom-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayCheckoutComPaymentStrategy: PaymentStrategyFactory<\n    GooglePayPaymentStrategy\n> = (paymentIntegrationService) => {\n    const requestSender = createRequestSender();\n\n    return new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayCheckoutComGateway(paymentIntegrationService, requestSender),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayCheckoutComPaymentStrategy, [\n    { id: 'googlepaycheckoutcom' },\n]);\n","import { PaymentIntegrationService } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayCardDataResponse, GooglePaySetExternalCheckoutData } from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayCybersourceGateway extends GooglePayGateway {\n    constructor(service: PaymentIntegrationService) {\n        super('cybersource', service);\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        data.nonce = btoa(data.nonce);\n\n        return data;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCybersourceGateway from '../../gateways/google-pay-cybersource-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayCybersourcePaymentStrategy: PaymentStrategyFactory<\n    GooglePayPaymentStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayCybersourceGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayCybersourcePaymentStrategy, [\n    { id: 'googlepaycybersourcev2' },\n    { id: 'googlepaybnz' },\n]);\n","import { PaymentIntegrationService } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayCardDataResponse, GooglePaySetExternalCheckoutData } from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayOrbitalGateway extends GooglePayGateway {\n    constructor(service: PaymentIntegrationService) {\n        super('chase', service);\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        data.nonce = btoa(data.nonce);\n\n        return data;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayOrbitalGateway from '../../gateways/google-pay-orbital-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayOrbitalPaymentStrategy: PaymentStrategyFactory<GooglePayPaymentStrategy> = (\n    paymentIntegrationService,\n) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayOrbitalGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayOrbitalPaymentStrategy, [\n    { id: 'googlepayorbital' },\n]);\n","import { PaymentMethod } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\n/**\n * Initialization options.\n */\nexport interface StripeConfigurationOptions {\n    /**\n     * For usage with [Connect](https://stripe.com/docs/connect) only.\n     * Specifying a connected account ID (e.g., acct_24BFMpJ1svR5A89k) allows you to perform actions on behalf of that account.\n     */\n    stripeAccount?: string;\n\n    /**\n     * Override your account's [API version](https://stripe.com/docs/api/versioning)\n     */\n    apiVersion?: string;\n\n    /**\n     * A locale used to globally configure localization in Stripe. Setting the locale here will localize error strings for all Stripe.js methods. It will also configure the locale for Elements and Checkout. Default is auto (Stripe detects the locale of the browser).\n     * Note that Checkout supports a slightly different set of locales than Stripe.js.\n     */\n    locale?: string;\n\n    betas?: string[];\n}\n\nexport interface StripeAdditionalActionData {\n    redirect_url?: string;\n    intent?: string;\n}\n\nexport interface StripeAdditionalAction {\n    type: string;\n    data: StripeAdditionalActionData;\n}\n\n/**\n * The PaymentIntent object.\n */\nexport interface PaymentIntent {\n    /**\n     * Unique identifier for the object.\n     */\n    id: string;\n\n    /**\n     * The client secret of the PaymentIntent. Used for client-side retrieval using a publishable key.\n     */\n    client_secret?: string;\n\n    /**\n     * Status of this PaymentIntent. Read more about each PaymentIntent [status](https://stripe.com/docs/payments/intents#intent-statuses).\n     */\n    status: 'succeeded' | string;\n\n    /**\n     * The payment error encountered in the previous PaymentIntent confirmation. It will be cleared if the PaymentIntent is later updated for any reason.\n     */\n    last_payment_error: LastPaymentError | null;\n\n    payment_method_options?: StripePIPaymentMethodOptions;\n}\n\nexport interface StripePIPaymentMethodSavingOptions {\n    setup_future_usage?: StripeInstrumentSetupFutureUsage;\n    verification_method?: string;\n}\n\nexport interface StripePIPaymentMethodOptions {\n    card?: StripePIPaymentMethodSavingOptions;\n    us_bank_account?: StripePIPaymentMethodSavingOptions;\n}\n\n/**\n * The payment error encountered in the previous PaymentIntent confirmation. It will be cleared if the PaymentIntent is later updated for any reason.\n */\nexport interface LastPaymentError {\n    /**\n     * A human-readable message providing more details about the error. For card errors, these messages can be shown to your users.\n     */\n    message?: string;\n}\n\n/**\n * This object is used to pass custom fonts when creating an [Elements](https://stripe.com/docs/js/elements_object/create) object.\n */\nexport interface CssFontSource {\n    /**\n     * A relative or absolute URL pointing to a CSS file with [@font-face](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face) definitions, for example:\n     * `https://fonts.googleapis.com/css?family=Open+Sans`\n     * Note that if you are using a [content security policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy) (CSP),\n     * [additional directives](https://stripe.com/docs/security#content-security-policy) may be necessary.\n     */\n    cssSrc: string;\n}\n\n/**\n * This object is used to pass custom fonts when creating an [Elements](https://stripe.com/docs/js/elements_object/create) object.\n */\nexport interface CustomFontSource {\n    /**\n     * The name to give the font.\n     */\n    family: string;\n\n    /**\n     * A valid [src](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/src) value pointing to your\n     * custom font file. This is usually (though not always) a link to a file with a .woff , .otf, or .svg suffix.\n     */\n    src: string;\n\n    /**\n     * A valid [font-display](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display) value.\n     */\n    display?: string;\n\n    /**\n     * One of normal, italic, oblique. Defaults to normal.\n     */\n    style?: string;\n\n    /**\n     * A valid [unicode-range](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/unicode-range) value.\n     */\n    unicodeRange?: string;\n\n    /**\n     * A valid [font-weight](https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight). Note that this is a string, not a number.\n     */\n    weight?: string;\n}\n\nexport type StripeCustomFont = CssFontSource | CustomFontSource;\n\nexport interface StripeError {\n    /**\n     * type of error. When the error type is card_error or validation_error, you can display the error message in error.message directly to your user.\n     */\n    type: string;\n    /**\n     * A human-readable message providing more details about the error. For card errors, these messages can be shown to your users.\n     */\n    message?: string;\n\n    /**\n     * The PaymentIntent object.\n     */\n    payment_intent: PaymentIntent;\n}\n\nexport interface StripeElement {\n    /**\n     * The `element.mount` method attaches your element to the DOM.\n     */\n    mount(domElement: string | HTMLElement): void;\n\n    /**\n     * Removes the element from the DOM and destroys it.\n     * A destroyed element can not be re-activated or re-mounted to the DOM.\n     */\n    destroy(): void;\n\n    /**\n     * Unmounts the element from the DOM.\n     * Call `element.mount` to re-attach it to the DOM.\n     */\n    unmount(): void;\n\n    /**\n     * The change event is triggered when the Element's value changes. The event payload always contains certain keys,\n     * in addition to some Element-specific keys.\n     * https://stripe.com/docs/js/element/events/on_change?type=paymentElement\n     */\n    on(event: StripeElementEvent, handler: (event: StripeEventType) => void): void;\n\n    /**\n     * Updates the options the Payment Element was initialized with. Updates are merged into the existing configuration.\n     * https://docs.stripe.com/js/elements_object/update_payment_element\n     */\n    update(options?: StripeElementsCreateOptions): void;\n\n    /**\n     * This method collapses the Payment Element into a row of payment method tabs.\n     * https://docs.stripe.com/js/elements_object/collapse_payment_element\n     */\n    collapse(): void;\n}\n\nexport interface StripeEvent {\n    complete: boolean;\n    elementType: string;\n    empty: boolean;\n}\n\nexport interface StripeCustomerEvent extends StripeEvent {\n    collapsed?: boolean;\n    authenticated: boolean;\n    value: {\n        email: string;\n    };\n}\n\nexport interface StripeShippingEvent extends StripeEvent {\n    mode?: string;\n    isNewAddress?: boolean;\n    phoneFieldRequired: boolean;\n    value: {\n        address: Address;\n        name?: string;\n        firstName?: string;\n        lastName?: string;\n        phone?: string;\n    };\n    fields?: {\n        phone: string;\n    };\n    display?: {\n        name: string;\n    };\n}\n\nexport interface StripePaymentEvent extends StripeEvent {\n    value: {\n        type: StripePaymentMethodType;\n    };\n    collapsed?: boolean;\n}\n\nexport interface Address {\n    city: string;\n    country: string;\n    line1: string;\n    line2?: string;\n    postal_code: string;\n    state: string;\n}\n\nexport type StripeEventType =\n    | StripeShippingEvent\n    | StripeCustomerEvent\n    | StripePaymentEvent\n    | StripeLinkV2Event;\n\n/**\n * Object definition for part of the data sent to confirm the PaymentIntent.\n * https://stripe.com/docs/api/payment_intents/confirm#confirm_payment_intent-shipping\n */\nexport type AddressOptions = Partial<Address>;\n\nexport interface StripeAddressValues {\n    name?: string;\n    address?: AddressOptions & { country: string };\n}\n\n/**\n * Object definition for part of the data sent to confirm the PaymentIntent.\n * https://stripe.com/docs/js/elements_object/create_payment_element\n */\nexport interface AddressProperties {\n    city?: AutoOrNever;\n    country?: AutoOrNever;\n    state?: AutoOrNever;\n    postalCode?: AutoOrNever;\n    line1?: AutoOrNever;\n    line2?: AutoOrNever;\n}\n\n/**\n * Object definition for part of the data sent to confirm the PaymentIntent.\n */\nexport interface BillingDetailsOptions {\n    name?: string;\n    email?: string;\n    address?: AddressOptions;\n    phone?: string;\n}\n\n/**\n * Object definition for part of the data sent to confirm the PaymentIntent.\n */\nexport interface BillingDetailsProperties {\n    name?: AutoOrNever;\n    email?: AutoOrNever;\n    address?: AutoOrNever | AddressProperties;\n    phone?: AutoOrNever;\n}\n\n/**\n * Object definition for part of the data sent to confirm the PaymentIntent.\n */\nexport interface PaymentMethodDataOptions {\n    billing_details: BillingDetailsOptions;\n    allow_redisplay?: 'always' | 'limited' | 'unspecified';\n}\n\n/**\n * Parameters that will be passed on to the Stripe API to confirm the PaymentIntent.\n */\nexport interface StripeConfirmParams {\n    /*\n     * If you are [handling next actions yourself](https://stripe.com/docs/payments/payment-intents/verifying-status#next-actions), pass in a return_url. If the subsequent action\n     * is redirect_to_url, this URL will be used on the return path for the redirect.\n     *\n     * @recommended\n     */\n    return_url?: string;\n    payment_method_data?: PaymentMethodDataOptions;\n}\n\n/**\n * Data to be sent with a `stripe.confirmPayment` request.\n * Refer to the [Payment Intents API](https://stripe.com/docs/js/payment_intents/confirm_payment) for a full list of parameters.\n */\nexport interface StripeConfirmPaymentData {\n    /**\n     * The Elements instance that was used to create the Payment Element.\n     */\n    elements: StripeElements;\n\n    /**\n     * Parameters that will be passed on to the Stripe API to confirm the PaymentIntent.\n     */\n    confirmParams?: StripeConfirmParams;\n\n    /**\n     * By default, confirmPayment will always redirect to your return_url after a successful confirmation.\n     * If you set redirect: \"if_required\", then confirmPayment will only redirect if your user chooses a redirect-based payment method.\n     */\n    redirect?: StripeStringConstants.ALWAYS | StripeStringConstants.IF_REQUIRED;\n\n    clientSecret?: string;\n}\n\nexport interface FieldsOptions {\n    billingDetails?: AutoOrNever | BillingDetailsProperties;\n    phone?: string;\n}\n\nexport interface WalletOptions {\n    applePay?: AutoOrNever;\n    googlePay?: AutoOrNever;\n    link?: AutoOrNever;\n}\n\nexport interface TermOptions {\n    card?: AutoOrNever;\n}\n\nexport interface StripeLayoutOptions {\n    type?: 'accordion' | 'tabs';\n    linkInAccordion?: boolean;\n    defaultCollapsed?: boolean;\n    radios?: boolean;\n    spacedAccordionItems?: boolean;\n    visibleAccordionItemsCount?: number;\n}\n\n/**\n * All available options are here https://stripe.com/docs/js/elements_object/create_payment_element\n */\nexport interface StripeElementsCreateOptions {\n    mode?: string;\n    fields?: FieldsOptions;\n    wallets?: WalletOptions;\n    allowedCountries?: string[];\n    defaultValues?: ShippingDefaultValues | CustomerDefaultValues | PaymentDefaultValues;\n    validation?: validationElement;\n    display?: { name: StripeDisplayName };\n    terms?: TermOptions;\n    layout?: StripeLayoutOptions;\n    paymentMethodOrder?: string[];\n    //  Link v2 options\n    lineItems?: LineItem[];\n    allowedShippingCountries?: string[];\n    shippingAddressRequired?: boolean;\n    shippingRates?: StripeLinkV2ShippingRate[];\n    billingAddressRequired?: boolean;\n    emailRequired?: boolean;\n    phoneNumberRequired?: boolean;\n    paymentMethods?: {\n        link: StripeStringConstants.AUTO;\n        applePay: StripeStringConstants.NEVER;\n        googlePay: StripeStringConstants.NEVER;\n        amazonPay: StripeStringConstants.NEVER;\n        paypal: StripeStringConstants.NEVER;\n        klarna: StripeStringConstants.NEVER;\n    };\n    buttonHeight?: number;\n    savePaymentMethod?: StripeSavePaymentMethod;\n}\n\ninterface validationElement {\n    phone?: validationRequiredElement;\n}\n\ninterface validationRequiredElement {\n    required?: string;\n}\n\ninterface PaymentDefaultValues {\n    savePaymentMethod?: boolean;\n    billingDetails?: BillingDetailsOptions;\n}\n\ninterface ShippingDefaultValues {\n    name?: string;\n    firstName?: string;\n    lastName?: string;\n    phone: string;\n    address: Address;\n}\n\n/*\nDecide which mode you are going to use the Address Element\nShipping: is used with the Payment Element and Link Authentication Element, it will automatically pass shipping\ninformation when confirming Payment Intent or Setup Intent.\nBilling: is used with the Payment Element, it will automatically pass the billing information when confirming\nPayment Intent or Setup Intent.\n */\nexport enum StripeFormMode {\n    SHIPPING = 'shipping',\n    BILLING = 'billing',\n}\n\nexport enum StripeDisplayName {\n    SPLIT = 'split',\n    FULL = 'full',\n    ORGANIZATION = 'organization',\n}\n\ninterface CustomerDefaultValues {\n    mode: StripeFormMode;\n    email: string;\n    allowedCountries?: string[];\n    display?: {\n        name: StripeDisplayName;\n    };\n}\n\nexport interface StripeElements {\n    /**\n     * Creates an Elements instance, which manages a group of elements.\n     * https://stripe.com/docs/js/elements_object/create\n     */\n    create(elementType: StripeElementType, options?: StripeElementsCreateOptions): StripeElement;\n\n    /**\n     * Looks up a previously created element.\n     * https://stripe.com/docs/js/elements_object/get_payment_element or\n     * https://stripe.com/docs/js/elements_object/get_link_authentication_element\n     */\n    getElement(elementType: StripeElementType): StripeElement | null;\n\n    /**\n     * Updates options on an existing instance of Elements.\n     * https://stripe.com/docs/js/elements_object/update\n     */\n    update(options?: StripeUpdateElementsOptions): StripeElement;\n\n    /**\n     * Fetches updates from the associated PaymentIntent or SetupIntent on an existing instance of Elements,\n     * and reflects these updates in the Payment Element.\n     * https://stripe.com/docs/js/elements_object/fetch_updates\n     */\n    fetchUpdates(): Promise<void>;\n}\n\nexport interface StripeCheckoutSession {\n    loadActions(): Promise<StripeLoadActionsResult>;\n}\n\nexport enum StripeLoadActionsResultType {\n    SUCCESS = 'success',\n    ERROR = 'error',\n}\n\nexport interface StripeLoadActionsResult {\n    type: StripeLoadActionsResultType;\n    error?: { message: string };\n    actions?: StripeCheckoutSessionActions;\n}\n\nexport interface StripeCheckoutSessionActions {\n    updateEmail(email: string): Promise<void>;\n}\n\n/**\n * All available options are here https://stripe.com/docs/stripe-js/appearance-api#supported-css-properties\n */\nexport interface StripeAppearanceOptions {\n    variables?: Record<string, StripeAppearanceValues>;\n\n    rules?: Record<string, Record<string, StripeAppearanceValues>>;\n}\n\nexport type StripeAppearanceValues = string | string[] | number | undefined;\n\nexport interface StripeElementsOptions {\n    /**\n     * An array of custom fonts, which elements created from the Elements object can use.\n     * Fonts can be specified as [CssFontSource](https://stripe.com/docs/js/appendix/css_font_source_object)\n     * or [CustomFontSource](https://stripe.com/docs/js/appendix/custom_font_source_object) objects.\n     */\n    fonts?: StripeCustomFont[];\n\n    /**\n     * A [locale](https://stripe.com/docs/js/appendix/supported_locales) to display placeholders and\n     * error strings in. Default is auto (Stripe detects the locale of the browser).\n     * Setting the locale does not affect the behavior of postal code validationa valid postal code\n     * for the billing country of the card is still required.\n     */\n    locale?: string;\n\n    /**\n     * The client secret of this PaymentIntent. Used for client-side retrieval using a publishable key.\n     * The client secret can be used to complete a payment from your frontend.\n     * It should not be stored, logged, embedded in URLs, or exposed to anyone other than the customer.\n     * Make sure that you have TLS enabled on any page that includes the client secret.\n     * Refer to our docs to accept a payment and learn about how client_secret should be handled.\n     */\n    clientSecret?: string;\n\n    /**\n     * A token that represents the Stripe customer session.\n     * Stripe documentation: https://docs.stripe.com/api/checkout/sessions\n     */\n    customerSessionClientSecret?: string;\n\n    /**\n     * Match the design of your site with the appearance option.\n     * The layout of each Element stays consistent, but you can modify colors, fonts, borders, padding, and more.\n     */\n    appearance?: StripeAppearanceOptions;\n\n    mode?: string;\n    amount?: number;\n    currency?: string;\n    paymentMethodTypes?: string[];\n}\n\nexport interface StripeInitCheckoutOptions {\n    clientSecret: string;\n    elementsOptions?: StripeCheckoutSessionElementOptions;\n    adaptivePricing?: {\n        allowed: boolean;\n    };\n    defaultValues?: StripeCheckoutSessionDefaultValues;\n    wallets?: any;\n}\n\nexport interface StripeCheckoutSessionElementOptions {\n    appearance?: StripeAppearanceOptions;\n    loader?: StripeStringConstants;\n    fonts?: StripeCustomFont[];\n    savedPaymentMethod?: {\n        enableRedisplay?: StripeStringConstants;\n        enableSave?: StripeStringConstants;\n    };\n}\n\nexport interface StripeCheckoutSessionDefaultValues {\n    billingAddress?: StripeAddressValues;\n    shippingAddress?: StripeAddressValues;\n    email?: string;\n    phoneNumber?: string;\n}\n\nexport interface StripeUpdateElementsOptions {\n    /**\n     * A [locale](https://stripe.com/docs/js/appendix/supported_locales) to display placeholders and\n     * error strings in. Default is auto (Stripe detects the locale of the browser).\n     * Setting the locale does not affect the behavior of postal code validationa valid postal code\n     * for the billing country of the card is still required.\n     */\n    locale?: string;\n\n    /**\n     * Match the design of your site with the appearance option.\n     * The layout of each Element stays consistent, but you can modify colors, fonts, borders, padding, and more.\n     */\n    appearance?: StripeAppearanceOptions;\n    mode?: string;\n    amount?: number;\n    currency?: string;\n}\n\nexport interface StripeClient {\n    /**\n     * Use confirmPayment to confirm a PaymentIntent using data collected by the Payment Element.\n     * When called, confirmPayment will attempt to complete any required actions,\n     * such as authenticating your user by displaying a 3DS dialog or redirecting them to a bank authorization page.\n     */\n    confirmPayment(options: StripeConfirmPaymentData): Promise<StripeResult>;\n\n    /**\n     * When called, it will confirm the PaymentIntent with data you provide and carry out 3DS or other next actions if they are required.\n     */\n    confirmCardPayment(clientSecret: string): Promise<StripeResult>;\n\n    /**\n     * Retrieve a PaymentIntent using its client secret.\n     */\n    retrievePaymentIntent(clientSecret: string): Promise<StripeResult>;\n\n    /**\n     * Create an `Elements` instance, which manages a group of elements.\n     */\n    elements(options: StripeElementsOptions): StripeElements;\n\n    initCheckout(options: StripeInitCheckoutOptions): Promise<StripeCheckoutSession>;\n}\n\nexport interface StripeResult {\n    paymentIntent?: PaymentIntent;\n    error?: StripeError;\n}\n\nexport interface StripeHostWindow extends Window {\n    bcStripeClient?: StripeClient;\n    bcStripeElements?: StripeElements;\n    bcStripeCheckoutSession?: StripeCheckoutSession;\n    Stripe?<T = StripeClient>(\n        stripePublishableKey: string,\n        options?: StripeConfigurationOptions,\n    ): T;\n}\n\nexport enum StripePaymentMethodType {\n    CreditCard = 'card',\n    Link = 'link',\n    EPS = 'eps',\n    GRABPAY = 'grabpay',\n    BANCONTACT = 'bancontact',\n    IDEAL = 'ideal',\n    ALIPAY = 'alipay',\n    KLARNA = 'klarna',\n    OCS = 'optimized_checkout',\n}\n\ntype AutoOrNever = StripeStringConstants.AUTO | StripeStringConstants.NEVER;\n\nexport enum StripeStringConstants {\n    NEVER = 'never',\n    AUTO = 'auto',\n    ALWAYS = 'always',\n    PAYMENT = 'payment',\n    IF_REQUIRED = 'if_required',\n}\n\nexport enum StripeJsVersion {\n    V3 = 'v3',\n    ACACIA = 'acacia',\n    BASIL = 'basil',\n    CLOVER = 'clover',\n}\n\nexport enum StripeElementType {\n    PAYMENT = 'payment',\n    AUTHENTICATION = 'linkAuthentication',\n    SHIPPING = 'address',\n    EXPRESS_CHECKOUT = 'expressCheckout',\n}\n\nexport enum StripePaymentIntentStatus {\n    REQUIRES_PAYMENT_METHOD = 'requires_payment_method',\n    REQUIRES_CONFIRMATION = 'requires_confirmation',\n    REQUIRES_ACTION = 'requires_action',\n    PROCESSING = 'processing',\n    SUCCEEDED = 'succeeded',\n    CANCELED = 'canceled',\n}\n\nexport interface StripePaymentMethod extends PaymentMethod {\n    initializationData: StripeInitializationData;\n}\n\nexport interface StripeInitializationData {\n    stripePublishableKey: string;\n    stripeConnectedAccount: string;\n    shopperLanguage: string;\n    customerSessionToken?: string;\n    enableLink?: boolean;\n    allowRedisplayForStoredInstruments?: boolean;\n    captureMethod?: 'automatic' | 'manual';\n    useNewStripeJsVersion?: boolean;\n}\n\nexport interface StripeElementUpdateOptions {\n    shouldShowTerms?: boolean;\n}\n\nexport interface StripeAdditionalActionRequired {\n    type: string;\n    data: {\n        token?: string;\n        redirect_url?: string;\n    };\n}\n\nexport interface StripeAdditionalActionResponseBody {\n    additional_action_required: StripeAdditionalActionRequired;\n    three_ds_result: {\n        token?: string;\n    };\n}\n\nexport enum StripeElementEvent {\n    CLICK = 'click',\n    CHANGE = 'change',\n    READY = 'ready',\n    SHIPPING_ADDRESS_CHANGE = 'shippingaddresschange',\n    SHIPPING_RATE_CHANGE = 'shippingratechange',\n    CONFIRM = 'confirm',\n    CANCEL = 'cancel',\n    LOADER_START = 'loaderstart',\n}\n\nexport interface LineItem {\n    name: string;\n    amount: number;\n}\n\nexport interface StripeSavePaymentMethod {\n    maxVisiblePaymentMethods?: number;\n}\n\nexport enum StripeInstrumentSetupFutureUsage {\n    ON_SESSION = 'on_session',\n    OFF_SESSION = 'off_session',\n}\n\nexport interface StripeLinkV2Event {\n    value?: null;\n    billingDetails?: {\n        name?: string;\n        email?: string;\n        phone?: string;\n        address?: {\n            line1?: string;\n            city?: string;\n            country?: string;\n            postal_code?: string;\n            state?: string;\n        };\n    };\n    shippingAddress?: {\n        name?: string;\n        address?: {\n            line1?: string;\n            line2?: string;\n            city?: string;\n            country?: string;\n            postal_code?: string;\n            state?: string;\n        };\n    };\n    address?: {\n        line1?: string;\n        city?: string;\n        country?: string;\n        postal_code?: string;\n        state?: string;\n    };\n    shippingRate?: StripeLinkV2ShippingRate;\n    elementType: string;\n    expressPaymentType: string;\n    resolve(data: StripeLinkV2EventResolveData): void;\n    reject(): void;\n}\n\nexport interface StripeLinkV2EventResolveData {\n    lineItems?: LineItem[];\n    allowedShippingCountries?: string[];\n    shippingAddressRequired?: boolean;\n    shippingRates?: StripeLinkV2ShippingRate[];\n    billingAddressRequired?: boolean;\n    emailRequired?: boolean;\n    phoneNumberRequired?: boolean;\n}\n\nexport interface StripeLinkV2ShippingRate {\n    id: string;\n    amount: number;\n    displayName: string;\n}\n\nexport interface StripeLinkV2Options {\n    clientSecret?: string;\n    mode?: string;\n    currency?: string;\n    captureMethod?: 'automatic' | 'manual';\n    amount?: number;\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    StripeCheckoutSession,\n    StripeClient,\n    StripeElements,\n    StripeElementsOptions,\n    StripeHostWindow,\n    StripeInitCheckoutOptions,\n    StripeInitializationData,\n    StripeJsVersion,\n} from './stripe';\n\nexport default class StripeScriptLoader {\n    constructor(\n        private scriptLoader: ScriptLoader,\n        private stripeWindow: StripeHostWindow = window,\n    ) {}\n\n    async getStripeClient(\n        initializationData: StripeInitializationData,\n        locale?: string,\n        stripeJsVersion?: string,\n        betas?: string[],\n        apiVersion?: string,\n    ): Promise<StripeClient> {\n        if (this.stripeWindow.bcStripeClient) {\n            return this.stripeWindow.bcStripeClient;\n        }\n\n        const stripe = await this.load(stripeJsVersion);\n        const { stripePublishableKey, stripeConnectedAccount } = initializationData;\n        const options = {\n            ...(stripeConnectedAccount ? { stripeAccount: stripeConnectedAccount } : {}),\n            ...(locale ? { locale } : {}),\n            ...(betas ? { betas } : {}),\n            ...(apiVersion ? { apiVersion } : {}),\n        };\n\n        const stripeClient = stripe<StripeClient>(stripePublishableKey, options);\n\n        Object.assign(this.stripeWindow, { bcStripeClient: stripeClient });\n\n        return stripeClient;\n    }\n\n    async getElements(\n        stripeClient: StripeClient,\n        options: StripeElementsOptions,\n    ): Promise<StripeElements> {\n        let stripeElements = this.stripeWindow.bcStripeElements;\n\n        if (!stripeElements) {\n            stripeElements = stripeClient.elements(options);\n\n            Object.assign(this.stripeWindow, { bcStripeElements: stripeElements });\n        } else {\n            await this.updateStripeElements(options);\n        }\n\n        return stripeElements;\n    }\n\n    async updateStripeElements(options: StripeElementsOptions) {\n        const stripeElements = this.stripeWindow.bcStripeElements;\n\n        if (!stripeElements) {\n            return;\n        }\n\n        stripeElements.update(options);\n        await stripeElements.fetchUpdates();\n    }\n\n    async getCheckoutSession(\n        stripeClient: StripeClient,\n        options: StripeInitCheckoutOptions,\n    ): Promise<StripeCheckoutSession> {\n        let stripeCheckoutSession = this.stripeWindow.bcStripeCheckoutSession;\n\n        if (!stripeCheckoutSession) {\n            stripeCheckoutSession = await stripeClient.initCheckout(options);\n\n            Object.assign(this.stripeWindow, { bcStripeCheckoutSession: stripeCheckoutSession });\n        }\n\n        return stripeCheckoutSession;\n    }\n\n    private async load(stripeJsVersion?: string) {\n        if (!this.stripeWindow.Stripe) {\n            await this.scriptLoader.loadScript(this.getScriptUrl(stripeJsVersion));\n\n            if (!this.stripeWindow.Stripe) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.stripeWindow.Stripe;\n    }\n\n    private getScriptUrl(stripeJsVersion?: string) {\n        if (!stripeJsVersion || stripeJsVersion === StripeJsVersion.V3) {\n            return 'https://js.stripe.com/v3/';\n        }\n\n        return `https://js.stripe.com/${stripeJsVersion}/stripe.js`;\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        {\n            message,\n            errors,\n        }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {},\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","export const STRIPE_UPE_CLIENT_BETAS = [\n    'payment_element_beta_2',\n    'alipay_pm_beta_1',\n    'link_default_integration_beta_1',\n    'shipping_address_element_beta_1',\n    'address_element_beta_1',\n];\n\nexport const STRIPE_UPE_CLIENT_API_VERSION = '2020-03-02;alipay_beta=v1;link_beta=v1';\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayInitializationData, GooglePayStripeInitializationData } from '../types';\n\nfunction isGooglePayStripeInitializationData(\n    data: GooglePayInitializationData,\n): data is GooglePayStripeInitializationData {\n    return (\n        'stripeConnectedAccount' in data &&\n        'stripePublishableKey' in data &&\n        'stripeVersion' in data\n    );\n}\n\nexport default function assertsIsGooglePayStripeInitializationData(\n    data: GooglePayInitializationData,\n): asserts data is GooglePayStripeInitializationData {\n    if (!isGooglePayStripeInitializationData(data)) {\n        throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n    }\n}\n","import { includes, some } from 'lodash';\n\nimport {\n    InvalidArgumentError,\n    isRequestError,\n    PaymentArgumentInvalidError,\n    PaymentIntegrationSelectors,\n    PaymentIntegrationService,\n    PaymentMethodCancelledError,\n    PaymentMethodFailedError,\n    RequestError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    STRIPE_UPE_CLIENT_API_VERSION,\n    STRIPE_UPE_CLIENT_BETAS,\n    StripeJsVersion,\n    StripeScriptLoader,\n} from '@bigcommerce/checkout-sdk/stripe-utils';\n\nimport GooglePayGateway from '../gateways/google-pay-gateway';\nimport assertsIsGooglePayStripeInitializationData from '../guards/is-google-pay-stripe-initialization-data';\nimport isGooglePayStripeRequestError from '../guards/is-google-pay-stripe-request-error';\nimport assertIsGooglePayStripeTokenObject from '../guards/is-google-pay-stripe-token-object';\nimport {\n    GooglePayCardDataResponse,\n    GooglePaySetExternalCheckoutData,\n    GooglePayStripeGatewayParameters,\n    GooglePayStripeInitializationData,\n} from '../types';\n\nimport { StripeError, StripeUPEClient } from './types';\n\nexport default class GooglePayStripeGateway extends GooglePayGateway {\n    private stripeUPEClient?: StripeUPEClient;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private scriptLoader: StripeScriptLoader,\n    ) {\n        super('stripe', paymentIntegrationService);\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        let token: unknown;\n\n        try {\n            token = JSON.parse(data.nonce);\n        } catch (error) {\n            throw new InvalidArgumentError('Unable to parse response from Google Pay.');\n        }\n\n        assertIsGooglePayStripeTokenObject(token);\n\n        data.nonce = token.id;\n\n        return data;\n    }\n\n    getPaymentGatewayParameters(): GooglePayStripeGatewayParameters {\n        const data = this.getGooglePayInitializationData();\n\n        assertsIsGooglePayStripeInitializationData(data);\n\n        const { stripeVersion, stripePublishableKey, stripeConnectedAccount } = data;\n\n        return {\n            gateway: this.getGatewayIdentifier(),\n            'stripe:version': stripeVersion,\n            'stripe:publishableKey': `${stripePublishableKey}/${stripeConnectedAccount}`,\n        };\n    }\n\n    async processAdditionalAction(\n        error: unknown,\n        methodId?: string,\n    ): Promise<PaymentIntegrationSelectors | never> {\n        if (!methodId) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        if (!isRequestError(error) || !isGooglePayStripeRequestError(error.body)) {\n            throw error;\n        }\n\n        const shouldTrigger3DS = some(error.body.errors, { code: 'three_d_secure_required' });\n\n        if (shouldTrigger3DS) {\n            const initialization = this.getGooglePayInitializationData();\n\n            assertsIsGooglePayStripeInitializationData(initialization);\n\n            this.stripeUPEClient = await this.loadStripeJs(initialization, methodId);\n\n            const clientSecret = error.body.three_ds_result.token;\n            let result;\n            let catchedConfirmError = false;\n\n            try {\n                result = await this.stripeUPEClient.confirmCardPayment(clientSecret);\n            } catch (_) {\n                try {\n                    result = await this.stripeUPEClient.retrievePaymentIntent(clientSecret);\n                } catch (__) {\n                    catchedConfirmError = true;\n                }\n            }\n\n            if (result?.error) {\n                this._throwDisplayableStripeError(result.error);\n\n                if (this._isCancellationError(result.error)) {\n                    throw new PaymentMethodCancelledError();\n                }\n\n                throw new PaymentMethodFailedError();\n            }\n\n            if (!result?.paymentIntent && !catchedConfirmError) {\n                throw new RequestError();\n            }\n\n            return this.paymentIntegrationService.submitPayment({\n                methodId,\n                paymentData: { nonce: result?.paymentIntent?.id || clientSecret },\n            });\n        }\n\n        throw error;\n    }\n\n    private async loadStripeJs(\n        initializationData: GooglePayStripeInitializationData,\n        methodId: string,\n    ): Promise<StripeUPEClient> {\n        if (this.stripeUPEClient) {\n            return this.stripeUPEClient;\n        }\n\n        const locale = this.paymentIntegrationService.getState().getCartLocale();\n\n        if (methodId === 'googlepaystripeocs' && !!initializationData.useNewStripeJsVersion) {\n            return this.scriptLoader.getStripeClient(\n                initializationData,\n                locale,\n                StripeJsVersion.CLOVER,\n            );\n        }\n\n        return this.scriptLoader.getStripeClient(\n            initializationData,\n            locale,\n            StripeJsVersion.V3,\n            STRIPE_UPE_CLIENT_BETAS,\n            STRIPE_UPE_CLIENT_API_VERSION,\n        );\n    }\n\n    private _isCancellationError(stripeError: StripeError | undefined) {\n        return (\n            stripeError &&\n            stripeError.payment_intent.last_payment_error?.message?.indexOf('canceled') !== -1\n        );\n    }\n\n    private _throwDisplayableStripeError(stripeError: StripeError) {\n        if (\n            includes(['card_error', 'invalid_request_error', 'validation_error'], stripeError.type)\n        ) {\n            throw new Error(stripeError.message);\n        }\n    }\n}\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayStripeTokenObject } from '../types';\n\nfunction isGooglePayStripeTokenObject(token: unknown): token is GooglePayStripeTokenObject {\n    return typeof token === 'object' && token !== null && 'id' in token;\n}\n\nexport default function assertIsGooglePayStripeTokenObject(\n    token: unknown,\n): asserts token is GooglePayStripeTokenObject {\n    if (!isGooglePayStripeTokenObject(token)) {\n        throw new MissingDataError(MissingDataErrorType.MissingPaymentToken);\n    }\n}\n","interface AdditionalActionError {\n    three_ds_result: { token: string };\n    errors: Array<{ code: string }>;\n}\n\nconst isGooglePayStripeRequestError = (body: unknown): body is AdditionalActionError => {\n    return (\n        typeof body === 'object' && body !== null && 'three_ds_result' in body && 'errors' in body\n    );\n};\n\nexport default isGooglePayStripeRequestError;\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { StripeScriptLoader } from '@bigcommerce/checkout-sdk/stripe-utils';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../google-pay-payment-strategy';\n\nimport GooglePayStripeGateway from './google-pay-stripe-gateway';\n\nconst createGooglePayStripePaymentStrategy: PaymentStrategyFactory<GooglePayPaymentStrategy> = (\n    paymentIntegrationService,\n) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayStripeGateway(\n                paymentIntegrationService,\n                new StripeScriptLoader(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayStripePaymentStrategy, [\n    { id: 'googlepaystripe' },\n    { id: 'googlepaystripeupe' },\n    { id: 'googlepaystripeocs' },\n]);\n","import { PaymentIntegrationService } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayCardDataResponse, GooglePaySetExternalCheckoutData } from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayWorldpayAccessGateway extends GooglePayGateway {\n    constructor(service: PaymentIntegrationService) {\n        super('worldpay', service);\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        data.nonce = btoa(data.nonce);\n\n        return data;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayWorldpayAccessGateway from '../../gateways/google-pay-worldpayaccess-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayWorldpayAccessPaymentStrategy: PaymentStrategyFactory<\n    GooglePayPaymentStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayWorldpayAccessGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayWorldpayAccessPaymentStrategy, [\n    { id: 'googlepayworldpayaccess' },\n]);\n","export const BRAINTREE_SDK_HOSTED_FIELDS_FIX_VERSION = '3.128.0';\nexport const BRAINTREE_SDK_DEFAULT_VERSION = '3.123.2';\nexport const BRAINTREE_SDK_STABLE_VERSION = '3.106.0';\n","import { find } from 'lodash';\n\nimport { PaymentIntegrationService } from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { isExperimentEnabled } from '@bigcommerce/checkout-sdk/utility';\n\nimport { BraintreeHostWindow } from './braintree';\nimport {\n    BRAINTREE_SDK_DEFAULT_VERSION,\n    BRAINTREE_SDK_HOSTED_FIELDS_FIX_VERSION,\n    BRAINTREE_SDK_STABLE_VERSION,\n} from './braintree-sdk-verison';\n\nexport default class BraintreeSDKVersionManager {\n    private braintreeWindow: BraintreeHostWindow = window;\n\n    constructor(private paymentIntegrationService: PaymentIntegrationService) {}\n\n    getSDKVersion() {\n        const state = this.paymentIntegrationService.getState();\n        const storeConfig = state.getStoreConfig();\n        const features = storeConfig?.checkoutSettings.features || {};\n\n        const preloadedVersion = this.getPreloadedSDKVersion();\n\n        if (preloadedVersion) {\n            return preloadedVersion;\n        }\n\n        if (isExperimentEnabled(features, 'PAYPAL-5809.braintree_hosted_fields_fix_version')) {\n            return BRAINTREE_SDK_HOSTED_FIELDS_FIX_VERSION;\n        }\n\n        if (isExperimentEnabled(features, 'PAYPAL-5636.update_braintree_sdk_version')) {\n            return BRAINTREE_SDK_DEFAULT_VERSION;\n        }\n\n        return BRAINTREE_SDK_STABLE_VERSION;\n    }\n\n    private getPreloadedSDKVersion(): void | string {\n        const braintree = this.braintreeWindow.braintree;\n\n        if (braintree) {\n            const preloadedVersion = find<{ VERSION?: string }>(\n                Object.values(braintree),\n                (module) => !!module.VERSION,\n            );\n\n            return preloadedVersion?.VERSION;\n        }\n    }\n}\n","import { StandardError } from './index';\n\n/**\n * Throw this error if the shopper is using a browser version that is not\n * supported by us or any third party provider we use.\n */\nexport default class UnsupportedBrowserError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Unsupported browser error');\n\n        this.name = 'UnsupportedBrowserError';\n        this.type = 'unsupported_browser';\n    }\n}\n","import { Address } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport * from './braintree';\nexport * from './paypal';\nexport * from './visacheckout';\n\n/**\n *\n * Braintree Module\n *\n */\nexport interface BraintreeModuleCreator<\n    TInstance,\n    TOptions = BraintreeModuleCreatorConfig,\n    TError = BraintreeError,\n> {\n    create(\n        config: TOptions,\n        callback?: (error: TError, instance: TInstance) => void,\n    ): Promise<TInstance>;\n}\n\nexport interface BraintreeModuleCreatorConfig {\n    client?: BraintreeClient;\n    authorization?: string; // Info: authorization uses clientToken as a value\n}\n\nexport interface BraintreeModule {\n    teardown(): Promise<void>;\n}\n\n/**\n *\n * Braintree Window\n *\n */\nexport interface BraintreeWindow extends Window {\n    client?: BraintreeClientCreator;\n    braintreeFastlane?: BraintreeFastlane;\n}\n\n/**\n *\n * Braintree Client\n *\n */\nexport type BraintreeClientCreator = BraintreeModuleCreator<BraintreeClient>;\n\nexport interface BraintreeClient {\n    request(payload: BraintreeClientRequestPayload): Promise<BraintreeClientRequestResponse>;\n}\n\nexport interface BraintreeClientRequestPayload {\n    data: {\n        creditCard: {\n            billingAddress?: {\n                countryCodeAlpha2: string;\n                locality: string;\n                countryName: string;\n                postalCode: string;\n                streetAddress: string;\n            };\n            cardholderName: string;\n            cvv?: string;\n            expirationDate: string;\n            number: string;\n            options: {\n                validate: boolean;\n            };\n        };\n    };\n    endpoint: string;\n    method: string;\n}\n\nexport interface BraintreeHostedFieldsTokenizePayload {\n    nonce: string;\n    details: {\n        bin: string;\n        cardType: string;\n        expirationMonth: string;\n        expirationYear: string;\n        lastFour: string;\n        lastTwo: string;\n    };\n    description: string;\n    type: string;\n    binData: {\n        commercial: string;\n        countryOfIssuance: string;\n        debit: string;\n        durbinRegulated: string;\n        healthcare: string;\n        issuingBank: string;\n        payroll: string;\n        prepaid: string;\n        productId: string;\n    };\n}\n\nexport interface BraintreeClientRequestResponse {\n    creditCards: BraintreeHostedFieldsTokenizePayload[];\n}\n\n/**\n *\n * Braintree Data Collector\n *\n */\nexport type BraintreeDataCollectorCreator = BraintreeModuleCreator<\n    BraintreeDataCollector,\n    BraintreeDataCollectorCreatorConfig\n>;\n\nexport interface BraintreeDataCollectorCreatorConfig extends BraintreeModuleCreatorConfig {\n    kount?: boolean; // Info: this param is needed for fraud detection (should always be 'true')\n    paypal?: boolean; // TODO: based on braintree documentation, this param is deprecated, so we dont need it anymore\n    riskCorrelationId?: string; // Info: the option is needed for PayPal Analytics\n}\n\nexport interface BraintreeDataCollector extends BraintreeModule {\n    deviceData?: string;\n}\n\n// TODO: remove this interface when BraintreeIntegrationService will be removed\nexport interface BraintreeDataCollectors {\n    default?: BraintreeDataCollector;\n    paypal?: BraintreeDataCollector;\n}\n\n/**\n *\n * Braintree Google Payment\n *\n */\ntype BraintreeGooglePaymentAddressFormat = 'FULL' | 'MIN';\n\nexport enum TotalPriceStatusType {\n    ESTIMATED = 'ESTIMATED',\n    FINAL = 'FINAL',\n    NOT_CURRENTLY_KNOWN = 'NOT_CURRENTLY_KNOWN',\n}\n\nexport interface BraintreeGooglePaymentDataRequestOptions {\n    merchantInfo: {\n        authJwt?: string;\n        merchantId?: string;\n        merchantName?: string;\n    };\n    transactionInfo: {\n        currencyCode: string;\n        totalPriceStatus: TotalPriceStatusType;\n        totalPrice: string;\n    };\n    cardRequirements: {\n        billingAddressRequired: boolean;\n        billingAddressFormat: BraintreeGooglePaymentAddressFormat;\n    };\n    emailRequired?: boolean;\n    phoneNumberRequired?: boolean;\n    shippingAddressRequired?: boolean;\n}\n\nexport interface BraintreeGooglePaymentDataRequest {\n    allowedPaymentMethods: string[];\n    apiVersion: number;\n    cardRequirements: {\n        allowedCardNetworks: string[];\n        billingAddressFormat: string;\n        billingAddressRequired: boolean;\n    };\n    environment: string;\n    i: {\n        googleTransactionId: string;\n        startTimeMs: number;\n    };\n    merchantInfo: {\n        merchantId: string;\n        merchantName: string;\n        authJwt?: string;\n    };\n    paymentMethodTokenizationParameters: {\n        parameters: {\n            'braintree:apiVersion': string;\n            'braintree:authorizationFingerprint': string;\n            'braintree:merchantId': string;\n            'braintree:metadata': string;\n            'braintree:sdkVersion': string;\n            gateway: string;\n        };\n        tokenizationType: string;\n    };\n    shippingAddressRequired: boolean;\n    phoneNumberRequired: boolean;\n    transactionInfo: {\n        currencyCode: string;\n        totalPrice: string;\n        totalPriceStatus: TotalPriceStatusType;\n    };\n}\n\nexport type BraintreeGooglePaymentCreator = BraintreeModuleCreator<BraintreeGooglePayment>;\n\nexport interface BraintreeGooglePayment extends BraintreeModule {\n    createPaymentDataRequest(\n        options?: BraintreeGooglePaymentDataRequestOptions,\n    ): BraintreeGooglePaymentDataRequest;\n}\n\nexport interface BraintreeGooglePayThreeDSecure {\n    verifyCard(options: BraintreeGooglePayThreeDSecureOptions): Promise<BraintreeVerifyPayload>;\n}\n\nexport interface BraintreeGooglePayThreeDSecureOptions {\n    nonce: string;\n    amount: number;\n    bin: string;\n    showLoader?: boolean;\n    onLookupComplete(data: BraintreeThreeDSecureVerificationData, next: () => void): void;\n}\n\n/**\n *\n * Braintree 3D Secure\n *\n */\nexport type BraintreeThreeDSecureCreator = BraintreeModuleCreator<\n    BraintreeThreeDSecure,\n    BraintreeThreeDSecureCreatorConfig\n>;\n\nexport interface BraintreeThreeDSecure extends BraintreeModule {\n    verifyCard(\n        options: BraintreeThreeDSecureOptions,\n        callback?: Braintree3DSVerifyCardCallback,\n    ): Promise<BraintreeVerifyPayload>;\n    cancelVerifyCard(): Promise<BraintreeVerifyPayload>;\n    on<K extends keyof BraintreeThreeDSecureEventMap>(\n        event: K,\n        handler: BraintreeThreeDSecureEventMap[K],\n    ): void;\n}\n\nexport type Braintree3DSVerifyCardCallback = (\n    verifyError: Braintree3DSVerifyCardError,\n    payload: Braintree3DSVerifyCardPayload,\n) => void;\n\nexport interface BraintreeThreeDSecureEventMap {\n    'customer-canceled': () => void;\n}\n\nexport interface Braintree3DSVerifyCardError {\n    code: string;\n}\n\nexport interface Braintree3DSVerifyCardPayload {\n    nonce: string;\n}\n\nexport interface BraintreeThreeDSecureCreatorConfig extends BraintreeModuleCreatorConfig {\n    version?: number;\n}\n\nexport interface BraintreeThreeDSecureOptions {\n    nonce: string;\n    amount: number | string;\n    challengeRequested?: boolean;\n    showLoader?: boolean;\n    bin?: string;\n    additionalInformation?: {\n        acsWindowSize?: '01' | '02' | '03' | '04' | '05';\n    };\n    collectDeviceData?: boolean;\n    addFrame?(\n        error: Error | undefined,\n        iframe: HTMLIFrameElement,\n        cancel: () => Promise<BraintreeVerifyPayload> | undefined,\n    ): void;\n    removeFrame?(): void;\n    onLookupComplete?(data: BraintreeThreeDSecureVerificationData, next: () => void): void;\n}\n\nexport interface BraintreeThreeDSecureVerificationData {\n    lookup: {\n        threeDSecureVersion: string;\n    };\n    paymentMethod: BraintreeVerifyPayload;\n    requiresUserAuthentication: boolean;\n    threeDSecureInfo: {\n        liabilityShiftPossible: boolean;\n        liabilityShifted: boolean;\n    };\n}\n\nexport enum BraintreeOrderStatus {\n    Completed = 'COMPLETED',\n    Pending = 'PENDING',\n    Failed = 'FAILED',\n}\n\nexport interface BraintreeOrderStatusData {\n    status: BraintreeOrderStatus;\n}\n\n/**\n *\n * Braintree US Bank Account (ACH)\n *\n */\nexport type BraintreeUsBankAccountCreator = BraintreeModuleCreator<BraintreeUsBankAccount>;\n\nexport interface BraintreeUsBankAccount {\n    tokenize(\n        options: BraintreeUsBankAccountTokenizationOptions,\n    ): Promise<BraintreeUsBankAccountTokenizationResponse>;\n}\n\nexport interface BraintreeUsBankAccountTokenizationOptions {\n    bankDetails: BraintreeUsBankAccountDetails;\n    mandateText: string;\n}\n\nexport interface BraintreeUsBankAccountTokenizationResponse {\n    nonce: string;\n    details: BraintreeTokenizationDetails;\n}\n\nexport interface BraintreeUsBankAccountDetails {\n    accountNumber: string;\n    routingNumber: string;\n    ownershipType: string;\n    accountType: string;\n    firstName?: string;\n    lastName?: string;\n    businessName?: string;\n    billingAddress: {\n        streetAddress: string;\n        extendedAddress: string;\n        locality: string;\n        region: string;\n        postalCode: string;\n    };\n}\n\n// TODO: move this interface in separate types group if it will be used in another (not ACH) strategies\n// This seems to be an interface which will be used in different places\nexport interface BraintreeTokenizationDetails {\n    username?: string;\n    email?: string;\n    payerId?: string;\n    firstName?: string;\n    lastName?: string;\n    countryCode?: string;\n    phone?: string;\n    shippingAddress?: BraintreeShippingAddress;\n    billingAddress?: BraintreeAddress;\n}\n\nexport interface BraintreeAddress {\n    line1: string;\n    line2: string;\n    city: string;\n    state: string;\n    postalCode: string;\n    countryCode: string;\n}\n\nexport interface BraintreeShippingAddress extends BraintreeAddress {\n    recipientName: string;\n}\n\n/**\n *\n * Braintree non-instant payment methods\n *\n */\nexport enum NonInstantLocalPaymentMethods {\n    TRUSTLY = 'trustly',\n}\n\nexport interface BraintreeLocalPaymentMethodRedirectAction {\n    body: {\n        additional_action_required: {\n            type: 'offsite_redirect';\n            data: {\n                redirect_url: string;\n            };\n        };\n    };\n}\n\nexport interface BraintreeOrderSavedResponse {\n    body: {\n        additional_action_required: {\n            data: {\n                order_id_saved_successfully: string;\n            };\n        };\n    };\n}\n\n/**\n *\n * Braintree Fastlane\n *\n */\nexport type BraintreeFastlaneCreator = BraintreeModuleCreator<\n    BraintreeFastlane,\n    BraintreeFastlaneConfig\n>;\n\nexport interface BraintreeFastlaneConfig {\n    authorization: string;\n    client: BraintreeClient;\n    deviceData?: string;\n    styles?: BraintreeFastlaneStylesOption;\n}\n\nexport interface BraintreeFastlane {\n    identity: BraintreeFastlaneIdentity;\n    profile: BraintreeFastlaneProfile;\n    FastlaneCardComponent: (\n        options: BraintreeFastlaneCardComponentOptions,\n    ) => Promise<BraintreeFastlaneCardComponent>;\n    events: BraintreeFastlaneEvents;\n}\n\nexport interface BraintreeFastlaneProfile {\n    showCardSelector(): Promise<BraintreeFastlaneCardSelectorResponse>;\n    showShippingAddressSelector(): Promise<BraintreeFastlaneShippingAddressSelectorResponse>;\n}\n\nexport interface BraintreeFastlaneShippingAddressSelectorResponse {\n    selectionChanged: boolean;\n    selectedAddress: BraintreeFastlaneShippingAddress;\n}\n\nexport interface BraintreeFastlaneShippingAddress {\n    name: BraintreeFastlaneProfileName;\n    phoneNumber: string;\n    id?: string;\n    firstName?: string;\n    lastName?: string;\n    company?: string;\n    streetAddress: string;\n    extendedAddress?: string;\n    locality: string;\n    region: string;\n    postalCode: string;\n    countryCodeNumeric?: number;\n    countryCodeAlpha2: string;\n    countryCodeAlpha3?: string;\n}\n\nexport interface BraintreeFastlaneProfileName {\n    fullName: string;\n    firstName?: string;\n    lastName?: string;\n}\n\nexport interface BraintreeFastlaneCardSelectorResponse {\n    selectionChanged: boolean;\n    selectedCard: BraintreeFastlaneVaultedInstrument;\n}\n\nexport interface BraintreeFastlaneWindow extends Window {\n    braintreeFastlane: BraintreeFastlane;\n}\n\nexport interface BraintreeFastlaneIdentity {\n    lookupCustomerByEmail(email: string): Promise<BraintreeFastlaneLookupCustomerByEmailResult>;\n    triggerAuthenticationFlow(\n        customerId: string,\n        options?: BraintreeFastlaneAuthenticationOptions,\n    ): Promise<BraintreeFastlaneAuthenticationCustomerResult>;\n}\n\nexport interface BraintreeFastlaneLookupCustomerByEmailResult {\n    customerContextId?: string;\n}\n\nexport interface BraintreeFastlaneAuthenticationOptions {\n    styles?: BraintreeFastlaneStylesOption;\n}\n\nexport interface BraintreeFastlaneStylesOption {\n    root?: {\n        backgroundColorPrimary?: string;\n        errorColor?: string;\n        fontFamily?: string;\n        fontSizeBase?: string;\n        padding?: string;\n        primaryColor?: string;\n    };\n    input?: {\n        borderRadius?: string;\n        borderColor?: string;\n        focusBorderColor?: string;\n        backgroundColor?: string;\n        borderWidth?: string;\n        textColorBase?: string;\n    };\n    toggle?: {\n        colorPrimary?: string;\n        colorSecondary?: string;\n    };\n    text?: {\n        body?: {\n            color?: string;\n            fontSize?: string;\n        };\n        caption?: {\n            color?: string;\n            fontSize?: string;\n        };\n    };\n    branding?: string; // 'light' | 'dark'\n}\n\nexport enum BraintreeFastlaneAuthenticationState {\n    SUCCEEDED = 'succeeded',\n    FAILED = 'failed',\n    CANCELED = 'cancelled',\n    UNRECOGNIZED = 'unrecognized',\n}\n\nexport interface BraintreeFastlaneAuthenticationCustomerResult {\n    authenticationState: BraintreeFastlaneAuthenticationState;\n    profileData: BraintreeFastlaneProfileData;\n}\n\nexport interface BraintreeFastlaneProfileData {\n    fastlaneCustomerAuthAssertionToken: string;\n    fastlaneCustomerId: string;\n    shippingAddress: BraintreeFastlaneAddress;\n    card: BraintreeFastlaneVaultedInstrument;\n    name: BraintreeFastlaneName;\n}\n\nexport interface BraintreeFastlaneName {\n    firstName: string;\n    lastName: string;\n}\n\nexport interface BraintreeFastlaneAddress {\n    id?: string;\n    firstName?: string;\n    lastName?: string;\n    company?: string;\n    streetAddress: string;\n    extendedAddress?: string;\n    locality: string;\n    region: string;\n    postalCode: string;\n    countryCodeNumeric?: number;\n    countryCodeAlpha2: string;\n    countryCodeAlpha3?: string;\n    phoneNumber?: string;\n}\n\nexport interface BraintreeFastlaneCardPaymentSource {\n    brand: string;\n    expiry: string;\n    lastDigits: string;\n    name?: string;\n    billingAddress: BraintreeFastlaneAddress;\n    binDetails?: {\n        bin: string;\n    };\n}\n\nexport interface BraintreeFastlanePaymentSource {\n    card: BraintreeFastlaneCardPaymentSource;\n}\n\nexport interface BraintreeFastlaneVaultedInstrument {\n    id: string; // This is the nonce / token\n    paymentSource: BraintreeFastlanePaymentSource;\n}\n\nexport interface BraintreeFastlaneCardComponentOptions {\n    styles: BraintreeFastlaneStylesOption;\n    fields: BraintreeFastlaneCardComponentFields;\n}\n\nexport interface BraintreeFastlaneCardComponentFields {\n    cardholderName?: {\n        enabled?: boolean;\n        prefill?: string;\n    };\n    phoneNumber?: {\n        placeholder?: string;\n        prefill?: string;\n    };\n}\n\nexport interface FastlaneStylesSettings {\n    fastlaneRootSettingsBackgroundColor?: string;\n    fastlaneRootSettingsErrorColor?: string;\n    fastlaneRootSettingsFontFamily?: string;\n    fastlaneRootSettingsPadding?: string;\n    fastlaneRootSettingsPrimaryColor?: string;\n    fastlaneRootSettingsFontSize?: string;\n    fastlaneInputSettingsBackgroundColor?: string;\n    fastlaneInputSettingsBorderRadius?: string;\n    fastlaneInputSettingsBorderWidth?: string;\n    fastlaneInputSettingsBorderColor?: string;\n    fastlaneInputSettingsFocusBorderBase?: string;\n    fastlaneInputSettingsTextColorBase?: string;\n    fastlaneToggleSettingsColorPrimary?: string;\n    fastlaneToggleSettingsColorSecondary?: string;\n    fastlaneTextBodySettingsColor?: string;\n    fastlaneTextBodySettingsFontSize?: string;\n    fastlaneTextCaptionSettingsFontSize?: string;\n    fastlaneTextCaptionSettingsColor?: string;\n    fastlaneBrandingSettings?: string;\n}\n\nexport interface BraintreeFastlaneTokenizeOptions {\n    name?: {\n        fullName: string;\n    };\n    billingAddress?: BraintreeFastlaneAddress;\n    shippingAddress?: BraintreeFastlaneAddress;\n}\n\nexport interface BraintreeFastlaneEvents {\n    apmSelected: (options: BraintreeFastlaneApmSelectedEventOptions) => void;\n    emailSubmitted: (options: BraintreeFastlaneEmailEnteredEventOptions) => void;\n    orderPlaced: (options: BraintreeFastlaneOrderPlacedEventOptions) => void;\n}\n\nexport interface BraintreeFastlaneEventCommonOptions {\n    context_type: 'cs_id';\n    context_id: string; // checkout session id\n    page_type: 'checkout_page';\n    page_name: string; // title of the checkout initiation page\n    partner_name: 'bigc';\n    user_type: 'store_member' | 'store_guest'; // type of the user on the merchant site\n    store_id: string;\n    merchant_name: string;\n    experiment: string; // stringify JSON object \"[{ treatment_group: 'test' | 'control' }]\"\n}\n\nexport interface BraintreeFastlaneApmSelectedEventOptions\n    extends BraintreeFastlaneEventCommonOptions {\n    apm_shown: '0' | '1'; // alternate payment shown on the checkout page\n    apm_list: string; // list of alternate payment shown on checkout page\n    apm_selected: string; // alternate payment method selected / methodId\n    apm_location: 'pre-email section' | 'payment section'; // placement of APM, whether it be above the email entry or in the radio buttons\n}\n\nexport interface BraintreeFastlaneEmailEnteredEventOptions\n    extends BraintreeFastlaneEventCommonOptions {\n    user_email_saved: boolean; // shows whether checkout was loaded with or without a saved email\n    apm_shown: '0' | '1'; // alternate payment shown on the checkout page\n    apm_list: string; // list of alternate payment shown on checkout page 'applepay,googlepay,paypal'\n}\n\nexport interface BraintreeFastlaneOrderPlacedEventOptions\n    extends BraintreeFastlaneEventCommonOptions {\n    selected_payment_method: string;\n    currency_code: string;\n}\n\nexport interface BraintreeFastlaneCardComponent {\n    (options: BraintreeFastlaneCardComponentOptions): BraintreeFastlaneCardComponent;\n    getPaymentToken(\n        options: BraintreeFastlaneTokenizeOptions,\n    ): Promise<BraintreeFastlaneVaultedInstrument>;\n    render(element: string): void;\n}\n\n/**\n *\n * Braintree Payload Verification\n *\n */\nexport interface BraintreeVerifyPayload {\n    nonce: string;\n    details: {\n        cardType: string;\n        lastFour: string;\n        lastTwo: string;\n    };\n    description: string;\n    liabilityShiftPossible: boolean;\n    liabilityShifted: boolean;\n}\n\n/**\n *\n * Braintree Errors\n *\n */\nexport enum BraintreeErrorType {\n    Customer = 'CUSTOMER',\n    Merchant = 'MERCHANT',\n    Network = 'NETWORK',\n    Internal = 'INTERNAL',\n    Unknown = 'UNKNOWN',\n}\n\nexport enum BraintreeErrorCode {\n    KountNotEnabled = 'DATA_COLLECTOR_KOUNT_NOT_ENABLED',\n}\n\nexport interface BraintreeError extends Error {\n    type: BraintreeErrorType;\n    code: string | BraintreeErrorCode.KountNotEnabled;\n    details?: unknown;\n}\n\nexport interface BraintreeRedirectError {\n    body: {\n        additional_action_required: {\n            data: {\n                redirect_url: string;\n            };\n        };\n    };\n}\n\nexport default interface BillingAddress extends Address {\n    id: string;\n    email?: string;\n}\n\nexport enum BraintreeSupportedCardBrands {\n    Visa = 'visa',\n    Mastercard = 'mastercard',\n    AmericanExpress = 'american-express',\n    DinersClub = 'diners-club',\n    Discover = 'discover',\n    Jcb = 'jcb',\n    UnionPay = 'union-pay',\n    Maestro = 'maestro',\n    Elo = 'elo',\n    Mir = 'mir',\n    Hiper = 'hiper',\n    Hipercard = 'hipercard',\n}\n\nexport interface BillingAddressState {\n    data?: BillingAddress;\n    errors: BillingAddressErrorsState;\n    statuses: BillingAddressStatusesState;\n}\n\nexport interface BillingAddressErrorsState {\n    loadError?: Error;\n    updateError?: Error;\n    continueAsGuestError?: Error;\n}\n\nexport interface BillingAddressStatusesState {\n    isLoading?: boolean;\n    isUpdating?: boolean;\n    isContinuingAsGuest?: boolean;\n}\n\nexport interface BraintreeRequestData {\n    data: {\n        creditCard: {\n            billingAddress?: {\n                countryCodeAlpha2: string;\n                locality: string;\n                countryName: string;\n                postalCode: string;\n                streetAddress: string;\n            };\n            cardholderName: string;\n            cvv?: string;\n            expirationDate: string;\n            number: string;\n            options: {\n                validate: boolean;\n            };\n        };\n    };\n    endpoint: string;\n    method: string;\n}\n","import { Omit } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    PaypalAuthorizeData,\n    PaypalButtonOptions,\n    PaypalButtonRender,\n    PaypalSDK,\n    PaypalStyleOptions,\n} from './paypal';\nimport {\n    BraintreeClientCreator,\n    BraintreeDataCollectorCreator,\n    BraintreeError,\n    BraintreeFastlaneCreator,\n    BraintreeGooglePaymentCreator,\n    BraintreeHostedFieldsTokenizePayload,\n    BraintreeModule,\n    BraintreeModuleCreator,\n    BraintreeModuleCreatorConfig,\n    BraintreeThreeDSecureCreator,\n    BraintreeTokenizationDetails,\n    BraintreeUsBankAccountCreator,\n    BraintreeWindow,\n    FastlaneStylesSettings,\n    VisaCheckoutSDK,\n} from './types';\nimport {\n    VisaCheckoutInitOptions,\n    VisaCheckoutPaymentSuccessPayload,\n    VisaCheckoutTokenizedPayload,\n} from './visacheckout';\n\n/**\n *\n * Constants\n *\n */\nexport enum BraintreeEnv {\n    Sandbox = 'sandbox',\n    Production = 'production',\n}\n\n/**\n *\n * Common\n *\n */\nexport enum BraintreeModuleName {\n    Client = 'client',\n    DataCollector = 'dataCollector',\n    Fastlane = 'fastlane',\n    GooglePayment = 'googlePayment',\n    HostedFields = 'hostedFields',\n    LocalPayment = 'localPayment',\n    Paypal = 'paypal',\n    PaypalCheckout = 'paypalCheckout',\n    ThreeDSecure = 'threeDSecure',\n    UsBankAccount = 'usBankAccount',\n    Venmo = 'venmo',\n    VisaCheckout = 'visaCheckout',\n}\n\nexport type BraintreeModuleCreators =\n    | BraintreeClientCreator\n    | BraintreeFastlaneCreator\n    | BraintreeDataCollectorCreator\n    | BraintreeGooglePaymentCreator\n    | BraintreeHostedFieldsCreator\n    | BraintreePaypalCreator\n    | BraintreePaypalCheckoutCreator\n    | BraintreeThreeDSecureCreator\n    | BraintreeVenmoCheckoutCreator\n    | BraintreeVisaCheckoutCreator\n    | BraintreeUsBankAccountCreator\n    | BraintreeLocalPaymentCreator;\n\n// TODO: rename to BraintreeSdkModules\nexport interface BraintreeSDK {\n    [BraintreeModuleName.Client]?: BraintreeClientCreator;\n    [BraintreeModuleName.Fastlane]?: BraintreeFastlaneCreator;\n    [BraintreeModuleName.DataCollector]?: BraintreeDataCollectorCreator;\n    [BraintreeModuleName.GooglePayment]?: BraintreeGooglePaymentCreator;\n    [BraintreeModuleName.HostedFields]?: BraintreeHostedFieldsCreator;\n    [BraintreeModuleName.Paypal]?: BraintreePaypalCreator;\n    [BraintreeModuleName.PaypalCheckout]?: BraintreePaypalCheckoutCreator;\n    [BraintreeModuleName.ThreeDSecure]?: BraintreeThreeDSecureCreator;\n    [BraintreeModuleName.Venmo]?: BraintreeVenmoCheckoutCreator;\n    [BraintreeModuleName.VisaCheckout]?: BraintreeVisaCheckoutCreator;\n    [BraintreeModuleName.UsBankAccount]?: BraintreeUsBankAccountCreator;\n    [BraintreeModuleName.LocalPayment]?: BraintreeLocalPaymentCreator;\n}\n\nexport type BraintreeLocalPaymentCreator = BraintreeModuleCreator<\n    BraintreeLocalPayment,\n    BraintreeLocalPaymentCreateConfig,\n    BraintreeError | undefined\n>;\n\nexport interface BraintreeLocalPaymentCreateConfig extends BraintreeModuleCreatorConfig {\n    merchantAccountId: string;\n}\n\nexport interface BraintreeInitializationData {\n    clientToken: string;\n    enableCheckoutPaywallBanner?: boolean;\n    intent?: 'authorize' | 'order' | 'sale';\n    isCreditEnabled?: boolean;\n    isAcceleratedCheckoutEnabled?: boolean;\n    isFastlaneStylingEnabled?: boolean;\n    isFastlaneEnabled?: boolean;\n    isFastlaneShippingOptionAutoSelectEnabled?: boolean;\n    fastlaneStyles?: FastlaneStylesSettings;\n    isBraintreeAnalyticsV2Enabled?: boolean;\n    shouldRunAcceleratedCheckout?: boolean; // TODO: only for BT AXO A/B testing purposes, hence should be removed after testing\n    paymentButtonStyles?: Record<string, PaypalStyleOptions>;\n    paypalBNPLConfiguration?: PayPalBNPLConfigurationItem[] | null;\n    nonce?: string;\n}\n\nexport interface BraintreePaypalRequest {\n    amount: string | number;\n    billingAgreementDescription?: string;\n    currency?: string;\n    displayName?: string;\n    enableShippingAddress: true;\n    flow: 'checkout' | 'vault';\n    intent?: 'authorize' | 'order' | 'sale';\n    landingPageType?: 'login' | 'billing';\n    locale?: string;\n    offerCredit?: boolean;\n    shippingAddressEditable?: boolean;\n    shippingAddressOverride?: BraintreeShippingAddressOverride;\n    useraction?: 'commit';\n}\n\nexport interface BraintreeShippingAddressOverride {\n    line1: string;\n    line2?: string;\n    city: string;\n    state: string;\n    postalCode: string;\n    countryCode: string;\n    phone?: string;\n    recipientName?: string;\n}\n\nexport interface BraintreeTokenizePayload {\n    nonce: string;\n    type: 'PaypalAccount' | 'VenmoAccount';\n    details: BraintreeTokenizationDetails;\n    creditFinancingOffered?: {\n        totalCost: {\n            value: string;\n            currency: string;\n        };\n        term: number;\n        monthlyPayment: {\n            value: string;\n            currency: string;\n        };\n        totalInsterest: {\n            value: string;\n            currency: string;\n        };\n        payerAcceptance: boolean;\n        cartAmountImmutable: boolean;\n    };\n}\n\nexport type BraintreeFormErrorData = Omit<BraintreeFormFieldState, 'isFocused'>;\n\nexport type BraintreeFormErrorDataKeys =\n    | 'number'\n    | 'expirationDate'\n    | 'expirationMonth'\n    | 'expirationYear'\n    | 'cvv'\n    | 'postalCode';\n\nexport type BraintreeFormErrorsData = Partial<\n    Record<BraintreeFormErrorDataKeys, BraintreeFormErrorData>\n>;\n\n/**\n *\n * Braintree Hosted Fields\n *\n */\nexport type BraintreeHostedFieldsCreator = BraintreeModuleCreator<\n    BraintreeHostedFields,\n    BraintreeHostedFieldsCreatorConfig\n>;\n\nexport interface BraintreeHostedFields {\n    getState(): BraintreeHostedFieldsState;\n    teardown(): Promise<void>;\n    tokenize(\n        options?: BraintreeHostedFieldsTokenizeOptions,\n    ): Promise<BraintreeHostedFieldsTokenizePayload>;\n    on(eventName: string, callback: (event: BraintreeHostedFieldsState) => void): void;\n}\n\nexport interface BraintreeHostedFieldsCreatorConfig extends BraintreeModuleCreatorConfig {\n    fields: {\n        number?: BraintreeHostedFieldOption;\n        expirationDate?: BraintreeHostedFieldOption;\n        expirationMonth?: BraintreeHostedFieldOption;\n        expirationYear?: BraintreeHostedFieldOption;\n        cvv?: BraintreeHostedFieldOption;\n        postalCode?: BraintreeHostedFieldOption;\n        cardholderName?: BraintreeHostedFieldOption;\n    };\n    styles?: {\n        input?: { [key: string]: string };\n        '.invalid'?: { [key: string]: string };\n        '.valid'?: { [key: string]: string };\n        ':focus'?: { [key: string]: string };\n    };\n    preventCursorJumps?: boolean;\n}\n\nexport interface BraintreeHostedFieldOption {\n    container: string | HTMLElement;\n    placeholder?: string;\n    type?: string;\n    formatInput?: boolean;\n    maskInput?: boolean | { character?: string; showLastFour?: string };\n    select?: boolean | { options?: string[] };\n    maxCardLength?: number;\n    maxlength?: number;\n    minlength?: number;\n    prefill?: string;\n    rejectUnsupportedCards?: boolean;\n    supportedCardBrands?: { [key: string]: boolean };\n}\n\nexport interface BraintreeHostedFieldsState {\n    cards: BraintreeHostedFieldsCard[];\n    emittedBy: string;\n    fields: {\n        number?: BraintreeHostedFieldsFieldData;\n        expirationDate?: BraintreeHostedFieldsFieldData;\n        expirationMonth?: BraintreeHostedFieldsFieldData;\n        expirationYear?: BraintreeHostedFieldsFieldData;\n        cvv?: BraintreeHostedFieldsFieldData;\n        postalCode?: BraintreeHostedFieldsFieldData;\n    };\n}\n\nexport interface BraintreeHostedFieldsCard {\n    type: string;\n    niceType: string;\n    code: { name: string; size: number };\n}\n\nexport interface BraintreeHostedFieldsFieldData {\n    container: HTMLElement;\n    isFocused: boolean;\n    isEmpty: boolean;\n    isPotentiallyValid: boolean;\n    isValid: boolean;\n}\n\nexport interface BraintreeHostedFieldsTokenizeOptions {\n    vault?: boolean;\n    fieldsToTokenize?: string[];\n    cardholderName?: string;\n    billingAddress?: BraintreeBillingAddressRequestData;\n}\n\nexport interface BraintreeBillingAddressRequestData {\n    postalCode?: string;\n    firstName?: string;\n    lastName?: string;\n    company?: string;\n    streetAddress?: string;\n    extendedAddress?: string;\n    locality?: string;\n    region?: string;\n    countryCodeNumeric?: string;\n    countryCodeAlpha2?: string;\n    countryCodeAlpha3?: string;\n    countryName?: string;\n}\n\nexport interface BraintreeHostedFormError extends BraintreeError {\n    details?: {\n        invalidFieldKeys?: string[];\n    };\n}\n\nexport interface BraintreeFormFieldState {\n    isFocused: boolean;\n    isEmpty: boolean;\n    isPotentiallyValid: boolean;\n    isValid: boolean;\n}\n\nexport interface TokenizationPayload {\n    nonce: string;\n    bin: string;\n}\n\n/**\n *\n * Braintree PayPal\n *\n */\nexport type BraintreePaypalCreator = BraintreeModuleCreator<BraintreePaypal>;\n\nexport interface BraintreePaypal {\n    closeWindow(): void;\n    focusWindow(): void;\n    tokenize(options: BraintreePaypalRequest): Promise<BraintreeTokenizePayload>;\n    Buttons?(options: PaypalButtonOptions): PaypalButtonRender;\n}\n\n/**\n * A set of options that are required to support 3D Secure authentication flow.\n *\n * If the customer uses a credit card that has 3D Secure enabled, they will be\n * asked to verify their identity when they pay. The verification is done\n * through a web page via an iframe provided by the card issuer.\n */\n// export interface BraintreeThreeDSecureOptions {\n//     /**\n//      * A callback that gets called when the iframe is ready to be added to the\n//      * current page. It is responsible for determining where the iframe should\n//      * be inserted in the DOM.\n//      *\n//      * @param error - Any error raised during the verification process;\n//      * undefined if there is none.\n//      * @param iframe - The iframe element containing the verification web page\n//      * provided by the card issuer.\n//      * @param cancel - A function, when called, will cancel the verification\n//      * process and remove the iframe.\n//      */\n//     addFrame(\n//         error: Error | undefined,\n//         iframe: HTMLIFrameElement,\n//         cancel: () => Promise<BraintreeVerifyPayload> | undefined,\n//     ): void;\n//\n//     /**\n//      * A callback that gets called when the iframe is about to be removed from\n//      * the current page.\n//      */\n//     removeFrame(): void;\n// }\n\nexport interface BraintreeFormOptions {\n    fields: BraintreeFormFieldsMap | BraintreeStoredCardFieldsMap;\n    styles?: BraintreeFormFieldStylesMap;\n    onBlur?(data: BraintreeFormFieldBlurEventData): void;\n    onCardTypeChange?(data: BraintreeFormFieldCardTypeChangeEventData): void;\n    onFocus?(data: BraintreeFormFieldFocusEventData): void;\n    onValidate?(data: BraintreeFormFieldValidateEventData): void;\n    onEnter?(data: BraintreeFormFieldEnterEventData): void;\n}\n\nexport enum BraintreeFormFieldType {\n    CardCode = 'cardCode',\n    CardCodeVerification = 'cardCodeVerification',\n    CardExpiry = 'cardExpiry',\n    CardName = 'cardName',\n    CardNumber = 'cardNumber',\n    CardNumberVerification = 'cardNumberVerification',\n}\n\nexport interface BraintreeFormFieldsMap {\n    [BraintreeFormFieldType.CardCode]?: BraintreeFormFieldOptions;\n    [BraintreeFormFieldType.CardExpiry]: BraintreeFormFieldOptions;\n    [BraintreeFormFieldType.CardName]: BraintreeFormFieldOptions;\n    [BraintreeFormFieldType.CardNumber]: BraintreeFormFieldOptions;\n}\n\nexport interface BraintreeStoredCardFieldsMap {\n    [BraintreeFormFieldType.CardCodeVerification]?: BraintreeStoredCardFieldOptions;\n    [BraintreeFormFieldType.CardNumberVerification]?: BraintreeStoredCardFieldOptions;\n}\n\nexport interface BraintreeFormFieldOptions {\n    accessibilityLabel?: string;\n    containerId: string;\n    placeholder?: string;\n}\n\nexport interface BraintreeStoredCardFieldOptions extends BraintreeFormFieldOptions {\n    instrumentId: string;\n}\n\nexport interface BraintreeFormFieldStylesMap {\n    default?: BraintreeFormFieldStyles;\n    error?: BraintreeFormFieldStyles;\n    focus?: BraintreeFormFieldStyles;\n}\n\nexport type BraintreeFormFieldStyles = Partial<\n    Pick<CSSStyleDeclaration, 'color' | 'fontFamily' | 'fontSize' | 'fontWeight'>\n>;\n\nexport interface BraintreeFormFieldKeyboardEventData {\n    fieldType: string;\n    errors?: BraintreeFormErrorsData;\n}\n\nexport type BraintreeFormFieldBlurEventData = BraintreeFormFieldKeyboardEventData;\nexport type BraintreeFormFieldEnterEventData = BraintreeFormFieldKeyboardEventData;\nexport type BraintreeFormFieldFocusEventData = BraintreeFormFieldKeyboardEventData;\n\nexport interface BraintreeFormFieldCardTypeChangeEventData {\n    cardType?: string;\n}\n\nexport interface BraintreeFormFieldValidateEventData {\n    errors: {\n        [BraintreeFormFieldType.CardCode]?: BraintreeFormFieldValidateErrorData[];\n        [BraintreeFormFieldType.CardExpiry]?: BraintreeFormFieldValidateErrorData[];\n        [BraintreeFormFieldType.CardName]?: BraintreeFormFieldValidateErrorData[];\n        [BraintreeFormFieldType.CardNumber]?: BraintreeFormFieldValidateErrorData[];\n        [BraintreeFormFieldType.CardCodeVerification]?: BraintreeFormFieldValidateErrorData[];\n        [BraintreeFormFieldType.CardNumberVerification]?: BraintreeFormFieldValidateErrorData[];\n    };\n    isValid: boolean;\n}\n\nexport interface BraintreeFormFieldValidateErrorData {\n    fieldType: string;\n    message: string;\n    type: string;\n}\n\n/**\n *\n * Braintree PayPal Checkout\n *\n */\nexport type BraintreePaypalCheckoutCreator = BraintreeModuleCreator<BraintreePaypalCheckout>;\n\nexport interface BraintreePaypalCheckout {\n    loadPayPalSDK(\n        config: BraintreePaypalSdkCreatorConfig,\n        callback: (err: null | undefined | BraintreeError) => void,\n    ): void;\n    createPayment(options: BraintreePaypalRequest): Promise<string>;\n    teardown(): Promise<void>;\n    tokenizePayment(options: PaypalAuthorizeData): Promise<BraintreeTokenizePayload>;\n}\n\nexport interface BraintreePaypalSdkCreatorConfig {\n    components?: string;\n    currency?: string;\n    intent?: string;\n    isCreditEnabled?: boolean;\n    commit?: boolean;\n}\n\n/**\n *\n * Braintree Venmo\n *\n */\nexport type BraintreeVenmoCheckoutCreator = BraintreeModuleCreator<\n    BraintreeVenmoCheckout,\n    BraintreeVenmoCreatorConfig\n>;\n\nexport interface BraintreeVenmoCheckout extends BraintreeModule {\n    tokenize(callback: (error: BraintreeError, payload: BraintreeTokenizePayload) => unknown): void;\n    isBrowserSupported(): boolean;\n}\n\nexport interface BraintreeVenmoCreatorConfig extends BraintreeModuleCreatorConfig {\n    allowDesktop?: boolean;\n    paymentMethodUsage?: string;\n}\n\n/**\n *\n * Braintree Visa Checkout\n *\n */\nexport type BraintreeVisaCheckoutCreator = BraintreeModuleCreator<BraintreeVisaCheckout>;\n\nexport interface BraintreeVisaCheckout extends BraintreeModule {\n    tokenize(payment: VisaCheckoutPaymentSuccessPayload): Promise<VisaCheckoutTokenizedPayload>;\n    createInitOptions(options: Partial<VisaCheckoutInitOptions>): VisaCheckoutInitOptions;\n}\n\n/**\n *\n * Braintree BNPL Configurator related types\n *\n */\nexport interface PayPalBNPLConfigurationItem {\n    id: string;\n    name: string;\n    status: boolean;\n    styles: Record<string, string>;\n}\n\n/**\n *\n * Braintree Local Methods\n *\n */\nexport interface BraintreeLocalPaymentConfig {\n    paymentType: string;\n    amount: number;\n    fallback: {\n        url: string;\n        buttonText: string;\n    };\n    currencyCode: string;\n    shippingAddressRequired: boolean;\n    email: string;\n    givenName: string;\n    surname: string;\n    address: {\n        countryCode: string;\n    };\n    onPaymentStart(data: BraintreeLPMPaymentStartData, start: () => Promise<void>): Promise<void>;\n}\n\nexport interface BraintreeLPMStartPaymentError {\n    code: string;\n}\n\nexport interface BraintreeLPMPaymentStartData {\n    paymentId: string;\n}\n\nexport interface BraintreeLocalPaymentsPayload {\n    nonce: string;\n}\n\nexport interface BraintreeLocalPayment extends BraintreeModule {\n    startPayment(\n        config: BraintreeLocalPaymentConfig,\n        callback: (\n            startPaymentError: BraintreeLPMStartPaymentError | undefined,\n            payload: BraintreeLocalPaymentsPayload,\n        ) => Promise<void>,\n    ): void;\n}\n\n/**\n *\n * Other\n *\n */\nexport interface BraintreeHostWindow extends BraintreeWindow {\n    braintree?: BraintreeSDK;\n    paypal?: PaypalSDK;\n    V?: VisaCheckoutSDK;\n}\n","import {\n    NotInitializedError,\n    NotInitializedErrorType,\n    UnsupportedBrowserError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BraintreeScriptLoader from './braintree-script-loader';\nimport {\n    BraintreeClient,\n    BraintreeDataCollector,\n    BraintreeDataCollectorCreatorConfig,\n    BraintreeError,\n    BraintreeErrorCode,\n    BraintreeGooglePayment,\n    BraintreeLocalPayment,\n    BraintreeModule,\n    BraintreeThreeDSecure,\n    BraintreeUsBankAccount,\n    BraintreeVenmoCheckout,\n    BraintreeVisaCheckout,\n} from './types';\nimport isBraintreeError from './utils/is-braintree-error';\nimport { VisaCheckoutSDK } from './visacheckout';\n\nexport default class BraintreeSdk {\n    private braintreeVenmo?: BraintreeVenmoCheckout;\n    private braintreeLocalPayment?: BraintreeLocalPayment;\n    private client?: BraintreeClient;\n    private clientToken?: string;\n    private dataCollector?: BraintreeDataCollector;\n    private googlePayment?: BraintreeGooglePayment;\n    private threeDS?: BraintreeThreeDSecure;\n    private visaCheckout?: Promise<BraintreeVisaCheckout>;\n    private visaCheckoutSDK?: VisaCheckoutSDK;\n    private usBankAccount?: BraintreeUsBankAccount;\n\n    constructor(private braintreeScriptLoader: BraintreeScriptLoader) {}\n\n    initialize(clientToken: string): void {\n        this.setClientToken(clientToken);\n    }\n\n    async deinitialize(): Promise<void> {\n        await this.teardownModule(this.dataCollector);\n\n        this.dataCollector = undefined;\n    }\n\n    /**\n     *\n     * Braintree Client\n     * braintree doc: https://braintree.github.io/braintree-web/current/module-braintree-web_client.html\n     *\n     */\n    async getClient(): Promise<BraintreeClient> {\n        if (!this.client) {\n            const clientToken = this.getClientTokenOrThrow();\n            const clientCreator = await this.braintreeScriptLoader.loadClient();\n\n            this.client = await clientCreator.create({ authorization: clientToken });\n        }\n\n        return this.client;\n    }\n\n    /**\n     *\n     * Braintree Data collector\n     * braintree doc: https://braintree.github.io/braintree-web/current/module-braintree-web_data-collector.html\n     *\n     */\n    async getDataCollectorOrThrow(\n        options?: Partial<BraintreeDataCollectorCreatorConfig>,\n    ): Promise<BraintreeDataCollector> {\n        const emptyDataCollector = {\n            deviceData: undefined,\n            teardown: () => Promise.resolve(),\n        };\n\n        if (!this.dataCollector) {\n            try {\n                const client = await this.getClient();\n                const dataCollector = await this.braintreeScriptLoader.loadDataCollector();\n\n                const dataCollectorConfig: BraintreeDataCollectorCreatorConfig = {\n                    client,\n                    kount: true,\n                    ...options,\n                };\n\n                this.dataCollector = await dataCollector.create(dataCollectorConfig);\n            } catch (error) {\n                if (isBraintreeError(error) && error.code === BraintreeErrorCode.KountNotEnabled) {\n                    return emptyDataCollector;\n                }\n\n                throw error;\n            }\n        }\n\n        return this.dataCollector;\n    }\n\n    /**\n     *\n     * Braintree Google Payment\n     * braintree doc: https://braintree.github.io/braintree-web/current/module-braintree-web_google-payment.html\n     *\n     */\n    async getBraintreeGooglePayment(): Promise<BraintreeGooglePayment> {\n        if (!this.googlePayment) {\n            const [client, braintreeGooglePayment] = await Promise.all([\n                this.getClient(),\n                this.braintreeScriptLoader.loadGooglePayment(),\n            ]);\n\n            this.googlePayment = await braintreeGooglePayment.create({ client });\n        }\n\n        return this.googlePayment;\n    }\n\n    /**\n     *\n     * Braintree 3DS\n     * braintree doc: https://braintree.github.io/braintree-web/current/module-braintree-web_three-d-secure.html\n     *\n     */\n    async getBraintreeThreeDS(): Promise<BraintreeThreeDSecure> {\n        if (!this.threeDS) {\n            const [client, threeDSecure] = await Promise.all([\n                this.getClient(),\n                this.braintreeScriptLoader.load3DS(),\n            ]);\n\n            this.threeDS = await threeDSecure.create({ client, version: 2 });\n        }\n\n        return this.threeDS;\n    }\n\n    /**\n     *\n     * Braintree Local Payment Methods\n     * braintree doc: https://braintree.github.io/braintree-web/current/module-braintree-web_local-payment.html\n     *\n     */\n    async getBraintreeLocalPayment(\n        merchantAccountId: string,\n    ): Promise<BraintreeLocalPayment | undefined> {\n        if (!this.braintreeLocalPayment) {\n            const [client, localPaymentCreator] = await Promise.all([\n                this.getClient(),\n                this.braintreeScriptLoader.loadLocalPayment(),\n            ]);\n\n            this.braintreeLocalPayment = await new Promise(\n                (\n                    resolve: (braintreeLocalPayment: BraintreeLocalPayment) => void,\n                    reject: (error: BraintreeError) => void,\n                ) => {\n                    void localPaymentCreator.create(\n                        { client, merchantAccountId },\n                        (\n                            error: BraintreeError | undefined,\n                            braintreeLocalPayment: BraintreeLocalPayment,\n                        ) => {\n                            if (error) {\n                                reject(error);\n                            }\n\n                            resolve(braintreeLocalPayment);\n                        },\n                    );\n                },\n            );\n        }\n\n        return this.braintreeLocalPayment;\n    }\n\n    /**\n     *\n     * Braintree UsBankAccount\n     * braintree doc: https://braintree.github.io/braintree-web/current/module-braintree-web_us-bank-account.html\n     *\n     */\n    async getUsBankAccount() {\n        if (!this.usBankAccount) {\n            const client = await this.getClient();\n            const usBankAccount = await this.braintreeScriptLoader.loadUsBankAccount();\n\n            this.usBankAccount = await usBankAccount.create({ client });\n        }\n\n        return this.usBankAccount;\n    }\n\n    /**\n     *\n     * Braintree Visa Checkout\n     * braintree doc: https://braintree.github.io/braintree-web/current/module-braintree-web_visa-checkout.html\n     *\n     */\n    getBraintreeVisaCheckout() {\n        if (!this.visaCheckout) {\n            this.visaCheckout = Promise.all([\n                this.getClient(),\n                this.braintreeScriptLoader.loadVisaCheckout(),\n            ]).then(([client, paypal]) => paypal.create({ client }));\n        }\n\n        return this.visaCheckout;\n    }\n\n    /**\n     *\n     * Braintree Visa Checkout SDK\n     * visa checkout doc: https://developer.visa.com/capabilities/visa_checkout/docs-how-to\n     *\n     */\n    async getVisaCheckoutSdk(testMode?: boolean) {\n        if (!this.visaCheckoutSDK) {\n            this.visaCheckoutSDK = await this.braintreeScriptLoader.loadVisaCheckoutSdk(testMode);\n        }\n\n        return this.visaCheckoutSDK;\n    }\n\n    /**\n     *\n     * Braintree Venmo Checkout\n     * braintree venmo checkout doc: https://braintree.github.io/braintree-web/current/module-braintree-web_venmo.html\n     *\n     */\n    async getVenmoCheckoutOrThrow() {\n        if (!this.braintreeVenmo) {\n            const client = await this.getClient();\n            const venmoCheckout = await this.braintreeScriptLoader.loadVenmoCheckout();\n\n            const venmoCheckoutConfig = {\n                client,\n                allowDesktop: true,\n                paymentMethodUsage: 'multi_use',\n            };\n\n            const braintreeVenmoCheckout = await venmoCheckout.create(venmoCheckoutConfig);\n\n            if (braintreeVenmoCheckout.isBrowserSupported()) {\n                this.braintreeVenmo = braintreeVenmoCheckout;\n            } else {\n                throw new UnsupportedBrowserError();\n            }\n        }\n\n        return this.braintreeVenmo;\n    }\n\n    /**\n     *\n     * Private methods\n     *\n     */\n    private setClientToken(clientToken: string): void {\n        this.clientToken = clientToken;\n    }\n\n    private getClientTokenOrThrow(): string {\n        if (!this.clientToken) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        return this.clientToken;\n    }\n\n    private teardownModule(module?: BraintreeModule): Promise<void> {\n        return module ? module.teardown() : Promise.resolve();\n    }\n}\n","import { BraintreeError } from '../types';\n\nexport default function isBraintreeError(error: unknown): error is BraintreeError {\n    return Boolean(\n        typeof error === 'object' &&\n            error !== null &&\n            ('type' in error || 'message' in error || 'code' in error),\n    );\n}\n","import { BraintreeModuleName } from './braintree';\nimport {\n    BRAINTREE_SDK_DEFAULT_VERSION,\n    BRAINTREE_SDK_HOSTED_FIELDS_FIX_VERSION,\n    BRAINTREE_SDK_STABLE_VERSION,\n} from './braintree-sdk-verison';\n\nexport const BRAINTREE_SDK_SCRIPTS_INTEGRITY = {\n    [BRAINTREE_SDK_STABLE_VERSION]: {\n        [BraintreeModuleName.Client]:\n            'sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt',\n        [BraintreeModuleName.PaypalCheckout]:\n            'sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O',\n        [BraintreeModuleName.Paypal]:\n            'sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+',\n        [BraintreeModuleName.LocalPayment]:\n            'sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT',\n        [BraintreeModuleName.DataCollector]:\n            'sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV',\n        [BraintreeModuleName.UsBankAccount]:\n            'sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ',\n        [BraintreeModuleName.GooglePayment]:\n            'sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe',\n        [BraintreeModuleName.ThreeDSecure]:\n            'sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB',\n        [BraintreeModuleName.VisaCheckout]:\n            'sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT',\n        [BraintreeModuleName.Venmo]:\n            'sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov',\n        [BraintreeModuleName.HostedFields]:\n            'sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy',\n        [BraintreeModuleName.Fastlane]:\n            'sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa',\n    },\n    [BRAINTREE_SDK_DEFAULT_VERSION]: {\n        [BraintreeModuleName.Client]:\n            'sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO',\n        [BraintreeModuleName.PaypalCheckout]:\n            'sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/',\n        [BraintreeModuleName.Paypal]:\n            'sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt',\n        [BraintreeModuleName.LocalPayment]:\n            'sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH',\n        [BraintreeModuleName.DataCollector]:\n            'sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO',\n        [BraintreeModuleName.UsBankAccount]:\n            'sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW',\n        [BraintreeModuleName.GooglePayment]:\n            'sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO',\n        [BraintreeModuleName.ThreeDSecure]:\n            'sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym',\n        [BraintreeModuleName.VisaCheckout]:\n            'sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS',\n        [BraintreeModuleName.Venmo]:\n            'sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU',\n        [BraintreeModuleName.HostedFields]:\n            'sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P',\n        [BraintreeModuleName.Fastlane]:\n            'sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y',\n    },\n    [BRAINTREE_SDK_HOSTED_FIELDS_FIX_VERSION]: {\n        [BraintreeModuleName.Client]:\n            'sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq',\n        [BraintreeModuleName.PaypalCheckout]:\n            'sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh',\n        [BraintreeModuleName.Paypal]:\n            'sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH',\n        [BraintreeModuleName.LocalPayment]:\n            'sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC',\n        [BraintreeModuleName.DataCollector]:\n            'sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc',\n        [BraintreeModuleName.UsBankAccount]:\n            'sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F',\n        [BraintreeModuleName.GooglePayment]:\n            'sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i',\n        [BraintreeModuleName.ThreeDSecure]:\n            'sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D',\n        [BraintreeModuleName.VisaCheckout]:\n            'sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv',\n        [BraintreeModuleName.Venmo]:\n            'sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz',\n        [BraintreeModuleName.HostedFields]:\n            'sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z',\n        [BraintreeModuleName.Fastlane]:\n            'sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr',\n    },\n};\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { BRAINTREE_SDK_SCRIPTS_INTEGRITY } from './braintree-sdk-scripts-integrity';\nimport BraintreeSDKVersionManager from './braintree-sdk-version-manager';\nimport isManageableBraintreeSDKVersion from './isManageableBraintreeSDKVersion';\nimport {\n    BraintreeClientCreator,\n    BraintreeDataCollectorCreator,\n    BraintreeFastlaneCreator,\n    BraintreeGooglePaymentCreator,\n    BraintreeHostedFieldsCreator,\n    BraintreeHostWindow,\n    BraintreeLocalPaymentCreator,\n    BraintreeModuleCreators,\n    BraintreeModuleName,\n    BraintreePaypalCheckoutCreator,\n    BraintreePaypalCreator,\n    BraintreeThreeDSecureCreator,\n    BraintreeUsBankAccountCreator,\n    BraintreeVenmoCheckoutCreator,\n    BraintreeVisaCheckoutCreator,\n} from './types';\nimport { VisaCheckoutSDK } from './visacheckout';\n\nexport default class BraintreeScriptLoader {\n    constructor(\n        private scriptLoader: ScriptLoader,\n        private braintreeHostWindow: BraintreeHostWindow,\n        private braintreeSDKVersionManager: BraintreeSDKVersionManager,\n    ) {}\n\n    async loadClient(): Promise<BraintreeClientCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeClientCreator>(\n            BraintreeModuleName.Client,\n            'client.min.js',\n        );\n    }\n\n    async loadFastlane(): Promise<BraintreeFastlaneCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeFastlaneCreator>(\n            BraintreeModuleName.Fastlane,\n            'fastlane.min.js',\n        );\n    }\n\n    async loadPaypalCheckout(): Promise<BraintreePaypalCheckoutCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreePaypalCheckoutCreator>(\n            BraintreeModuleName.PaypalCheckout,\n            'paypal-checkout.min.js',\n        );\n    }\n\n    async loadPaypal(): Promise<BraintreePaypalCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreePaypalCreator>(\n            BraintreeModuleName.Paypal,\n            'paypal.min.js',\n        );\n    }\n\n    async loadLocalPayment(): Promise<BraintreeLocalPaymentCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeLocalPaymentCreator>(\n            BraintreeModuleName.LocalPayment,\n            'local-payment.min.js',\n        );\n    }\n\n    async loadDataCollector(): Promise<BraintreeDataCollectorCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeDataCollectorCreator>(\n            BraintreeModuleName.DataCollector,\n            'data-collector.min.js',\n        );\n    }\n\n    async loadUsBankAccount(): Promise<BraintreeUsBankAccountCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeUsBankAccountCreator>(\n            BraintreeModuleName.UsBankAccount,\n            'us-bank-account.min.js',\n        );\n    }\n\n    async loadGooglePayment(): Promise<BraintreeGooglePaymentCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeGooglePaymentCreator>(\n            BraintreeModuleName.GooglePayment,\n            'google-payment.min.js',\n        );\n    }\n\n    async load3DS(): Promise<BraintreeThreeDSecureCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeThreeDSecureCreator>(\n            BraintreeModuleName.ThreeDSecure,\n            'three-d-secure.min.js',\n        );\n    }\n\n    loadVisaCheckout(): Promise<BraintreeVisaCheckoutCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeVisaCheckoutCreator>(\n            BraintreeModuleName.VisaCheckout,\n            'visa-checkout.min.js',\n        );\n    }\n\n    loadVenmoCheckout(): Promise<BraintreeVenmoCheckoutCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeVenmoCheckoutCreator>(\n            BraintreeModuleName.Venmo,\n            'venmo.min.js',\n        );\n    }\n\n    async loadHostedFields(): Promise<BraintreeHostedFieldsCreator> {\n        return this.loadBraintreeModuleOrThrow<BraintreeHostedFieldsCreator>(\n            BraintreeModuleName.HostedFields,\n            'hosted-fields.min.js',\n        );\n    }\n\n    async loadVisaCheckoutSdk(testMode?: boolean): Promise<VisaCheckoutSDK> {\n        if (this.braintreeHostWindow.V) {\n            return this.braintreeHostWindow.V;\n        }\n\n        const hash = testMode\n            ? 'sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm'\n            : 'sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6';\n\n        return this.scriptLoader\n            .loadScript(\n                `//${\n                    testMode ? 'sandbox-' : ''\n                }assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,\n                {\n                    async: true,\n                    attributes: {\n                        integrity: hash,\n                        crossorigin: 'anonymous',\n                    },\n                },\n            )\n            .then(() => {\n                if (!this.braintreeHostWindow.V) {\n                    throw new PaymentMethodClientUnavailableError();\n                }\n\n                return this.braintreeHostWindow.V;\n            });\n    }\n\n    private async loadBraintreeModuleOrThrow<T extends BraintreeModuleCreators>(\n        braintreeModuleName: BraintreeModuleName,\n        fileName: string,\n    ): Promise<T> {\n        let module = this.getBraintreeModule(braintreeModuleName);\n\n        if (module) {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            return module as T;\n        }\n\n        const braintreeSdkVersion = this.braintreeSDKVersionManager.getSDKVersion();\n\n        const scriptPath = `//js.braintreegateway.com/web/${braintreeSdkVersion}/js/${fileName}`;\n\n        const integrity = isManageableBraintreeSDKVersion(braintreeSdkVersion)\n            ? this.getIntegrityValuesByModuleName(braintreeModuleName, braintreeSdkVersion)\n            : undefined;\n\n        await this.scriptLoader.loadScript(\n            scriptPath,\n            integrity\n                ? {\n                      async: true,\n                      attributes: {\n                          integrity,\n                          crossorigin: 'anonymous',\n                      },\n                  }\n                : undefined,\n        );\n\n        module = this.getBraintreeModule(braintreeModuleName);\n\n        if (!module) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        return module as T;\n    }\n\n    private getBraintreeModule(\n        braintreeModuleName: BraintreeModuleName,\n    ): BraintreeModuleCreators | undefined {\n        return this.braintreeHostWindow.braintree?.[braintreeModuleName];\n    }\n\n    private getIntegrityValuesByModuleName(\n        moduleName: BraintreeModuleName,\n        version: keyof typeof BRAINTREE_SDK_SCRIPTS_INTEGRITY,\n    ): string {\n        const integrity = BRAINTREE_SDK_SCRIPTS_INTEGRITY[version][moduleName];\n\n        if (!integrity) {\n            throw new Error('Unexpected fileName value');\n        }\n\n        return integrity;\n    }\n}\n","import { BRAINTREE_SDK_SCRIPTS_INTEGRITY } from './braintree-sdk-scripts-integrity';\n\nfunction isManageableBraintreeSDKVersion(\n    version: string,\n): version is keyof typeof BRAINTREE_SDK_SCRIPTS_INTEGRITY {\n    return version in BRAINTREE_SDK_SCRIPTS_INTEGRITY;\n}\n\nexport default isManageableBraintreeSDKVersion;\n","export default class CancellablePromise<T> {\n    promise: Promise<T>;\n    cancel!: (reason?: any) => void;\n\n    constructor(promise: Promise<T>) {\n        const cancellable = new Promise<T>((_, reject) => {\n            this.cancel = reject;\n        });\n\n        this.promise = Promise.race([promise, cancellable]);\n    }\n}\n","import {\n    BraintreeGooglePayment,\n    BraintreeGooglePayThreeDSecure,\n    BraintreeSdk,\n} from '@bigcommerce/checkout-sdk/braintree-utils';\nimport {\n    CancellablePromise,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    PaymentMethod,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayKey } from '../google-pay-payment-initialize-options';\nimport assertIsGooglePayBraintreeTokenObject from '../guards/is-google-pay-braintree-token-object';\nimport {\n    GooglePayCardDataResponse,\n    GooglePayGatewayParameters,\n    GooglePayInitializationData,\n    GooglePaySetExternalCheckoutData,\n} from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayBraintreeGateway extends GooglePayGateway {\n    private _braintreeGooglePayment?: BraintreeGooglePayment;\n    private _service: PaymentIntegrationService;\n    private _methodId = GooglePayKey.BRAINTREE;\n\n    constructor(service: PaymentIntegrationService, private _braintreeSdk: BraintreeSdk) {\n        super('braintree', service);\n\n        this._service = service;\n    }\n\n    async initialize(\n        getPaymentMethod: () => PaymentMethod<GooglePayInitializationData>,\n        isBuyNowFlow?: boolean,\n        currencyCode?: string,\n    ): Promise<void> {\n        await super.initialize(getPaymentMethod, isBuyNowFlow, currencyCode);\n\n        let paymentMethod = super.getPaymentMethod();\n\n        if (!paymentMethod.clientToken) {\n            const state = await this._service.loadPaymentMethod(this._methodId);\n\n            paymentMethod = state.getPaymentMethodOrThrow(this._methodId);\n        }\n\n        if (!paymentMethod.clientToken || !paymentMethod.initializationData) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        this._braintreeSdk.initialize(paymentMethod.clientToken);\n        this._braintreeGooglePayment = await this._braintreeSdk.getBraintreeGooglePayment();\n\n        return Promise.resolve();\n    }\n\n    async getNonce(methodId: string) {\n        const nonce = await super.getNonce(methodId);\n\n        const { clientToken, initializationData } = super.getPaymentMethod();\n\n        if (!clientToken || !initializationData || !initializationData.card_information?.bin) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            isThreeDSecureEnabled,\n            card_information: { bin, isNetworkTokenized },\n        } = initializationData;\n\n        if (isThreeDSecureEnabled && !isNetworkTokenized) {\n            const threeDSecure = await this._braintreeSdk.getBraintreeThreeDS();\n\n            const { orderAmount } = this._service.getState().getOrderOrThrow();\n\n            const verification = await this._braintreePresent3DSChallenge(\n                threeDSecure,\n                orderAmount,\n                nonce,\n                bin,\n            );\n\n            return verification.nonce;\n        }\n\n        return nonce;\n    }\n\n    async extraPaymentData() {\n        return {\n            deviceSessionId: await this._getBraintreeDeviceData(),\n        };\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        let token: unknown;\n\n        try {\n            token = JSON.parse(data.nonce);\n        } catch (error) {\n            throw new InvalidArgumentError('Unable to parse response from Google Pay.');\n        }\n\n        assertIsGooglePayBraintreeTokenObject(token);\n\n        data.nonce = token.androidPayCards[0].nonce;\n        data.card_information.bin = token.androidPayCards[0].details.bin;\n        data.card_information.isNetworkTokenized =\n            token.androidPayCards[0].details.isNetworkTokenized;\n\n        return data;\n    }\n\n    getCardParameters() {\n        return super.getCardParameters();\n    }\n\n    async getPaymentGatewayParameters(): Promise<GooglePayGatewayParameters> {\n        const braintreeGooglePayment = this.getBraintreeGooglePayment();\n\n        const request = braintreeGooglePayment.createPaymentDataRequest({\n            merchantInfo: super.getMerchantInfo(),\n            transactionInfo: super.getTransactionInfo(),\n            cardRequirements: {\n                billingAddressRequired: true,\n                billingAddressFormat: 'FULL',\n            },\n            ...(await super.getRequiredData()),\n        });\n\n        return request.paymentMethodTokenizationParameters.parameters;\n    }\n\n    private getBraintreeGooglePayment(): BraintreeGooglePayment {\n        if (!this._braintreeGooglePayment) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        return this._braintreeGooglePayment;\n    }\n\n    private async _getBraintreeDeviceData(): Promise<string | undefined> {\n        const { deviceData } = await this._braintreeSdk.getDataCollectorOrThrow();\n\n        return deviceData;\n    }\n\n    private _braintreePresent3DSChallenge(\n        threeDSecure: BraintreeGooglePayThreeDSecure,\n        amount: number,\n        nonce: string,\n        bin: string,\n    ) {\n        const verification = new CancellablePromise(\n            threeDSecure.verifyCard({\n                amount,\n                bin,\n                nonce,\n                onLookupComplete: (_data, next) => {\n                    next();\n                },\n            }),\n        );\n\n        return verification.promise;\n    }\n}\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayBraintreeTokenObject } from '../types';\n\nfunction isGooglePayBraintreeTokenObject(token: unknown): token is GooglePayBraintreeTokenObject {\n    return typeof token === 'object' && token !== null && 'androidPayCards' in token;\n}\n\nexport default function assertIsGooglePayBraintreeTokenObject(\n    token: unknown,\n): asserts token is GooglePayBraintreeTokenObject {\n    if (!isGooglePayBraintreeTokenObject(token)) {\n        throw new MissingDataError(MissingDataErrorType.MissingPaymentToken);\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    BraintreeHostWindow,\n    BraintreeScriptLoader,\n    BraintreeSdk,\n    BraintreeSDKVersionManager,\n} from '@bigcommerce/checkout-sdk/braintree-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayBraintreeGateway from '../../gateways/google-pay-braintree-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayBraintreePaymentStrategy: PaymentStrategyFactory<GooglePayPaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    const requestSender = createRequestSender();\n\n    const braintreeHostWindow: BraintreeHostWindow = window;\n    const braintreeSDKVersionManager = new BraintreeSDKVersionManager(paymentIntegrationService);\n    const braintreeSdk = new BraintreeSdk(\n        new BraintreeScriptLoader(\n            getScriptLoader(),\n            braintreeHostWindow,\n            braintreeSDKVersionManager,\n        ),\n    );\n\n    return new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayBraintreeGateway(paymentIntegrationService, braintreeSdk),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayBraintreePaymentStrategy, [\n    { id: 'googlepaybraintree' },\n]);\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    PayPalCommerceHostWindow,\n    PayPalCommerceInitializationData,\n    PayPalFastlaneSdk,\n    PayPalGooglePaySdk,\n    PayPalMessagesSdk,\n    PayPalSdkConfig,\n} from './paypal-commerce-types';\n\nexport default class PayPalCommerceSdk {\n    private window: PayPalCommerceHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async getPayPalFastlaneSdk(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): Promise<PayPalFastlaneSdk> {\n        if (!this.window.paypalFastlaneSdk) {\n            const config = this.getPayPalFastlaneSdkConfiguration(\n                paymentMethod,\n                currencyCode,\n                sessionId,\n            );\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalFastlaneSdk) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalFastlaneSdk;\n    }\n\n    async getPayPalGooglePaySdk(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalGooglePaySdk> {\n        if (!this.window.paypalGooglePay || forceLoad) {\n            const paypalSdkScriptConfig = this.getPayPalGooglePaySdkScriptConfigOrThrow(\n                paymentMethod,\n                currencyCode,\n                initializesOnCheckoutPage,\n            );\n\n            await this.loadPayPalSdk(paypalSdkScriptConfig);\n        }\n\n        if (!this.window.paypalGooglePay) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalGooglePay;\n    }\n\n    async getPayPalApmsSdk(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ) {\n        if (!this.window.paypalApms) {\n            const config = this.getPayPalApmSdkConfiguration(paymentMethod, currencyCode);\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalApms) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalApms;\n    }\n\n    async getPayPalMessages(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ): Promise<PayPalMessagesSdk> {\n        if (!this.window.paypalMessages) {\n            const paypalSdkMessagesConfig = this.getPayPalSdkMessagesConfiguration(\n                paymentMethod,\n                currencyCode,\n            );\n\n            await this.loadPayPalSdk(paypalSdkMessagesConfig);\n        }\n\n        if (!this.window.paypalMessages) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalMessages;\n    }\n\n    /**\n     *\n     *  loadPayPalSdk is a paypal sdk script loader\n     *  which loads paypal sdk based on provided configuration\n     *\n     */\n    private async loadPayPalSdk({ options, attributes }: PayPalSdkConfig): Promise<void> {\n        const scriptOptions = this.transformConfig<PayPalSdkConfig['options']>(options);\n        const scriptAttributes = this.transformConfig<PayPalSdkConfig['attributes']>(attributes);\n\n        const paypalSdkUrl = 'https://www.paypal.com/sdk/js';\n        const scriptQuery = new URLSearchParams(scriptOptions).toString();\n        const scriptSrc = `${paypalSdkUrl}?${scriptQuery}`;\n\n        await this.scriptLoader.loadScript(scriptSrc, {\n            async: true,\n            attributes: scriptAttributes,\n        });\n    }\n\n    /**\n     *\n     * Configurations section\n     *\n     */\n    private getPayPalFastlaneSdkConfiguration(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { intent, clientId, merchantId, attributionId } = initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit: true,\n                components: [\n                    'fastlane',\n                    'buttons',\n                    'payment-fields',\n                    'hosted-fields',\n                    'three-domain-secure',\n                ],\n                currency: currencyCode,\n                intent,\n            },\n            attributes: {\n                'data-client-metadata-id': sessionId.replace(/-/g, ''),\n                'data-namespace': 'paypalFastlaneSdk',\n                'data-partner-attribution-id': attributionId,\n                'data-sdk-client-token': clientToken,\n            },\n        };\n    }\n\n    private getPayPalGooglePaySdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isHostedCheckoutEnabled,\n            isDeveloperModeApplicable,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit,\n                components: ['googlepay'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n                'data-namespace': 'paypalGooglePay',\n            },\n        };\n    }\n\n    private getPayPalApmSdkConfiguration(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n        } = initializationData;\n\n        const enableAPMsFunding = enabledAlternativePaymentMethods;\n        const disableAPMsFunding = availableAlternativePaymentMethods.filter(\n            (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n        );\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableAPMsFunding.length > 0 ? enableAPMsFunding : undefined,\n                'disable-funding': disableAPMsFunding.length > 0 ? disableAPMsFunding : undefined,\n                commit: true,\n                components: ['buttons', 'payment-fields'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-namespace': 'paypalApms',\n            },\n        };\n    }\n\n    private getPayPalSdkMessagesConfiguration(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { clientId, merchantId, attributionId, isDeveloperModeApplicable, buyerCountry } =\n            initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                components: ['messages'],\n                currency: currencyCode,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-namespace': 'paypalMessages',\n                'data-partner-attribution-id': attributionId,\n            },\n        };\n    }\n\n    /**\n     *\n     * Utils methods\n     *\n     */\n    private transformConfig<T extends Record<string, unknown>>(config: T): Record<string, string> {\n        let transformedConfig = {};\n\n        const keys = Object.keys(config) as Array<keyof T>;\n\n        keys.forEach((key) => {\n            const value = config[key];\n\n            if (\n                value === undefined ||\n                value === null ||\n                value === '' ||\n                (Array.isArray(value) && value.length === 0)\n            ) {\n                return;\n            }\n\n            transformedConfig = {\n                ...transformedConfig,\n                [key]: Array.isArray(value) ? value.join(',') : value,\n            };\n        });\n\n        return transformedConfig;\n    }\n}\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { GooglePayInitializationData, GooglePayPayPalCommerceInitializationData } from '../types';\n\nfunction isGooglePayPaypalCommercePaymentMethod(\n    data: PaymentMethod<GooglePayInitializationData>,\n): data is PaymentMethod<GooglePayPayPalCommerceInitializationData> {\n    if (data.initializationData) {\n        return (\n            'attributionId' in data.initializationData &&\n            'isVenmoEnabled' in data.initializationData &&\n            'isGooglePayEnabled' in data.initializationData &&\n            'isPayPalCreditAvailable' in data.initializationData\n        );\n    }\n\n    return false;\n}\n\nexport default function assertsIsGooglePayPayPalCommercePaymentMethod(\n    data: PaymentMethod<GooglePayInitializationData>,\n): asserts data is PaymentMethod<GooglePayPayPalCommerceInitializationData> {\n    if (!isGooglePayPaypalCommercePaymentMethod(data)) {\n        throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n    }\n}\n","import {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    PaymentMethod,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { PayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\n\nimport GooglePayGateway from '../gateways/google-pay-gateway';\nimport assertsIsGooglePayPayPalCommercePaymentMethod from '../guards/is-google-pay-paypal-commerce-payment-method';\nimport {\n    GooglePayCardDataResponse,\n    GooglePayPayPalCommerceGatewayParameters,\n    GooglePayPayPalCommerceInitializationData,\n    GooglePaySetExternalCheckoutData,\n} from '../types';\n\nimport { GooglePayConfig } from './types';\n\nexport default class GooglePayPaypalCommerceGateway extends GooglePayGateway {\n    private googlepayConfig?: GooglePayConfig;\n    private service: PaymentIntegrationService;\n\n    constructor(service: PaymentIntegrationService, private payPalCommerceSdk: PayPalCommerceSdk) {\n        super('paypalsb', service);\n\n        this.service = service;\n    }\n\n    async initialize(\n        getPaymentMethod: () => PaymentMethod<GooglePayPayPalCommerceInitializationData>,\n        isBuyNowFlow?: boolean,\n        currencyCode?: string,\n    ): Promise<void> {\n        const currency = this.service.getState().getStoreConfig()?.currency.code ?? currencyCode;\n\n        if (!currency) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        await super.initialize(getPaymentMethod, isBuyNowFlow, currency);\n\n        const paymentMethod = super.getPaymentMethod();\n\n        if (!paymentMethod.initializationData) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        assertsIsGooglePayPayPalCommercePaymentMethod(paymentMethod);\n\n        const googlePaySdk = await this.payPalCommerceSdk.getPayPalGooglePaySdk(\n            paymentMethod,\n            currency,\n        );\n\n        this.googlepayConfig = await googlePaySdk.Googlepay().config();\n\n        const { allowedPaymentMethods } = this.googlepayConfig;\n\n        this.setGatewayIdentifier(\n            allowedPaymentMethods[0]?.tokenizationSpecification?.parameters?.gateway,\n        );\n    }\n\n    getPaymentGatewayParameters(): GooglePayPayPalCommerceGatewayParameters {\n        if (this.googlepayConfig) {\n            const { allowedPaymentMethods } = this.googlepayConfig;\n            const { gatewayMerchantId } =\n                allowedPaymentMethods[0].tokenizationSpecification.parameters;\n\n            return {\n                gateway: this.getGatewayIdentifier(),\n                gatewayMerchantId,\n            };\n        }\n\n        return {\n            gateway: this.getGatewayIdentifier(),\n        };\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        data.nonce = btoa(data.nonce);\n\n        return data;\n    }\n}\n","export const INTERNAL_USE_ONLY =\n    'This API endpoint is for internal use only and may change in the future';\n","export type FundingType = string[];\nexport type EnableFundingType = FundingType | string;\n\n/**\n *\n * PayPal Commerce SDK\n *\n */\nexport interface PayPalSDK {\n    Googlepay: () => {\n        config: () => Promise<GooglePayConfig>;\n        confirmOrder: (confirmOrderConfig: ConfirmOrderConfig) => Promise<{ status: string }>;\n        initiatePayerAction: (payerActionConfig: PayerActionConfig) => Promise<void>;\n    };\n}\n\ninterface ConfirmOrderConfig {\n    orderId: string;\n    paymentMethodData: ConfirmOrderData;\n}\n\ninterface PayerActionConfig {\n    orderId: string;\n}\n\nexport enum ConfirmOrderStatus {\n    Approved = 'APPROVED',\n    PayerActionRequired = 'PAYER_ACTION_REQUIRED',\n}\n\nexport interface PayPalCommerceHostWindow extends Window {\n    paypal?: PayPalSDK;\n}\n\nexport interface PayPalCommerceScriptParams {\n    options: {\n        'client-id'?: string;\n        'merchant-id'?: string;\n        'buyer-country'?: string;\n        'disable-funding'?: FundingType;\n        'enable-funding'?: EnableFundingType;\n        currency?: string;\n        commit?: boolean;\n        intent?: PayPalCommerceIntent;\n        components?: ComponentsScriptType;\n    };\n    attributes: {\n        'data-client-token'?: string;\n        'data-partner-attribution-id'?: string;\n    };\n}\n\nexport enum PayPalCommerceIntent {\n    AUTHORIZE = 'authorize',\n    CAPTURE = 'capture',\n}\n\nexport type ComponentsScriptType = Array<\n    | 'buttons'\n    | 'funding-eligibility'\n    | 'hosted-fields'\n    | 'messages'\n    | 'payment-fields'\n    | 'legal'\n    | 'googlepay'\n    | 'card-fields'\n>;\n\nexport interface GooglePayConfig {\n    allowedPaymentMethods: AllowedPaymentMethods[];\n    apiVersion: number;\n    apiVersionMinor: number;\n    countryCode: string;\n    isEligible: boolean;\n    merchantInfo: {\n        merchantId: string;\n        merchantOrigin: string;\n    };\n}\n\nexport interface AllowedPaymentMethods {\n    type: string;\n    parameters: {\n        allowedAuthMethods: string[];\n        allowedCardNetworks: string[];\n        billingAddressRequired: boolean;\n        assuranceDetailsRequired: boolean;\n        billingAddressParameters: {\n            format: string;\n        };\n    };\n    tokenizationSpecification: {\n        type: string;\n        parameters: {\n            gateway: string;\n            gatewayMerchantId: string;\n        };\n    };\n}\n\nexport interface PayPalGoogleSdk {\n    version: string;\n    getCorrelationID: () => void;\n    Googlepay: () => {\n        config: () => Promise<GooglePayConfig>;\n        confirmOrder: (arg0: {\n            orderId: string;\n            paymentMethodData: ConfirmOrderData;\n        }) => Promise<{ status: string }>;\n        initiatePayerAction: () => void;\n    };\n    FUNDING: Record<string, string>;\n}\n\nexport interface ConfirmOrderData {\n    tokenizationData: {\n        type: string;\n        token: string;\n    };\n    info: {\n        cardNetwork: string;\n        cardDetails: string;\n    };\n    type: string;\n}\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    ContentType,\n    INTERNAL_USE_ONLY,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentIntegrationService,\n    SDK_VERSION_HEADERS,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { PayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\n\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../google-pay-payment-strategy';\nimport { GooglePayInitializationData, GooglePayPayPalCommerceInitializationData } from '../types';\n\nimport { ConfirmOrderData, ConfirmOrderStatus } from './types';\n\nexport default class GooglePayPaypalCommercePaymentStrategy extends GooglePayPaymentStrategy {\n    constructor(\n        _paymentIntegrationService: PaymentIntegrationService,\n        _googlePayPaymentProcessor: GooglePayPaymentProcessor,\n        private _payPalCommerceSdk: PayPalCommerceSdk,\n        private _requestSender: RequestSender,\n    ) {\n        super(_paymentIntegrationService, _googlePayPaymentProcessor);\n    }\n\n    async execute({ payment }: OrderRequestBody): Promise<void> {\n        if (!payment?.methodId) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const state = this._paymentIntegrationService.getState();\n        const cartId = state.getCartOrThrow().id;\n        const { initializationData } = state.getPaymentMethodOrThrow<GooglePayInitializationData>(\n            this._getMethodId(),\n        );\n        const { orderId } = await this.getOrderId(cartId);\n\n        const { card_information } = initializationData || {};\n        const nonce = await this._googlePayPaymentProcessor.getNonce(payment.methodId);\n\n        const confirmOrderData = {\n            tokenizationData: {\n                type: 'PAYMENT_GATEWAY',\n                token: atob(nonce),\n            },\n            info: {\n                cardNetwork: card_information?.type || '',\n                cardDetails: card_information?.number || '',\n            },\n            type: 'CARD',\n        };\n\n        await this.confirmOrder(orderId, confirmOrderData);\n        await this._paymentIntegrationService.submitOrder();\n\n        try {\n            const paymentData = {\n                formattedPayload: {\n                    method_id: payment.methodId,\n                    paypal_account: {\n                        order_id: orderId,\n                    },\n                },\n            };\n\n            await this._paymentIntegrationService.submitPayment({\n                methodId: payment.methodId,\n                paymentData,\n            });\n        } catch (error) {\n            await this._googlePayPaymentProcessor.processAdditionalAction(error);\n        }\n    }\n\n    private async confirmOrder(orderId: string, confirmOrderData: ConfirmOrderData) {\n        const state = this._paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<GooglePayPayPalCommerceInitializationData>(\n                this._getMethodId(),\n            );\n\n        if (!paymentMethod.initializationData) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const currencyCode = state.getCartOrThrow().currency.code;\n\n        const payPalSDK = await this._payPalCommerceSdk.getPayPalGooglePaySdk(\n            paymentMethod,\n            currencyCode,\n            true,\n        );\n\n        const { status } = await payPalSDK\n            .Googlepay()\n            .confirmOrder({ orderId, paymentMethodData: confirmOrderData });\n\n        if (status === ConfirmOrderStatus.PayerActionRequired) {\n            await payPalSDK.Googlepay().initiatePayerAction({ orderId });\n\n            return Promise.resolve();\n        }\n\n        if (status !== ConfirmOrderStatus.Approved) {\n            throw new InvalidArgumentError('Payment is not approved.');\n        }\n\n        return Promise.resolve();\n    }\n\n    private async getOrderId(cartId: string): Promise<{ orderId: string }> {\n        const url = '/api/storefront/payments/googlepaypaypalcommercecheckout';\n        const requestData = {\n            cartId,\n            shouldSaveInstrument: false,\n        };\n\n        const { body } = await this._requestSender.post<{ orderId: string }>(url, {\n            headers: {\n                'X-API-INTERNAL': INTERNAL_USE_ONLY,\n                'Content-Type': ContentType.Json,\n                ...SDK_VERSION_HEADERS,\n            },\n            body: requestData,\n        });\n\n        return body;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { PayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../google-pay-payment-strategy';\n\nimport GooglePayPaypalCommerceGateway from './google-pay-paypal-commerce-gateway';\nimport GooglePayPaypalCommercePaymentStrategy from './google-pay-paypal-commerce-payment-strategy';\n\nconst createGooglePayPayPalCommercePaymentStrategy: PaymentStrategyFactory<\n    GooglePayPaymentStrategy\n> = (paymentIntegrationService) => {\n    const payPalCommerceSdk = new PayPalCommerceSdk(getScriptLoader());\n\n    return new GooglePayPaypalCommercePaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayPaypalCommerceGateway(paymentIntegrationService, payPalCommerceSdk),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n        payPalCommerceSdk,\n        createRequestSender(),\n    );\n};\n\nexport default toResolvableModule(createGooglePayPayPalCommercePaymentStrategy, [\n    { id: 'googlepaypaypalcommerce' },\n]);\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    BigCommercePaymentsInitializationData,\n    FundingType,\n    PayPalFastlaneSdk,\n    PayPalGooglePaySdk,\n    PayPalHostWindow,\n    PayPalMessagesSdk,\n    PayPalSdkConfig,\n} from './bigcommerce-payments-types';\n\nexport default class PayPalSdkHelper {\n    private window: PayPalHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async getPayPalFastlaneSdk(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): Promise<PayPalFastlaneSdk> {\n        if (!this.window.paypalFastlaneSdk) {\n            const config = this.getPayPalFastlaneSdkConfiguration(\n                paymentMethod,\n                currencyCode,\n                sessionId,\n            );\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalFastlaneSdk) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalFastlaneSdk;\n    }\n\n    async getPayPalGooglePaySdk(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalGooglePaySdk> {\n        if (!this.window.paypalGooglePay || forceLoad) {\n            const paypalSdkScriptConfig = this.getPayPalGooglePaySdkScriptConfigOrThrow(\n                paymentMethod,\n                currencyCode,\n                initializesOnCheckoutPage,\n            );\n\n            await this.loadPayPalSdk(paypalSdkScriptConfig);\n        }\n\n        if (!this.window.paypalGooglePay) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalGooglePay;\n    }\n\n    async getPayPalApmsSdk(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ) {\n        if (!this.window.paypalApms) {\n            const config = this.getPayPalApmSdkConfiguration(paymentMethod, currencyCode);\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalApms) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalApms;\n    }\n\n    async getPayPalMessages(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ): Promise<PayPalMessagesSdk> {\n        if (!this.window.paypalMessages) {\n            const paypalSdkMessagesConfig = this.getPayPalSdkMessagesConfiguration(\n                paymentMethod,\n                currencyCode,\n            );\n\n            await this.loadPayPalSdk(paypalSdkMessagesConfig);\n        }\n\n        if (!this.window.paypalMessages) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalMessages;\n    }\n\n    /**\n     *\n     *  loadPayPalSdk is a paypal sdk script loader\n     *  which loads paypal sdk based on provided configuration\n     *\n     */\n    private async loadPayPalSdk({ options, attributes }: PayPalSdkConfig): Promise<void> {\n        const scriptOptions = this.transformConfig<PayPalSdkConfig['options']>(options);\n        const scriptAttributes = this.transformConfig<PayPalSdkConfig['attributes']>(attributes);\n\n        const paypalSdkUrl = 'https://www.paypal.com/sdk/js';\n        const scriptQuery = new URLSearchParams(scriptOptions).toString();\n        const scriptSrc = `${paypalSdkUrl}?${scriptQuery}`;\n\n        await this.scriptLoader.loadScript(scriptSrc, {\n            async: true,\n            attributes: scriptAttributes,\n        });\n    }\n\n    /**\n     *\n     * Configurations section\n     *\n     */\n    private getPayPalFastlaneSdkConfiguration(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { intent, clientId, merchantId, attributionId } = initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit: true,\n                components: ['fastlane', 'three-domain-secure'],\n                currency: currencyCode,\n                intent,\n            },\n            attributes: {\n                'data-client-metadata-id': sessionId.replace(/-/g, ''),\n                'data-namespace': 'paypalFastlaneSdk',\n                'data-partner-attribution-id': attributionId,\n                'data-sdk-client-token': clientToken,\n            },\n        };\n    }\n\n    private getPayPalGooglePaySdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isHostedCheckoutEnabled,\n            isDeveloperModeApplicable,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit,\n                components: ['googlepay'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n                'data-namespace': 'paypalGooglePay',\n            },\n        };\n    }\n\n    private getPayPalApmSdkConfiguration(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n        } = initializationData;\n\n        const enableAPMsFunding = this.filterFundingOptions(enabledAlternativePaymentMethods);\n        const disableAPMsFunding = this.filterFundingOptions(\n            availableAlternativePaymentMethods.filter(\n                (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n            ),\n        );\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableAPMsFunding.length > 0 ? enableAPMsFunding : undefined,\n                'disable-funding': disableAPMsFunding.length > 0 ? disableAPMsFunding : undefined,\n                commit: true,\n                components: ['buttons', 'payment-fields'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-namespace': 'paypalApms',\n            },\n        };\n    }\n\n    private getPayPalSdkMessagesConfiguration(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { clientId, merchantId, attributionId, isDeveloperModeApplicable, buyerCountry } =\n            initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                components: ['messages'],\n                currency: currencyCode,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-namespace': 'paypalMessages',\n                'data-partner-attribution-id': attributionId,\n            },\n        };\n    }\n\n    /**\n     *\n     * Utils methods\n     *\n     */\n    private filterFundingOptions(fundingOptions: FundingType[] | undefined): FundingType[] {\n        const fundingTypesToBeFiltered = ['klarna', 'afterpay'];\n\n        if (!fundingOptions) {\n            return [];\n        }\n\n        return fundingOptions.filter(\n            (fundingOption: FundingType) => !fundingTypesToBeFiltered.includes(fundingOption),\n        );\n    }\n\n    private transformConfig<T extends Record<string, unknown>>(config: T): Record<string, string> {\n        let transformedConfig = {};\n\n        const keys = Object.keys(config) as Array<keyof T>;\n\n        keys.forEach((key) => {\n            const value = config[key];\n\n            if (\n                value === undefined ||\n                value === null ||\n                value === '' ||\n                (Array.isArray(value) && value.length === 0)\n            ) {\n                return;\n            }\n\n            transformedConfig = {\n                ...transformedConfig,\n                [key]: Array.isArray(value) ? value.join(',') : value,\n            };\n        });\n\n        return transformedConfig;\n    }\n}\n","import { GooglePayConfig } from '../types';\n\nexport type FundingType = string;\n\n/**\n *\n * BigCommercePayments SDK\n *\n */\nexport interface PayPalSDK {\n    Googlepay: () => {\n        config: () => Promise<GooglePayConfig>;\n        confirmOrder: (confirmOrderConfig: ConfirmOrderConfig) => Promise<{ status: string }>;\n        initiatePayerAction: (payerActionConfig: PayerActionConfig) => Promise<void>;\n    };\n}\n\ninterface ConfirmOrderConfig {\n    orderId: string;\n    paymentMethodData: ConfirmOrderData;\n}\n\ninterface PayerActionConfig {\n    orderId: string;\n}\n\nexport enum ConfirmOrderStatus {\n    Approved = 'APPROVED',\n    PayerActionRequired = 'PAYER_ACTION_REQUIRED',\n}\n\nexport interface BigCommercePaymentsHostWindow extends Window {\n    paypal?: PayPalSDK;\n}\n\nexport interface BigCommercePaymentsScriptParams {\n    options: {\n        'client-id'?: string;\n        'merchant-id'?: string;\n        'buyer-country'?: string;\n        'disable-funding'?: FundingType[];\n        'enable-funding'?: FundingType[];\n        currency?: string;\n        commit?: boolean;\n        intent?: BigCommercePaymentsIntent;\n        components?: ComponentsScriptType;\n    };\n    attributes: {\n        'data-client-token'?: string;\n        'data-partner-attribution-id'?: string;\n    };\n}\n\nexport enum BigCommercePaymentsIntent {\n    AUTHORIZE = 'authorize',\n    CAPTURE = 'capture',\n}\n\nexport type ComponentsScriptType = Array<\n    | 'buttons'\n    | 'funding-eligibility'\n    | 'hosted-fields'\n    | 'messages'\n    | 'payment-fields'\n    | 'legal'\n    | 'googlepay'\n    | 'card-fields'\n>;\n\nexport interface PayPalGoogleSdk {\n    version: string;\n    getCorrelationID: () => void;\n    Googlepay: () => {\n        config: () => Promise<GooglePayConfig>;\n        confirmOrder: (arg0: {\n            orderId: string;\n            paymentMethodData: ConfirmOrderData;\n        }) => Promise<{ status: string }>;\n        initiatePayerAction: () => void;\n    };\n    FUNDING: Record<string, string>;\n}\n\nexport interface ConfirmOrderData {\n    tokenizationData: {\n        type: string;\n        token: string;\n    };\n    info: {\n        cardNetwork: string;\n        cardDetails: string;\n    };\n    type: string;\n}\n","import {\n    BigCommercePaymentsInitializationData,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    PaymentMethod,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayGateway from '../gateways/google-pay-gateway';\nimport assertsIsGooglePayPayPalCommercePaymentMethod from '../guards/is-google-pay-paypal-commerce-payment-method';\nimport {\n    GooglePayCardDataResponse,\n    GooglePayConfig,\n    GooglePayPayPalCommerceGatewayParameters,\n    GooglePayPayPalCommerceInitializationData,\n    GooglePaySetExternalCheckoutData,\n} from '../types';\n\nexport default class GooglePayBigCommercePaymentsGateway extends GooglePayGateway {\n    private googlepayConfig?: GooglePayConfig;\n    private service: PaymentIntegrationService;\n\n    constructor(service: PaymentIntegrationService, private payPalSdkHelper: PayPalSdkHelper) {\n        super('googlepay_bigcommerce_payments', service);\n\n        this.service = service;\n    }\n\n    async initialize(\n        getPaymentMethod: () => PaymentMethod<GooglePayPayPalCommerceInitializationData>,\n        isBuyNowFlow?: boolean,\n        currencyCode?: string,\n    ): Promise<void> {\n        const currency = this.service.getState().getStoreConfig()?.currency.code ?? currencyCode;\n\n        if (!currency) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        await super.initialize(getPaymentMethod, isBuyNowFlow, currency);\n\n        const paymentMethod = super.getPaymentMethod();\n\n        if (!paymentMethod.initializationData) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        assertsIsGooglePayPayPalCommercePaymentMethod(paymentMethod);\n\n        const googlePaySdk = await this.payPalSdkHelper.getPayPalGooglePaySdk(\n            paymentMethod as PaymentMethod<BigCommercePaymentsInitializationData>,\n            currency,\n        );\n\n        this.googlepayConfig = await googlePaySdk.Googlepay().config();\n\n        const { allowedPaymentMethods } = this.googlepayConfig;\n\n        this.setGatewayIdentifier(\n            allowedPaymentMethods[0]?.tokenizationSpecification?.parameters?.gateway,\n        );\n    }\n\n    getPaymentGatewayParameters(): GooglePayPayPalCommerceGatewayParameters {\n        if (this.googlepayConfig) {\n            const { allowedPaymentMethods } = this.googlepayConfig;\n            const { gatewayMerchantId } =\n                allowedPaymentMethods[0].tokenizationSpecification.parameters;\n\n            return {\n                gateway: this.getGatewayIdentifier(),\n                gatewayMerchantId,\n            };\n        }\n\n        return {\n            gateway: this.getGatewayIdentifier(),\n        };\n    }\n\n    async mapToExternalCheckoutData(\n        response: GooglePayCardDataResponse,\n    ): Promise<GooglePaySetExternalCheckoutData> {\n        const data = await super.mapToExternalCheckoutData(response);\n\n        data.nonce = btoa(data.nonce);\n\n        return data;\n    }\n}\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    BigCommercePaymentsInitializationData,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    ContentType,\n    INTERNAL_USE_ONLY,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentIntegrationService,\n    PaymentMethod,\n    SDK_VERSION_HEADERS,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../google-pay-payment-strategy';\nimport {\n    GooglePayBigCommercePaymentsInitializationData,\n    GooglePayInitializationData,\n} from '../types';\n\nimport { ConfirmOrderData, ConfirmOrderStatus } from './types';\n\nexport default class GooglePayBigCommercePaymentsPaymentStrategy extends GooglePayPaymentStrategy {\n    constructor(\n        _paymentIntegrationService: PaymentIntegrationService,\n        _googlePayPaymentProcessor: GooglePayPaymentProcessor,\n        private _payPalSdkHelper: PayPalSdkHelper,\n        private _requestSender: RequestSender,\n    ) {\n        super(_paymentIntegrationService, _googlePayPaymentProcessor);\n    }\n\n    async execute({ payment }: OrderRequestBody): Promise<void> {\n        if (!payment?.methodId) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const state = this._paymentIntegrationService.getState();\n        const cartId = state.getCartOrThrow().id;\n        const { initializationData } = state.getPaymentMethodOrThrow<GooglePayInitializationData>(\n            this._getMethodId(),\n        );\n        const { orderId } = await this.getOrderId(cartId);\n\n        const { card_information } = initializationData || {};\n        const nonce = await this._googlePayPaymentProcessor.getNonce(payment.methodId);\n\n        const confirmOrderData = {\n            tokenizationData: {\n                type: 'PAYMENT_GATEWAY',\n                token: atob(nonce),\n            },\n            info: {\n                cardNetwork: card_information?.type || '',\n                cardDetails: card_information?.number || '',\n            },\n            type: 'CARD',\n        };\n\n        await this.confirmOrder(orderId, confirmOrderData);\n        await this._paymentIntegrationService.submitOrder();\n\n        try {\n            const paymentData = {\n                formattedPayload: {\n                    method_id: payment.methodId,\n                    paypal_account: {\n                        order_id: orderId,\n                    },\n                },\n            };\n\n            await this._paymentIntegrationService.submitPayment({\n                methodId: payment.methodId,\n                paymentData,\n            });\n        } catch (error) {\n            await this._googlePayPaymentProcessor.processAdditionalAction(error);\n        }\n    }\n\n    private async confirmOrder(orderId: string, confirmOrderData: ConfirmOrderData) {\n        const state = this._paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<GooglePayBigCommercePaymentsInitializationData>(\n                this._getMethodId(),\n            );\n\n        if (!paymentMethod.initializationData) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const currencyCode = state.getCartOrThrow().currency.code;\n\n        const payPalSDK = await this._payPalSdkHelper.getPayPalGooglePaySdk(\n            paymentMethod as PaymentMethod<BigCommercePaymentsInitializationData>,\n            currencyCode,\n            true,\n        );\n\n        const { status } = await payPalSDK\n            .Googlepay()\n            .confirmOrder({ orderId, paymentMethodData: confirmOrderData });\n\n        if (status === ConfirmOrderStatus.PayerActionRequired) {\n            await payPalSDK.Googlepay().initiatePayerAction({ orderId });\n\n            return Promise.resolve();\n        }\n\n        if (status !== ConfirmOrderStatus.Approved) {\n            throw new InvalidArgumentError('Payment is not approved.');\n        }\n\n        return Promise.resolve();\n    }\n\n    private async getOrderId(cartId: string): Promise<{ orderId: string }> {\n        const url = '/api/storefront/payments/googlepay_bigcommerce_paymentscheckout';\n        const requestData = {\n            cartId,\n            shouldSaveInstrument: false,\n        };\n\n        const { body } = await this._requestSender.post<{ orderId: string }>(url, {\n            headers: {\n                'X-API-INTERNAL': INTERNAL_USE_ONLY,\n                'Content-Type': ContentType.Json,\n                ...SDK_VERSION_HEADERS,\n            },\n            body: requestData,\n        });\n\n        return body;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PayPalSdkHelper } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../google-pay-payment-strategy';\n\nimport GooglePayBigCommercePaymentsGateway from './google-pay-bigcommerce-payments-gateway';\nimport GooglePayBigCommercePaymentsPaymentStrategy from './google-pay-bigcommerce-payments-payment-strategy';\n\nconst createGooglePayBigCommercePaymentsPaymentStrategy: PaymentStrategyFactory<\n    GooglePayPaymentStrategy\n> = (paymentIntegrationService) => {\n    const payPalSdkHelper = new PayPalSdkHelper(getScriptLoader());\n\n    return new GooglePayBigCommercePaymentsPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayBigCommercePaymentsGateway(paymentIntegrationService, payPalSdkHelper),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n        payPalSdkHelper,\n        createRequestSender(),\n    );\n};\n\nexport default toResolvableModule(createGooglePayBigCommercePaymentsPaymentStrategy, [\n    { id: 'googlepay_bigcommerce_payments' },\n]);\n","import { FormPoster } from '@bigcommerce/form-poster';\n\nimport {\n    getBrowserInfo,\n    PaymentArgumentInvalidError,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { isTdOnlineMartAdditionalAction } from '../guards/is-google-pay-td-online-mart-additional-action';\nimport { ExtraPaymentData, TdOnlineMartThreeDSErrorBody } from '../types';\n\nimport GooglePayGateway from './google-pay-gateway';\n\nexport default class GooglePayTdOnlineMartGateway extends GooglePayGateway {\n    constructor(service: PaymentIntegrationService, private formPoster: FormPoster) {\n        super('worldlinena', service);\n    }\n\n    async extraPaymentData(): Promise<ExtraPaymentData> {\n        return Promise.resolve({ browser_info: getBrowserInfo() });\n    }\n\n    async processAdditionalAction(error: unknown): Promise<void> {\n        if (!isTdOnlineMartAdditionalAction(error)) {\n            throw error;\n        }\n\n        const { three_ds_result: threeDSResult }: TdOnlineMartThreeDSErrorBody = error.body;\n        const {\n            acs_url: formUrl,\n            payer_auth_request: threeDSSessionData,\n            merchant_data: creq,\n        } = threeDSResult || {};\n\n        if (!formUrl || !threeDSSessionData || !creq) {\n            throw new PaymentArgumentInvalidError(['formUrl', 'threeDSSessionData', 'creq']);\n        }\n\n        return new Promise((resolve) => {\n            this.formPoster.postForm(\n                formUrl,\n                {\n                    threeDSSessionData,\n                    creq,\n                },\n                resolve,\n                '_top',\n            );\n        });\n    }\n}\n","import { isArray, isObject, some } from 'lodash';\n\nimport { isRequestError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { TdOnlineMartAdditionalAction, TdOnlineMartThreeDSErrorBody } from '../types';\n\nfunction isTdOnlineMartThreeDSErrorBody(\n    errorBody: unknown,\n): errorBody is TdOnlineMartThreeDSErrorBody {\n    return (\n        isObject(errorBody) &&\n        typeof errorBody === 'object' &&\n        'errors' in errorBody &&\n        'three_ds_result' in errorBody &&\n        isArray((errorBody as TdOnlineMartThreeDSErrorBody).errors) &&\n        some((errorBody as TdOnlineMartThreeDSErrorBody).errors, {\n            code: 'three_d_secure_required',\n        })\n    );\n}\n\nexport function isTdOnlineMartAdditionalAction(\n    error: unknown,\n): error is TdOnlineMartAdditionalAction {\n    return isRequestError(error) && isTdOnlineMartThreeDSErrorBody(error.body);\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayTdOnlineMartGateway from '../../gateways/google-pay-tdonlinemart-gateway';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport GooglePayPaymentStrategy from '../../google-pay-payment-strategy';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayTdOnlineMartPaymentStrategy: PaymentStrategyFactory<\n    GooglePayPaymentStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayPaymentStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayTdOnlineMartGateway(paymentIntegrationService, createFormPoster()),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayTdOnlineMartPaymentStrategy, [\n    { id: 'googlepaytdonlinemart' },\n]);\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we try to call a method that is only a stub and has not\n * been fully implemented.\n */\nexport default class NotImplementedError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Not implemented.');\n\n        this.name = 'NotImplementedError';\n        this.type = 'not_implemented';\n    }\n}\n","import {\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    ExecutePaymentMethodCheckoutOptions,\n    guard,\n    InvalidArgumentError,\n    NotImplementedError,\n    NotInitializedError,\n    NotInitializedErrorType,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentMethodCancelledError,\n    PaymentMethodFailedError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCustomerInitializeOptions, {\n    WithGooglePayCustomerInitializeOptions,\n} from './google-pay-customer-initialize-options';\nimport GooglePayPaymentProcessor from './google-pay-payment-processor';\nimport isGooglePayErrorObject from './guards/is-google-pay-error-object';\nimport isGooglePayKey from './guards/is-google-pay-key';\nimport {\n    GooglePayError,\n    GooglePayInitializationData,\n    GooglePayPaymentOptions,\n    TotalPriceStatusType,\n} from './types';\n\nexport default class GooglePayCustomerStrategy implements CustomerStrategy {\n    private _paymentButton?: HTMLElement;\n    private _methodId?: keyof WithGooglePayCustomerInitializeOptions;\n\n    constructor(\n        private _paymentIntegrationService: PaymentIntegrationService,\n        private _googlePayPaymentProcessor: GooglePayPaymentProcessor,\n    ) {}\n\n    async initialize(\n        options?: CustomerInitializeOptions & WithGooglePayCustomerInitializeOptions,\n    ): Promise<void> {\n        if (!options?.methodId || !isGooglePayKey(options.methodId)) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"methodId\" is not a valid key.',\n            );\n        }\n\n        this._methodId = options.methodId;\n\n        const googlePayOptions = options[this._getMethodId()];\n\n        if (!googlePayOptions) {\n            throw new InvalidArgumentError('Unable to proceed without valid options.');\n        }\n\n        let state = this._paymentIntegrationService.getState();\n        let paymentMethod: PaymentMethod<GooglePayInitializationData>;\n\n        try {\n            paymentMethod = state.getPaymentMethodOrThrow(this._getMethodId());\n        } catch (_e) {\n            state = await this._paymentIntegrationService.loadPaymentMethod(this._getMethodId());\n            paymentMethod = state.getPaymentMethodOrThrow(this._getMethodId());\n        }\n\n        try {\n            await this._googlePayPaymentProcessor.initialize(\n                () => paymentMethod,\n                this._getGooglePayClientOptions(paymentMethod.initializationData?.storeCountry),\n            );\n        } catch {\n            return;\n        }\n\n        this._addPaymentButton(googlePayOptions);\n    }\n\n    signIn(): Promise<void> {\n        return Promise.reject(\n            new NotImplementedError(\n                'In order to sign in via Google Pay, the shopper must click on \"Google Pay\" button.',\n            ),\n        );\n    }\n\n    async signOut(): Promise<void> {\n        const providerId = this._paymentIntegrationService.getState().getPaymentId()?.providerId;\n\n        if (providerId) {\n            await this._googlePayPaymentProcessor.signOut(providerId);\n        }\n    }\n\n    executePaymentMethodCheckout(options?: ExecutePaymentMethodCheckoutOptions): Promise<void> {\n        options?.continueWithCheckoutCallback?.();\n\n        return Promise.resolve();\n    }\n\n    deinitialize(): Promise<void> {\n        this._paymentButton?.remove();\n        this._paymentButton = undefined;\n        this._methodId = undefined;\n\n        return Promise.resolve();\n    }\n\n    private _getGooglePayClientOptions(countryCode?: string): GooglePayPaymentOptions {\n        return {\n            paymentDataCallbacks: {\n                onPaymentDataChanged: async ({\n                    callbackTrigger,\n                    shippingAddress,\n                    shippingOptionData,\n                    offerData,\n                }) => {\n                    const {\n                        availableTriggers,\n                        addressChangeTriggers,\n                        shippingOptionsChangeTriggers,\n                        offerChangeTriggers,\n                    } = this._googlePayPaymentProcessor.getCallbackTriggers();\n\n                    if (!availableTriggers.includes(callbackTrigger)) {\n                        return;\n                    }\n\n                    const availableShippingOptions = addressChangeTriggers.includes(callbackTrigger)\n                        ? await this._googlePayPaymentProcessor.handleShippingAddressChange(\n                              shippingAddress,\n                          )\n                        : undefined;\n\n                    if (shippingOptionsChangeTriggers.includes(callbackTrigger)) {\n                        await this._googlePayPaymentProcessor.handleShippingOptionChange(\n                            shippingOptionData.id,\n                        );\n                    }\n\n                    const { newOfferInfo = undefined, error: couponsError = undefined } =\n                        offerChangeTriggers.includes(callbackTrigger)\n                            ? await this._googlePayPaymentProcessor.handleCoupons(offerData)\n                            : {};\n\n                    // We can add another errors if needed 'couponsError || shippingError || anotherError'\n                    const error: GooglePayError | undefined = couponsError;\n\n                    await this._paymentIntegrationService.loadCheckout();\n\n                    const totalPrice = this._googlePayPaymentProcessor.getTotalPrice();\n                    const { code: currencyCode } = this._paymentIntegrationService\n                        .getState()\n                        .getCartOrThrow().currency;\n\n                    return {\n                        newTransactionInfo: {\n                            ...(countryCode && { countryCode }),\n                            currencyCode,\n                            totalPriceStatus: TotalPriceStatusType.FINAL,\n                            totalPrice,\n                        },\n                        ...(availableShippingOptions && {\n                            newShippingOptionParameters: availableShippingOptions,\n                        }),\n                        ...(newOfferInfo && {\n                            newOfferInfo,\n                        }),\n                        ...(error && {\n                            error,\n                        }),\n                    };\n                },\n            },\n        };\n    }\n\n    private _addPaymentButton({\n        container,\n        buttonColor,\n        buttonType,\n        onClick,\n        onError,\n    }: GooglePayCustomerInitializeOptions): void {\n        this._paymentButton =\n            this._paymentButton ??\n            this._googlePayPaymentProcessor.addPaymentButton(container, {\n                buttonColor: buttonColor ?? 'default',\n                buttonType: buttonType ?? 'plain',\n                onClick: this._handleClick(onError, onClick),\n            });\n    }\n\n    private _handleClick(\n        onError: GooglePayCustomerInitializeOptions['onError'],\n        onClick: GooglePayCustomerInitializeOptions['onClick'],\n    ): (event: MouseEvent) => Promise<void> {\n        return async (event: MouseEvent) => {\n            event.preventDefault();\n\n            if (onClick && typeof onClick === 'function') {\n                onClick();\n            }\n\n            // TODO: Dispatch Widget Actions\n            try {\n                await this._googlePayPaymentProcessor.initializeWidget();\n                await this._interactWithPaymentSheet();\n            } catch (error) {\n                let err: unknown = error;\n\n                if (isGooglePayErrorObject(error)) {\n                    if (error.statusCode === 'CANCELED') {\n                        throw new PaymentMethodCancelledError();\n                    }\n\n                    err = new PaymentMethodFailedError(JSON.stringify(error));\n                }\n\n                onError?.(\n                    new PaymentMethodFailedError(\n                        'An error occurred while requesting your Google Pay payment details.',\n                    ),\n                );\n\n                throw err;\n            }\n        };\n    }\n\n    private async _interactWithPaymentSheet(): Promise<void> {\n        const response = await this._googlePayPaymentProcessor.showPaymentSheet();\n        const billingAddress =\n            this._googlePayPaymentProcessor.mapToBillingAddressRequestBody(response);\n        const shippingAddress =\n            this._googlePayPaymentProcessor.mapToShippingAddressRequestBody(response);\n\n        const siteLink =\n            window.location.pathname === '/embedded-checkout'\n                ? this._paymentIntegrationService.getState().getStoreConfigOrThrow().links.siteLink\n                : undefined;\n\n        if (billingAddress) {\n            await this._paymentIntegrationService.updateBillingAddress(billingAddress);\n        }\n\n        if (shippingAddress) {\n            await this._paymentIntegrationService.updateShippingAddress(shippingAddress);\n        }\n\n        await this._googlePayPaymentProcessor.setExternalCheckoutForm(\n            this._getMethodId(),\n            response,\n            siteLink,\n        );\n    }\n\n    private _getMethodId(): keyof WithGooglePayCustomerInitializeOptions {\n        return guard(\n            this._methodId,\n            () => new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n        );\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayGateway from '../../gateways/google-pay-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAdyenV2CustomerStrategy: CustomerStrategyFactory<GooglePayCustomerStrategy> = (\n    paymentIntegrationService,\n) => {\n    const requestSender = createRequestSender();\n\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayGateway('adyen', paymentIntegrationService),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayAdyenV2CustomerStrategy, [\n    { id: 'googlepayadyenv2' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayGateway from '../../gateways/google-pay-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAdyenV3CustomerStrategy: CustomerStrategyFactory<GooglePayCustomerStrategy> = (\n    paymentIntegrationService,\n) => {\n    const requestSender = createRequestSender();\n\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayGateway('adyen', paymentIntegrationService),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayAdyenV3CustomerStrategy, [\n    { id: 'googlepayadyenv3' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayAuthorizeNetGateway from '../../gateways/google-pay-authorizenet-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAuthorizeDotNetCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayAuthorizeNetGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayAuthorizeDotNetCustomerStrategy, [\n    { id: 'googlepayauthorizenet' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCheckoutComGateway from '../../gateways/google-pay-checkoutcom-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayCheckoutComCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    const requestSender = createRequestSender();\n\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayCheckoutComGateway(paymentIntegrationService, requestSender),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayCheckoutComCustomerStrategy, [\n    { id: 'googlepaycheckoutcom' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCybersourceGateway from '../../gateways/google-pay-cybersource-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayCybersourceCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayCybersourceGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayCybersourceCustomerStrategy, [\n    { id: 'googlepaycybersourcev2' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCybersourceGateway from '../../gateways/google-pay-cybersource-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayBnzCustomerStrategy: CustomerStrategyFactory<GooglePayCustomerStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayCybersourceGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayBnzCustomerStrategy, [{ id: 'googlepaybnz' }]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayOrbitalGateway from '../../gateways/google-pay-orbital-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayOrbitalCustomerStrategy: CustomerStrategyFactory<GooglePayCustomerStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayOrbitalGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayOrbitalCustomerStrategy, [\n    { id: 'googlepayorbital' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { StripeScriptLoader } from '@bigcommerce/checkout-sdk/stripe-utils';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayCustomerStrategy from '../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\n\nimport GooglePayStripeGateway from './google-pay-stripe-gateway';\n\nconst createGooglePayStripeCustomerStrategy: CustomerStrategyFactory<GooglePayCustomerStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayStripeGateway(\n                paymentIntegrationService,\n                new StripeScriptLoader(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayStripeCustomerStrategy, [\n    { id: 'googlepaystripe' },\n    { id: 'googlepaystripeocs' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { StripeScriptLoader } from '@bigcommerce/checkout-sdk/stripe-utils';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayCustomerStrategy from '../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\n\nimport GooglePayStripeGateway from './google-pay-stripe-gateway';\n\nconst createGooglePayStripeUpeCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayStripeGateway(\n                paymentIntegrationService,\n                new StripeScriptLoader(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayStripeUpeCustomerStrategy, [\n    { id: 'googlepaystripeupe' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayWorldpayAccessGateway from '../../gateways/google-pay-worldpayaccess-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayWorldpayAccessCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayWorldpayAccessGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayWorldpayAccessCustomerStrategy, [\n    { id: 'googlepayworldpayaccess' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    BraintreeHostWindow,\n    BraintreeScriptLoader,\n    BraintreeSdk,\n    BraintreeSDKVersionManager,\n} from '@bigcommerce/checkout-sdk/braintree-utils';\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayBraintreeGateway from '../../gateways/google-pay-braintree-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayBraintreePaymentStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    const requestSender = createRequestSender();\n\n    const braintreeHostWindow: BraintreeHostWindow = window;\n    const braintreeSDKVersionManager = new BraintreeSDKVersionManager(paymentIntegrationService);\n    const braintreeSdk = new BraintreeSdk(\n        new BraintreeScriptLoader(\n            getScriptLoader(),\n            braintreeHostWindow,\n            braintreeSDKVersionManager,\n        ),\n    );\n\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayBraintreeGateway(paymentIntegrationService, braintreeSdk),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayBraintreePaymentStrategy, [\n    { id: 'googlepaybraintree' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { PayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayCustomerStrategy from '../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\n\nimport GooglePayPaypalCommerceGateway from './google-pay-paypal-commerce-gateway';\n\nconst createGooglePayPayPalCommerceCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayPaypalCommerceGateway(\n                paymentIntegrationService,\n                new PayPalCommerceSdk(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayPayPalCommerceCustomerStrategy, [\n    { id: 'googlepaypaypalcommerce' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PayPalSdkHelper } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayCustomerStrategy from '../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\n\nimport GooglePayBigCommercePaymentsGateway from './google-pay-bigcommerce-payments-gateway';\n\nconst createGooglePayBigCommercePaymentsCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayBigCommercePaymentsGateway(\n                paymentIntegrationService,\n                new PayPalSdkHelper(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayBigCommercePaymentsCustomerStrategy, [\n    { id: 'googlepay_bigcommerce_payments' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayTdOnlineMartGateway from '../../gateways/google-pay-tdonlinemart-gateway';\nimport GooglePayCustomerStrategy from '../../google-pay-customer-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayTdOnlineMartCustomerStrategy: CustomerStrategyFactory<\n    GooglePayCustomerStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayCustomerStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayTdOnlineMartGateway(paymentIntegrationService, createFormPoster()),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayTdOnlineMartCustomerStrategy, [\n    { id: 'googlepaytdonlinemart' },\n]);\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a shopper tries to sign in as a guest but\n * they are already signed in as a registered customer.\n */\nexport default class BuyNowCartCreationError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'An unexpected error has occurred during buy now cart creation process. Please try again later.',\n        );\n\n        this.name = 'BuyNowCartCreationError';\n        this.type = 'buy_now_cart_creation_error';\n    }\n}\n","import {\n    BuyNowCartCreationError,\n    Cart,\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    guard,\n    InvalidArgumentError,\n    NotInitializedError,\n    NotInitializedErrorType,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentMethodCancelledError,\n    PaymentMethodFailedError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithGooglePayButtonInitializeOptions } from './google-pay-button-initialize-option';\nimport GooglePayCustomerInitializeOptions from './google-pay-customer-initialize-options';\nimport { WithGooglePayPaymentInitializeOptions } from './google-pay-payment-initialize-options';\nimport GooglePayPaymentProcessor from './google-pay-payment-processor';\nimport isGooglePayErrorObject from './guards/is-google-pay-error-object';\nimport isGooglePayKey from './guards/is-google-pay-key';\nimport {\n    GooglePayBuyNowInitializeOptions,\n    GooglePayError,\n    GooglePayInitializationData,\n    GooglePayPaymentDataRequest,\n    GooglePayPaymentOptions,\n    ShippingOptionParameters,\n    TotalPriceStatusType,\n} from './types';\n\nexport default class GooglePayButtonStrategy implements CheckoutButtonStrategy {\n    private _paymentButton?: HTMLElement;\n    private _methodId?: keyof WithGooglePayPaymentInitializeOptions;\n    private _buyNowCart?: Cart;\n    private _currencyCode?: string;\n    private _buyNowInitializeOptions?: GooglePayBuyNowInitializeOptions;\n    private _countryCode?: string;\n\n    constructor(\n        private _paymentIntegrationService: PaymentIntegrationService,\n        private _googlePayPaymentProcessor: GooglePayPaymentProcessor,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions & WithGooglePayButtonInitializeOptions,\n    ): Promise<void> {\n        if (!options.methodId || !isGooglePayKey(options.methodId)) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"methodId\" is not a valid key.',\n            );\n        }\n\n        this._methodId = options.methodId;\n\n        if (!options.containerId) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"containerId\" is not a valid key.',\n            );\n        }\n\n        const googlePayOptions = options[this._getMethodOrThrow()];\n\n        if (!googlePayOptions) {\n            throw new InvalidArgumentError('Unable to proceed without valid options.');\n        }\n\n        const { buyNowInitializeOptions, currencyCode, buttonColor, buttonType, onError } =\n            googlePayOptions;\n\n        let state = this._paymentIntegrationService.getState();\n        let paymentMethod: PaymentMethod<GooglePayInitializationData>;\n\n        try {\n            paymentMethod = state.getPaymentMethodOrThrow(this._getMethodOrThrow());\n        } catch (_e) {\n            state = await this._paymentIntegrationService.loadPaymentMethod(\n                this._getMethodOrThrow(),\n            );\n            paymentMethod = state.getPaymentMethodOrThrow(this._getMethodOrThrow());\n        }\n\n        this._countryCode = paymentMethod.initializationData?.storeCountry;\n\n        if (buyNowInitializeOptions) {\n            if (!currencyCode) {\n                throw new InvalidArgumentError(\n                    `Unable to initialize payment because \"options.currencyCode\" argument is not provided.`,\n                );\n            }\n\n            this._currencyCode = currencyCode;\n            this._buyNowInitializeOptions = buyNowInitializeOptions;\n\n            await this._googlePayPaymentProcessor.initialize(\n                () => paymentMethod,\n                this._getGooglePayClientOptions(),\n                !!buyNowInitializeOptions,\n                currencyCode,\n            );\n        } else {\n            await this._paymentIntegrationService.loadDefaultCheckout();\n            await this._googlePayPaymentProcessor.initialize(\n                () => paymentMethod,\n                this._getGooglePayClientOptions(),\n            );\n        }\n\n        this._paymentButton =\n            this._paymentButton ??\n            this._googlePayPaymentProcessor.addPaymentButton(options.containerId, {\n                buttonColor: buttonColor ?? 'default',\n                buttonType: buttonType ?? 'plain',\n                onClick: this._handleClick(onError),\n            });\n    }\n\n    deinitialize(): Promise<void> {\n        this._paymentButton?.remove();\n        this._paymentButton = undefined;\n        this._methodId = undefined;\n\n        return Promise.resolve();\n    }\n\n    private _handleClick(\n        onError: GooglePayCustomerInitializeOptions['onError'],\n    ): (event: MouseEvent) => Promise<void> {\n        return async (event: MouseEvent) => {\n            event.preventDefault();\n\n            try {\n                if (this._buyNowInitializeOptions) {\n                    await this._createBuyNowCartOrThrow(this._buyNowInitializeOptions);\n                } else {\n                    await this._paymentIntegrationService.loadDefaultCheckout();\n                }\n\n                await this._googlePayPaymentProcessor.initializeWidget();\n                await this._interactWithPaymentSheet();\n            } catch (error) {\n                let err: unknown = error;\n\n                if (isGooglePayErrorObject(error)) {\n                    if (error.statusCode === 'CANCELED') {\n                        throw new PaymentMethodCancelledError();\n                    }\n\n                    err = new PaymentMethodFailedError(JSON.stringify(error));\n                }\n\n                onError?.(\n                    new PaymentMethodFailedError(\n                        'An error occurred while requesting your Google Pay payment details.',\n                    ),\n                );\n\n                throw err;\n            }\n        };\n    }\n\n    private async _interactWithPaymentSheet(): Promise<void> {\n        const response = await this._googlePayPaymentProcessor.showPaymentSheet();\n        const billingAddress =\n            this._googlePayPaymentProcessor.mapToBillingAddressRequestBody(response);\n        const shippingAddress =\n            this._googlePayPaymentProcessor.mapToShippingAddressRequestBody(response);\n        const siteLink =\n            window.location.pathname === '/embedded-checkout'\n                ? this._paymentIntegrationService.getState().getStoreConfigOrThrow().links.siteLink\n                : undefined;\n\n        if (billingAddress) {\n            await this._paymentIntegrationService.updateBillingAddress(billingAddress);\n        }\n\n        if (shippingAddress && !this._buyNowCart?.lineItems.digitalItems.length) {\n            await this._paymentIntegrationService.updateShippingAddress(shippingAddress);\n        }\n\n        await this._googlePayPaymentProcessor.setExternalCheckoutForm(\n            this._getMethodOrThrow(),\n            response,\n            siteLink,\n        );\n    }\n\n    private _getGooglePayClientOptions(): GooglePayPaymentOptions | undefined {\n        return {\n            paymentDataCallbacks: {\n                onPaymentDataChanged: async ({\n                    callbackTrigger,\n                    shippingAddress,\n                    shippingOptionData,\n                    offerData,\n                }) => {\n                    const {\n                        availableTriggers,\n                        addressChangeTriggers,\n                        shippingOptionsChangeTriggers,\n                        offerChangeTriggers,\n                    } = this._googlePayPaymentProcessor.getCallbackTriggers();\n\n                    if (!availableTriggers.includes(callbackTrigger)) {\n                        return;\n                    }\n\n                    const availableShippingOptions = addressChangeTriggers.includes(callbackTrigger)\n                        ? await this._googlePayPaymentProcessor.handleShippingAddressChange(\n                              shippingAddress,\n                          )\n                        : undefined;\n\n                    if (shippingOptionsChangeTriggers.includes(callbackTrigger)) {\n                        await this._googlePayPaymentProcessor.handleShippingOptionChange(\n                            shippingOptionData.id,\n                        );\n                    }\n\n                    const { newOfferInfo = undefined, error: couponsError = undefined } =\n                        offerChangeTriggers.includes(callbackTrigger)\n                            ? await this._googlePayPaymentProcessor.handleCoupons(offerData)\n                            : {};\n\n                    // We can add another errors if needed 'couponsError || shippingError || anotherError'\n                    const error: GooglePayError | undefined = couponsError;\n\n                    if (this._buyNowInitializeOptions) {\n                        return this._getBuyNowTransactionInfo(\n                            availableShippingOptions,\n                            newOfferInfo,\n                            error,\n                        );\n                    }\n\n                    return this._getTransactionInfo(availableShippingOptions, newOfferInfo, error);\n                },\n            },\n        };\n    }\n\n    private async _createBuyNowCartOrThrow(\n        buyNowInitializeOptions?: GooglePayBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (typeof buyNowInitializeOptions?.getBuyNowCartRequestBody === 'function') {\n            const cartRequestBody = buyNowInitializeOptions.getBuyNowCartRequestBody();\n\n            try {\n                this._buyNowCart = await this._paymentIntegrationService.createBuyNowCart(\n                    cartRequestBody,\n                );\n\n                await this._paymentIntegrationService.loadCheckout(this._buyNowCart.id);\n            } catch (error) {\n                if (typeof error === 'string') {\n                    throw new BuyNowCartCreationError(error);\n                }\n\n                throw error;\n            }\n        }\n    }\n\n    private _getBuyNowTransactionInfo(\n        availableShippingOptions?: ShippingOptionParameters,\n        newOfferInfo?: GooglePayPaymentDataRequest['offerInfo'],\n        error?: GooglePayError,\n    ) {\n        if (!this._buyNowCart) {\n            return;\n        }\n\n        const { cartAmount } = this._buyNowCart;\n\n        const totalPrice = this._googlePayPaymentProcessor.getTotalPrice();\n\n        return {\n            newTransactionInfo: {\n                ...(this._countryCode && { countryCode: this._countryCode }),\n                currencyCode: this._getCurrencyCodeOrThrow(),\n                totalPrice: totalPrice || String(cartAmount),\n                totalPriceStatus: TotalPriceStatusType.FINAL,\n            },\n            ...(availableShippingOptions && {\n                newShippingOptionParameters: availableShippingOptions,\n            }),\n            ...(newOfferInfo && {\n                newOfferInfo,\n            }),\n            ...(error && {\n                error,\n            }),\n        };\n    }\n\n    private async _getTransactionInfo(\n        availableShippingOptions?: ShippingOptionParameters,\n        newOfferInfo?: GooglePayPaymentDataRequest['offerInfo'],\n        error?: GooglePayError,\n    ) {\n        await this._paymentIntegrationService.loadCheckout();\n\n        const totalPrice = this._googlePayPaymentProcessor.getTotalPrice();\n        const { code: currencyCode } = this._paymentIntegrationService\n            .getState()\n            .getCartOrThrow().currency;\n\n        return {\n            newTransactionInfo: {\n                ...(this._countryCode && { countryCode: this._countryCode }),\n                currencyCode,\n                totalPriceStatus: TotalPriceStatusType.FINAL,\n                totalPrice,\n            },\n            ...(availableShippingOptions && {\n                newShippingOptionParameters: availableShippingOptions,\n            }),\n            ...(newOfferInfo && {\n                newOfferInfo,\n            }),\n            ...(error && {\n                error,\n            }),\n        };\n    }\n\n    private _getMethodOrThrow(): keyof WithGooglePayButtonInitializeOptions {\n        return guard(\n            this._methodId,\n            () => new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n        );\n    }\n\n    private _getCurrencyCodeOrThrow(): string {\n        return guard(\n            this._currencyCode,\n            () =>\n                new InvalidArgumentError(\n                    'Unable to initialize payment because \"options.currencyCode\" argument is not provided.',\n                ),\n        );\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    BraintreeHostWindow,\n    BraintreeScriptLoader,\n    BraintreeSdk,\n    BraintreeSDKVersionManager,\n} from '@bigcommerce/checkout-sdk/braintree-utils';\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayBraintreeGateway from '../../gateways/google-pay-braintree-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayBraintreeButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) => {\n    const requestSender = createRequestSender();\n\n    const braintreeHostWindow: BraintreeHostWindow = window;\n    const braintreeSDKVersionManager = new BraintreeSDKVersionManager(paymentIntegrationService);\n    const braintreeSdk = new BraintreeSdk(\n        new BraintreeScriptLoader(\n            getScriptLoader(),\n            braintreeHostWindow,\n            braintreeSDKVersionManager,\n        ),\n    );\n\n    return new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayBraintreeGateway(paymentIntegrationService, braintreeSdk),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayBraintreeButtonStrategy, [\n    { id: 'googlepaybraintree' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { PayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayButtonStrategy from '../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\n\nimport GooglePayPaypalCommerceGateway from './google-pay-paypal-commerce-gateway';\n\nconst createGooglePayPayPalCommerceButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayPaypalCommerceGateway(\n                paymentIntegrationService,\n                new PayPalCommerceSdk(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayPayPalCommerceButtonStrategy, [\n    { id: 'googlepaypaypalcommerce' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PayPalSdkHelper } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayButtonStrategy from '../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\n\nimport GooglePayBigCommercePaymentsGateway from './google-pay-bigcommerce-payments-gateway';\n\nconst createGooglePayBigCommercePaymentsButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) => {\n    return new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayBigCommercePaymentsGateway(\n                paymentIntegrationService,\n                new PayPalSdkHelper(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayBigCommercePaymentsButtonStrategy, [\n    { id: 'googlepay_bigcommerce_payments' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayGateway from '../../gateways/google-pay-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAdyenV2ButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) => {\n    const requestSender = createRequestSender();\n\n    return new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayGateway('adyen', paymentIntegrationService),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayAdyenV2ButtonStrategy, [\n    { id: 'googlepayadyenv2' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayGateway from '../../gateways/google-pay-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAdyenV3ButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) => {\n    const requestSender = createRequestSender();\n\n    return new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayGateway('adyen', paymentIntegrationService),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayAdyenV3ButtonStrategy, [\n    { id: 'googlepayadyenv3' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayAuthorizeNetGateway from '../../gateways/google-pay-authorizenet-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayAuthorizeNetButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayAuthorizeNetGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayAuthorizeNetButtonStrategy, [\n    { id: 'googlepayauthorizenet' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCheckoutComGateway from '../../gateways/google-pay-checkoutcom-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayCheckoutComButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) => {\n    const requestSender = createRequestSender();\n\n    return new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayCheckoutComGateway(paymentIntegrationService, requestSender),\n            requestSender,\n            createFormPoster(),\n        ),\n    );\n};\n\nexport default toResolvableModule(createGooglePayCheckoutComButtonStrategy, [\n    { id: 'googlepaycheckoutcom' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayCybersourceGateway from '../../gateways/google-pay-cybersource-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayCybersourceButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayCybersourceGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayCybersourceButtonStrategy, [\n    { id: 'googlepaycybersourcev2' },\n    { id: 'googlepaybnz' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayOrbitalGateway from '../../gateways/google-pay-orbital-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayOrbitalButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayOrbitalGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayOrbitalButtonStrategy, [\n    { id: 'googlepayorbital' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { StripeScriptLoader } from '@bigcommerce/checkout-sdk/stripe-utils';\n\nimport createGooglePayScriptLoader from '../factories/create-google-pay-script-loader';\nimport GooglePayButtonStrategy from '../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../google-pay-payment-processor';\n\nimport GooglePayStripeGateway from './google-pay-stripe-gateway';\n\nconst createGooglePayStripeButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayStripeGateway(\n                paymentIntegrationService,\n                new StripeScriptLoader(getScriptLoader()),\n            ),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayStripeButtonStrategy, [\n    { id: 'googlepaystripe' },\n    { id: 'googlepaystripeupe' },\n    { id: 'googlepaystripeocs' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayWorldpayAccessGateway from '../../gateways/google-pay-worldpayaccess-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayWorldpayAccessButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayWorldpayAccessGateway(paymentIntegrationService),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayWorldpayAccessButtonStrategy, [\n    { id: 'googlepayworldpayaccess' },\n]);\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport GooglePayTdOnlineMartGateway from '../../gateways/google-pay-tdonlinemart-gateway';\nimport GooglePayButtonStrategy from '../../google-pay-button-strategy';\nimport GooglePayPaymentProcessor from '../../google-pay-payment-processor';\nimport createGooglePayScriptLoader from '../create-google-pay-script-loader';\n\nconst createGooglePayTdOnlineMartButtonStrategy: CheckoutButtonStrategyFactory<\n    GooglePayButtonStrategy\n> = (paymentIntegrationService) =>\n    new GooglePayButtonStrategy(\n        paymentIntegrationService,\n        new GooglePayPaymentProcessor(\n            createGooglePayScriptLoader(),\n            new GooglePayTdOnlineMartGateway(paymentIntegrationService, createFormPoster()),\n            createRequestSender(),\n            createFormPoster(),\n        ),\n    );\n\nexport default toResolvableModule(createGooglePayTdOnlineMartButtonStrategy, [\n    { id: 'googlepaytdonlinemart' },\n]);\n"],"names":["MissingDataErrorType","StandardError","Error","constructor","message","prototype","super","name","type","Object","setPrototypeOf","this","__proto__","captureStackTrace","stack","PaymentMethodClientUnavailableError","AdyenV2ScriptLoader","_scriptLoader","_stylesheetLoader","_window","window","load","configuration","Promise","all","loadStylesheet","environment","prepend","attributes","integrity","crossorigin","loadScript","async","AdyenCheckout","toResolvableModule","module","resolveIds","assign","isAdditionalActionRequiredErrorResponse","param","Array","isArray","errors","code","provider_data","MissingBillingAddress","MissingCart","MissingCheckout","MissingConsignments","MissingCustomer","MissingCheckoutConfig","MissingOrder","MissingOrderConfig","MissingOrderId","MissingPayment","MissingPaymentId","MissingPaymentInstrument","MissingPaymentMethod","MissingPaymentRedirectUrl","MissingPaymentStatus","MissingPaymentToken","MissingShippingAddress","MissingDataError","subtype","getBrowserInfo","navigator","language","userLanguage","color_depth","screen","colorDepth","java_enabled","javaEnabled","screen_height","height","screen_width","width","time_zone_offset","Date","getTimezoneOffset","toString","error","PaymentMethodCancelledError","NotInitializedErrorType","CheckoutButtonNotInitialized","CustomerNotInitialized","PaymentNotInitialized","ShippingNotInitialized","SpamProtectionNotInitialized","NotInitializedError","InvalidArgumentError","bindMethodDecorator","_","key","descriptor","value","method","get","boundMethod","bind","defineProperty","set","CurrencyFormatter","currencySettings","decimalPlaces","symbolLocation","symbol","thousandsSeparator","decimalSeparator","_decimalPlaces","parseInt","_symbolLocation","_symbol","_thousandsSeparator","_decimalSeparator","format","amount","formattedNumber","_formatNumber","formattedCurrency","_formatCurrency","positiveAmount","Math","abs","integerAmount","decimalAmount","_toFixed","split","parsedIntegerAmount","replace","join","toLowerCase","precision","round","toFixed","CurrencyService","_storeConfig","_customerFormatter","shopperCurrency","_storeFormatter","currency","toCustomerCurrency","exchangeRate","toStoreCurrency","target","decoratedTarget","getOwnPropertyNames","forEach","getOwnPropertyDescriptor","guard","errorFactory","isExperimentEnabled","features","experimentName","fallbackValue","PayPalCommerceIntent","StyleButtonLabel","StyleButtonColor","StyleButtonShape","TotalPriceStatusType","GooglePayCardNetwork","CallbackIntentsType","ErrorReasonType","CallbackTriggerType","isGooglePayCardNetworkKey","card","AUTHORIZE","CAPTURE","paypal","checkout","buynow","pay","installment","gold","blue","silver","black","white","pill","rect","ESTIMATED","FINAL","NOT_CURRENTLY_KNOWN","AMEX","DISCOVER","INTERAC","JCB","MC","VISA","OFFER","PAYMENT_AUTHORIZATION","SHIPPING_ADDRESS","SHIPPING_OPTION","OFFER_INVALID","PAYMENT_DATA_INVALID","SHIPPING_ADDRESS_INVALID","SHIPPING_ADDRESS_UNSERVICEABLE","SHIPPING_OPTION_INVALID","OTHER_ERROR","INITIALIZE","GooglePayGateway","_gatewayIdentifier","_paymentIntegrationService","_isBuyNowFlow","_shouldRequestShipping","mapToShippingAddressRequestBody","shippingAddress","company","phone","getState","getShippingAddress","_mapToAddressRequestBody","mapToBillingAddressRequestBody","response","billingAddress","paymentMethodData","info","email","customFields","getBillingAddress","mapToExternalCheckoutData","tokenizationData","token","nonce","cardNetwork","cardDetails","number","resolve","card_information","cart_id","t","getCart","id","getRequiredData","data","emailRequired","_isShippingAddressRequired","state","loadShippingCountries","allowedCountryCodes","getShippingCountries","map","country","shippingAddressRequired","shippingAddressParameters","phoneNumberRequired","shippingOptionRequired","getCallbackIntents","getCallbackTriggers","availableTriggers","initializationTrigger","addressChangeTriggers","shippingOptionsChangeTriggers","offerChangeTriggers","getNonce","methodId","getPaymentMethodOrThrow","initializationData","extraPaymentData","getMerchantInfo","googleMerchantName","merchantName","googleMerchantId","merchantId","platformToken","authJwt","getGooglePayInitializationData","getTransactionInfo","currencyCode","_getCurrencyCodeOrThrow","getCartOrThrow","countryCode","storeCountry","totalPriceStatus","totalPrice","getPaymentGatewayParameters","gatewayMerchantId","gateway","getCardParameters","allowedAuthMethods","allowedCardNetworks","getPaymentMethod","supportedCards","filter","billingAddressRequired","billingAddressParameters","initialize","isBuyNowFlow","_getPaymentMethodFn","Boolean","_currencyCode","handleShippingAddressChange","address1","mappedShippingAddress","updateShippingAddress","consignments","getConsignments","consignment","storeConfig","getStoreConfigOrThrow","_currencyService","availableShippingOptions","_getGooglePayShippingOption","recommendedShippingOption","find","shippingOption","isRecommended","length","selectedShippingOptionId","selectedShippingOption","handleShippingOptionChange","defaultSelectedOptionId","shippingOptions","optionId","selectShippingOption","getTotalPrice","getCheckoutOrThrow","outstandingBalance","handleCoupons","offerData","redemptionCodes","newCouponsState","offers","appliedCoupons","getAppliedCoupons","reduce","promise","some","redemptionCode","appliedCouponError","applyCoupon","coupon","includes","removeCoupon","newOfferInfo","coupons","getCheckout","displayName","description","e","reason","intent","setShouldRequestShipping","isRequired","getGatewayIdentifier","setGatewayIdentifier","shippingContextRequiresCheck","checkoutSettings","config","cart","lineItems","physicalItems","lineItem","isShippingRequired","customItems","address","address2","address3","locality","city","administrativeArea","stateOrProvinceCode","postalCode","phoneNumber","firstName","lastName","_getFirstAndLastName","trim","stateOrProvince","fullName","nameParts","slice","cost","additionalDescription","formattedCost","label","GooglePayAdyenV2","service","_service","paymentMethod","getStoreConfig","_adyenClient","testMode","locale","storeProfile","storeLanguage","JSON","stringify","googlePayToken","browser_info","processAdditionalAction","body","payment","_handleAction","submitPayment","additionalAction","reject","adyenAction","parse","action","_getAdyenClient","createFromAction","onAdditionalDetails","additionalActionState","paymentPayload","paymentMethodType","paymentData","size","onError","mount","SDK_VERSION_HEADERS","PaymentMethodFailedError","GooglePayPaymentProcessor","_gateway","_requestSender","_formPoster","_baseRequest","apiVersion","apiVersionMinor","googlePayPaymentOptions","_paymentsClient","getGooglePaymentsClient","_buildButtonPayloads","initializeWidget","_buildWidgetPayloads","_determineReadinessToPay","_prefetchGooglePaymentData","addPaymentButton","containerId","options","container","document","querySelector","paymentButton","_getPaymentsClient","createButton","allowedPaymentMethods","_getBaseCardPaymentMethod","appendChild","showPaymentSheet","paymentDataRequest","_getPaymentDataRequest","loadPaymentData","setExternalCheckoutXhr","provider","_setExternalCheckout","setExternalCheckoutForm","siteLink","signOut","providerId","useFormPoster","url","postForm","post","headers","Accept","transactionInfo","prefetchPaymentData","result","isReadyToPay","_getIsReadyToPayRequest","_baseCardPaymentMethod","parameters","baseCardPaymentMethod","_cardPaymentMethod","tokenizationSpecification","_paymentDataRequest","merchantInfo","callbackIntents","offerInfo","_isReadyToPayRequest","_getOrThrow","PaymentArgumentInvalidError","invalidFields","OrderFinalizationNotRequiredError","DEFAULT_STYLES","color","backgroundColor","DEFAULT_CONTAINER_STYLES","position","ROTATION_ANIMATION","LoadingIndicator","styles","containerStyles","defineAnimation","buildContainer","indicator","buildIndicator","show","parentId","parent","getElementById","style","visibility","opacity","hide","handleTransitionEnd","removeEventListener","addEventListener","createElement","display","bottom","left","right","top","transition","setStyleAttribute","borderRadius","border","borderColor","margin","transform","transformStyle","animation","element","attrs","keys","k","setProperty","head","sheet","CSSStyleSheet","insertRule","isGooglePayErrorObject","GooglePayKey","isGooglePayKey","values","ADYEN_V2","ADYEN_V3","AUTHORIZE_NET","BNZ","BRAINTREE","PAYPAL_COMMERCE","BIGCOMMERCE_PAYMENTS","CHECKOUT_COM","CYBERSOURCE_V2","ORBITAL","STRIPE","STRIPE_UPE","STRIPE_OCS","WORLDPAY_ACCESS","TD_ONLINE_MART","GooglePayPaymentStrategy","_googlePayPaymentProcessor","_isDeinitializationBlocked","_loadingIndicator","_methodId","googlePayOptions","_getMethodId","walletButton","loadingContainerId","callbacks","_loadingIndicatorContainer","loadPaymentMethod","_getGooglePayClientOptions","_addPaymentButton","execute","submitOrder","extraData","finalize","deinitialize","_clickListener","_paymentButton","_handleClick","onPaymentSelect","event","preventDefault","_interactWithPaymentSheet","err","_toggleLoadingIndicator","statusCode","_toggleBlockDeinitialization","updateBillingAddress","loadCheckout","_getIsSignedInOrThrow","_handleOfferTrigger","isSignedIn","errorMessage","paymentDataCallbacks","onPaymentDataChanged","callbackTrigger","couponsError","newTransactionInfo","isBlocked","isLoading","GooglePayScriptLoader","google","payments","api","PaymentsClient","createGooglePayScriptLoader","getScriptLoader","paymentIntegrationService","getStylesheetLoader","createRequestSender","createFormPoster","AdyenV3ScriptLoader","GooglePayAdyenV3","GooglePayAuthorizeNetGateway","btoa","paymentGatewayId","ContentType","Json","JsonV1","assertIsGooglePayCheckoutComInitializationData","GooglePayCheckoutComGateway","_resolve","threeDSBody","three_ds_result","acs_url","location","_tokenize","checkoutcomkey","token_data","credentials","Authorization","requestSender","GooglePayCybersourceGateway","GooglePayOrbitalGateway","StripeFormMode","StripeDisplayName","StripeLoadActionsResultType","StripePaymentMethodType","StripeStringConstants","StripeJsVersion","StripeElementType","StripePaymentIntentStatus","StripeElementEvent","StripeInstrumentSetupFutureUsage","SHIPPING","BILLING","SPLIT","FULL","ORGANIZATION","SUCCESS","ERROR","CreditCard","Link","EPS","GRABPAY","BANCONTACT","IDEAL","ALIPAY","KLARNA","OCS","NEVER","AUTO","ALWAYS","PAYMENT","IF_REQUIRED","V3","ACACIA","BASIL","CLOVER","AUTHENTICATION","EXPRESS_CHECKOUT","REQUIRES_PAYMENT_METHOD","REQUIRES_CONFIRMATION","REQUIRES_ACTION","PROCESSING","SUCCEEDED","CANCELED","CLICK","CHANGE","READY","SHIPPING_ADDRESS_CHANGE","SHIPPING_RATE_CHANGE","CONFIRM","CANCEL","LOADER_START","ON_SESSION","OFF_SESSION","StripeScriptLoader","scriptLoader","stripeWindow","getStripeClient","stripeJsVersion","betas","bcStripeClient","stripe","stripePublishableKey","stripeConnectedAccount","stripeClient","stripeAccount","getElements","stripeElements","bcStripeElements","updateStripeElements","elements","update","fetchUpdates","getCheckoutSession","stripeCheckoutSession","bcStripeCheckoutSession","initCheckout","Stripe","getScriptUrl","DEFAULT_RESPONSE","status","RequestError","STRIPE_UPE_CLIENT_BETAS","assertsIsGooglePayStripeInitializationData","GooglePayStripeGateway","stripeVersion","initialization","stripeUPEClient","loadStripeJs","clientSecret","catchedConfirmError","confirmCardPayment","retrievePaymentIntent","__","_throwDisplayableStripeError","_isCancellationError","paymentIntent","getCartLocale","useNewStripeJsVersion","stripeError","payment_intent","last_payment_error","indexOf","GooglePayWorldpayAccessGateway","BRAINTREE_SDK_HOSTED_FIELDS_FIX_VERSION","BRAINTREE_SDK_DEFAULT_VERSION","BRAINTREE_SDK_STABLE_VERSION","BraintreeSDKVersionManager","braintreeWindow","getSDKVersion","getPreloadedSDKVersion","braintree","preloadedVersion","VERSION","UnsupportedBrowserError","BraintreeOrderStatus","NonInstantLocalPaymentMethods","BraintreeFastlaneAuthenticationState","BraintreeErrorType","BraintreeErrorCode","BraintreeSupportedCardBrands","Completed","Pending","Failed","TRUSTLY","FAILED","UNRECOGNIZED","Customer","Merchant","Network","Internal","Unknown","KountNotEnabled","Visa","Mastercard","AmericanExpress","DinersClub","Discover","Jcb","UnionPay","Maestro","Elo","Mir","Hiper","Hipercard","BraintreeEnv","BraintreeModuleName","BraintreeFormFieldType","BraintreeSdk","braintreeScriptLoader","clientToken","setClientToken","teardownModule","dataCollector","getClient","client","getClientTokenOrThrow","clientCreator","loadClient","create","authorization","getDataCollectorOrThrow","emptyDataCollector","deviceData","teardown","loadDataCollector","dataCollectorConfig","kount","getBraintreeGooglePayment","googlePayment","braintreeGooglePayment","loadGooglePayment","getBraintreeThreeDS","threeDS","threeDSecure","load3DS","version","getBraintreeLocalPayment","merchantAccountId","braintreeLocalPayment","localPaymentCreator","loadLocalPayment","getUsBankAccount","usBankAccount","loadUsBankAccount","getBraintreeVisaCheckout","visaCheckout","loadVisaCheckout","then","getVisaCheckoutSdk","visaCheckoutSDK","loadVisaCheckoutSdk","getVenmoCheckoutOrThrow","braintreeVenmo","venmoCheckout","loadVenmoCheckout","venmoCheckoutConfig","allowDesktop","paymentMethodUsage","braintreeVenmoCheckout","isBrowserSupported","Sandbox","Production","Client","DataCollector","Fastlane","GooglePayment","HostedFields","LocalPayment","Paypal","PaypalCheckout","ThreeDSecure","UsBankAccount","Venmo","VisaCheckout","CardCode","CardCodeVerification","CardExpiry","CardName","CardNumber","CardNumberVerification","BRAINTREE_SDK_SCRIPTS_INTEGRITY","BraintreeScriptLoader","braintreeHostWindow","braintreeSDKVersionManager","loadBraintreeModuleOrThrow","loadFastlane","loadPaypalCheckout","loadPaypal","loadHostedFields","V","hash","braintreeModuleName","fileName","getBraintreeModule","braintreeSdkVersion","scriptPath","getIntegrityValuesByModuleName","moduleName","CancellablePromise","cancellable","cancel","race","GooglePayBraintreeGateway","_braintreeSdk","_braintreeGooglePayment","bin","isThreeDSecureEnabled","isNetworkTokenized","orderAmount","getOrderOrThrow","_braintreePresent3DSChallenge","deviceSessionId","_getBraintreeDeviceData","androidPayCards","details","createPaymentDataRequest","cardRequirements","billingAddressFormat","paymentMethodTokenizationParameters","verifyCard","onLookupComplete","_data","next","braintreeSdk","PayPalCommerceSdk","getPayPalFastlaneSdk","sessionId","paypalFastlaneSdk","getPayPalFastlaneSdkConfiguration","loadPayPalSdk","getPayPalGooglePaySdk","initializesOnCheckoutPage","forceLoad","paypalGooglePay","paypalSdkScriptConfig","getPayPalGooglePaySdkScriptConfigOrThrow","getPayPalApmsSdk","paypalApms","getPayPalApmSdkConfiguration","getPayPalMessages","paypalMessages","paypalSdkMessagesConfig","getPayPalSdkMessagesConfiguration","scriptOptions","transformConfig","scriptAttributes","scriptSrc","URLSearchParams","clientId","attributionId","commit","components","buyerCountry","isHostedCheckoutEnabled","isDeveloperModeApplicable","availableAlternativePaymentMethods","enabledAlternativePaymentMethods","enableAPMsFunding","disableAPMsFunding","apm","transformedConfig","assertsIsGooglePayPayPalCommercePaymentMethod","GooglePayPaypalCommerceGateway","payPalCommerceSdk","googlePaySdk","googlepayConfig","Googlepay","INTERNAL_USE_ONLY","ConfirmOrderStatus","Approved","PayerActionRequired","GooglePayPaypalCommercePaymentStrategy","_payPalCommerceSdk","cartId","orderId","getOrderId","confirmOrderData","atob","confirmOrder","formattedPayload","method_id","paypal_account","order_id","payPalSDK","initiatePayerAction","requestData","shouldSaveInstrument","PayPalSdkHelper","filterFundingOptions","fundingOptions","fundingTypesToBeFiltered","fundingOption","BigCommercePaymentsIntent","GooglePayBigCommercePaymentsGateway","payPalSdkHelper","GooglePayBigCommercePaymentsPaymentStrategy","_payPalSdkHelper","GooglePayTdOnlineMartGateway","formPoster","errorBody","isObject","threeDSResult","formUrl","payer_auth_request","threeDSSessionData","merchant_data","creq","NotImplementedError","GooglePayCustomerStrategy","_e","signIn","getPaymentId","executePaymentMethodCheckout","continueWithCheckoutCallback","remove","shippingOptionData","newShippingOptionParameters","buttonColor","buttonType","onClick","pathname","links","BuyNowCartCreationError","GooglePayButtonStrategy","_getMethodOrThrow","buyNowInitializeOptions","_countryCode","_buyNowInitializeOptions","loadDefaultCheckout","_createBuyNowCartOrThrow","_buyNowCart","digitalItems","_getBuyNowTransactionInfo","_getTransactionInfo","getBuyNowCartRequestBody","cartRequestBody","createBuyNowCart","cartAmount","String"],"sourceRoot":""}