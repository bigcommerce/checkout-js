{"version":3,"file":"8345-2d756101.js","mappings":"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","sources":["webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/missing-data-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-initialized-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/standard-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/set-prototype-of.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/invalid-argument-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-argument-invalid-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/order-finalization-not-completed-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/clearpay-integration/src/clearpay-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/is-request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-client-unavailable-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/clearpay-integration/src/clearpay-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/clearpay-integration/src/create-clearpay-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/to-resolvable-module.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/order-finalization-not-required-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/payment-status-types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/credit-card-integration/src/credit-card-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/browser-info/get-browser-info.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/sagepay-integration/src/sage-pay-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/sagepay-integration/src/create-sage-pay-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/webpack/bootstrap","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-hosted-intrument-like.ts","webpack://checkout/@bigcommerce/checkout-sdk/webpack/runtime/define property getters","webpack://checkout/@bigcommerce/checkout-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://checkout/@bigcommerce/checkout-sdk/./packages/offsite-integration/src/offsite-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-vaulted-instrument.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/offsite-integration/src/create-offsite-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-failed-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cba-mpgs-integration/src/cba-mpgs-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cba-mpgs-integration/src/is-cba-mpgs-payment-method-like.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cba-mpgs-integration/src/cba-mpgs.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cba-mpgs-integration/src/cba-mpgs-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/cba-mpgs-integration/src/create-cba-mpgs-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-express-integration/src/paypal-express-types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-express-integration/src/paypal-express-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-express-integration/src/paypal-express-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-express-integration/src/create-paypal-express-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/internal-api-headers.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/sdk-version-headers.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-express-integration/src/paypal-express-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-express-integration/src/create-paypal-express-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-custom-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-sepa/checkoutcom-fawry-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-sepa/create-checkoutcom-fawry-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/isThreeDSecureRequiredError.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-credit-card-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/create-checkoutcom-credit-card-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-sepa/checkoutcom-sepa-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-sepa/create-checkoutcom-sepa-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-ideal/checkoutcom-ideal-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-ideal/create-checkoutcom-ideal-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-apm/checkoutcom-apm-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/checkoutcom-custom-integration/src/checkoutcom-apm/create-checkoutcom-apm-payment-strategy.ts"],"sourcesContent":["import StandardError from './standard-error';\n\nexport enum MissingDataErrorType {\n    MissingBillingAddress,\n    MissingCart,\n    MissingCheckout,\n    MissingConsignments,\n    MissingCustomer,\n    MissingCheckoutConfig,\n    MissingOrder,\n    MissingOrderConfig,\n    MissingOrderId,\n    MissingPayment,\n    MissingPaymentId,\n    MissingPaymentInstrument,\n    MissingPaymentMethod,\n    MissingPaymentRedirectUrl,\n    MissingPaymentStatus,\n    MissingPaymentToken,\n    MissingShippingAddress,\n}\n\n/**\n * Throw this error when data that is expected to exist is missing. Usually it\n * is due to the fact that certain data has not been retrieved from or saved to\n * the server yet. And such data is required to perform certain actions.\n */\nexport default class MissingDataError extends StandardError {\n    constructor(public subtype: MissingDataErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'MissingDataError';\n        this.type = 'missing_data';\n    }\n}\n\nfunction getErrorMessage(type: MissingDataErrorType): string {\n    switch (type) {\n        case MissingDataErrorType.MissingBillingAddress:\n            return 'Unable to proceed because billing address data is unavailable.';\n\n        case MissingDataErrorType.MissingCart:\n            return 'Unable to proceed because cart data is unavailable.';\n\n        case MissingDataErrorType.MissingConsignments:\n            return 'Unable to proceed because consignments data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckout:\n            return 'Unable to proceed because checkout data is unavailable.';\n\n        case MissingDataErrorType.MissingCustomer:\n            return 'Unable to proceed because customer data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckoutConfig:\n        case MissingDataErrorType.MissingOrderConfig:\n            return 'Unable to proceed because configuration data is unavailable.';\n\n        case MissingDataErrorType.MissingOrder:\n            return 'Unable to proceed because order data is unavailable.';\n\n        case MissingDataErrorType.MissingOrderId:\n            return 'Unable to proceed because order ID is unavailable or not generated yet.';\n\n        case MissingDataErrorType.MissingPayment:\n            return 'Unable to proceed because payment data is unavailable.';\n\n        case MissingDataErrorType.MissingPaymentToken:\n            return 'Unable to proceed because the token required to submit a payment is missing.';\n\n        case MissingDataErrorType.MissingPaymentMethod:\n            return 'Unable to proceed because payment method data is unavailable or not properly configured.';\n\n        case MissingDataErrorType.MissingShippingAddress:\n            return 'Unable to proceed because shipping address data is unavailable.';\n\n        default:\n            return 'Unable to proceed because the required data is unavailable.';\n    }\n}\n","import StandardError from './standard-error';\n\nexport enum NotInitializedErrorType {\n    CheckoutButtonNotInitialized,\n    CustomerNotInitialized,\n    PaymentNotInitialized,\n    ShippingNotInitialized,\n    SpamProtectionNotInitialized,\n}\n\n/**\n * Throw this error if a method requires a certain initialization call to be\n * made first. Some objects can be constructed but they cannot be used until a\n * separate initialization call is made.\n */\nexport default class NotInitializedError extends StandardError {\n    constructor(public subtype: NotInitializedErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'NotInitializedError';\n        this.type = 'not_initialized';\n    }\n}\n\nfunction getErrorMessage(type: NotInitializedErrorType): string {\n    switch (type) {\n        case NotInitializedErrorType.CustomerNotInitialized:\n            return 'Unable to proceed because the customer step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.PaymentNotInitialized:\n            return 'Unable to proceed because the payment step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.ShippingNotInitialized:\n            return 'Unable to proceed because the shipping step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.SpamProtectionNotInitialized:\n            return 'Unable to proceed because the checkout spam protection has not been initialized.';\n\n        default:\n            return 'Unable to proceed because the required component has not been initialized.';\n    }\n}\n","import CustomError from './custom-error';\nimport setPrototypeOf from './set-prototype-of';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import InvalidArgumentError from './invalid-argument-error';\n\n/**\n * This error should be thrown when we are unable to submit a payment because\n * the caller has not provided all the required fields, i.e.: if an argument is\n * missing or it is not the expected data type.\n */\nexport default class PaymentArgumentInvalidError extends InvalidArgumentError {\n    constructor(invalidFields?: string[]) {\n        let message = 'Unable to submit payment for the order because the payload is invalid.';\n\n        if (invalidFields) {\n            message = `${message} Make sure the following fields are provided correctly: ${invalidFields.join(\n                ', ',\n            )}.`;\n        }\n\n        super(message);\n\n        this.name = 'PaymentArgumentInvalidError';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if the order finalization request\n * was not completed successfully.\n */\nexport default class OrderFinalizationNotCompletedError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'The current order could not be finalized successfully');\n\n        this.name = 'OrderFinalizationNotCompletedError';\n        this.type = 'order_finalization_not_completed';\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        {\n            message,\n            errors,\n        }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {},\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","import { noop } from 'lodash';\n\nimport {\n    InvalidArgumentError,\n    isRequestError,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotCompletedError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationSelectors,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    RequestError,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport ClearpayScriptLoader from './clearpay-script-loader';\nimport ClearpaySdk from './clearpay-sdk';\n\nexport default class ClearpayPaymentStrategy implements PaymentStrategy {\n    private _clearpaySdk?: ClearpaySdk;\n\n    constructor(\n        private _paymentIntegrationService: PaymentIntegrationService,\n        private _clearpayScriptLoader: ClearpayScriptLoader,\n    ) {}\n\n    async initialize(options: PaymentInitializeOptions): Promise<void> {\n        const { getPaymentMethodOrThrow } = this._paymentIntegrationService.getState();\n        const paymentMethod = getPaymentMethodOrThrow(options.methodId, options.gatewayId);\n\n        this._clearpaySdk = await this._clearpayScriptLoader.load(paymentMethod);\n    }\n\n    deinitialize(): Promise<void> {\n        this._clearpaySdk = undefined;\n\n        return Promise.resolve();\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { gatewayId, methodId } = payload.payment || {};\n\n        if (!gatewayId || !methodId) {\n            throw new PaymentArgumentInvalidError(['payment.gatewayId', 'payment.methodId']);\n        }\n\n        const state = this._paymentIntegrationService.getState();\n        const { isStoreCreditApplied: useStoreCredit } = state.getCheckoutOrThrow();\n\n        await this._paymentIntegrationService.applyStoreCredit(useStoreCredit);\n\n        await this._paymentIntegrationService.validateCheckout(state.getCheckout(), options);\n\n        const { countryCode } = state.getBillingAddressOrThrow();\n\n        if (!this._isCountrySupported(countryCode)) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because billing country is not supported.',\n            );\n        }\n\n        await this._loadPaymentMethod(gatewayId, methodId, options);\n\n        await this._redirectToClearpay(\n            countryCode,\n            this._paymentIntegrationService.getState().getPaymentMethod(methodId, gatewayId),\n        );\n\n        // Clearpay will handle the rest of the flow so return a promise that doesn't really resolve\n        return new Promise(noop);\n    }\n\n    async finalize(options: PaymentRequestOptions): Promise<void> {\n        const state = this._paymentIntegrationService.getState();\n        const payment = state.getPaymentId();\n        const config = state.getContextConfig();\n\n        if (!payment) {\n            throw new MissingDataError(MissingDataErrorType.MissingCheckout);\n        }\n\n        if (!config || !config.payment.token) {\n            throw new MissingDataError(MissingDataErrorType.MissingCheckoutConfig);\n        }\n\n        const paymentPayload = {\n            methodId: payment.providerId,\n            paymentData: { nonce: config.payment.token },\n        };\n\n        await this._paymentIntegrationService.submitOrder({}, options);\n\n        try {\n            await this._paymentIntegrationService.submitPayment(paymentPayload);\n        } catch (error) {\n            await this._paymentIntegrationService.forgetCheckout(payment.providerId);\n            await this._paymentIntegrationService.loadPaymentMethods();\n\n            if (isRequestError(error)) {\n                throw new OrderFinalizationNotCompletedError(error.body?.errors?.[0]?.message);\n            }\n        }\n    }\n\n    private async _redirectToClearpay(\n        countryCode: string,\n        paymentMethod?: PaymentMethod,\n    ): Promise<void> {\n        if (!this._clearpaySdk || !paymentMethod || !paymentMethod.clientToken) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        this._clearpaySdk.initialize({ countryCode });\n        this._clearpaySdk.redirect({ token: paymentMethod.clientToken });\n\n        return Promise.resolve();\n    }\n\n    private _isCountrySupported(countryCode: string): boolean {\n        return countryCode === 'GB';\n    }\n\n    private async _loadPaymentMethod(\n        gatewayId: string,\n        methodId: string,\n        options?: RequestOptions,\n    ): Promise<PaymentIntegrationSelectors> {\n        try {\n            return await this._paymentIntegrationService.loadPaymentMethod(gatewayId, {\n                ...options,\n                params: { ...options?.params, method: methodId },\n            });\n        } catch (error) {\n            if (error instanceof RequestError && error.body?.status === 422) {\n                throw new InvalidArgumentError(\n                    \"Clearpay can't process your payment for this order, please try another payment method\",\n                );\n            }\n\n            throw error;\n        }\n    }\n}\n","import RequestError from './request-error';\n\n// Have to use `as` https://stackoverflow.com/questions/73987044/typeguarding-an-unknown-nested-object should be fixed in 4.8+\nconst isRequestError = (error: unknown): error is RequestError => {\n    return typeof error === 'object' && error !== null && 'body' in error;\n};\n\nexport default isRequestError;\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when the client library of a payment method fails\n * to load, or for some reason, it is inaccessible.\n */\nexport default class PaymentMethodClientUnavailableError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method is not loaded or ready to be used.',\n        );\n\n        this.name = 'PaymentMethodClientUnavailableError';\n        this.type = 'payment_method_client_unavailable';\n    }\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport ClearpaySdk from './clearpay-sdk';\nimport ClearpayWindow from './clearpay-window';\n\nconst SCRIPTS_DEFAULT = {\n    PROD: '//portal.clearpay.co.uk/afterpay-async.js',\n    SANDBOX: '//portal.sandbox.clearpay.co.uk/afterpay-async.js',\n};\n\nexport default class ClearpayScriptLoader {\n    constructor(private _scriptLoader: ScriptLoader, public _window: ClearpayWindow = window) {}\n\n    async load(method: PaymentMethod): Promise<ClearpaySdk> {\n        await this._scriptLoader.loadScript(this._getScriptUrl(method.config.testMode));\n\n        if (!this._window.AfterPay) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this._window.AfterPay;\n    }\n\n    private _getScriptUrl(testMode?: boolean): string {\n        return testMode ? SCRIPTS_DEFAULT.SANDBOX : SCRIPTS_DEFAULT.PROD;\n    }\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport ClearpayPaymentStrategy from './clearpay-payment-strategy';\nimport ClearpayScriptLoader from './clearpay-script-loader';\n\nconst createClearpayPaymentStrategy: PaymentStrategyFactory<ClearpayPaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new ClearpayPaymentStrategy(\n        paymentIntegrationService,\n        new ClearpayScriptLoader(getScriptLoader()),\n    );\n};\n\nexport default toResolvableModule(createClearpayPaymentStrategy, [\n    { gateway: 'clearpay' },\n    { id: 'clearpay' },\n]);\n","import ResolvableModule from './resolvable-module';\n\nexport default function toResolvableModule<TModule, TIdentifier>(\n    module: TModule,\n    resolveIds: TIdentifier[],\n): ResolvableModule<TModule, TIdentifier> {\n    return Object.assign(module, { resolveIds });\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we are trying to make an order finalization request for a\n * payment method that does not require such procedure.\n */\nexport default class OrderFinalizationNotRequiredError extends StandardError {\n    constructor() {\n        super('The current order does not need to be finalized at this stage.');\n\n        this.name = 'OrderFinalizationNotRequiredError';\n        this.type = 'order_finalization_not_required';\n    }\n}\n","enum PaymentStatusTypes {\n    ACKNOWLEDGE = 'ACKNOWLEDGE',\n    FINALIZE = 'FINALIZE',\n    INITIALIZE = 'INITIALIZE',\n}\n\nexport default PaymentStatusTypes;\n","import { isNil, values } from 'lodash';\n\nimport {\n    HostedForm,\n    InvalidArgumentError,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithCreditCardPaymentInitializeOptions } from './credit-card-payment-initialize-options';\n\nexport default class CreditCardPaymentStrategy implements PaymentStrategy {\n    protected _hostedForm?: HostedForm;\n    protected _shouldRenderHostedForm?: boolean;\n\n    constructor(protected _paymentIntegrationService: PaymentIntegrationService) {}\n\n    execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        return this._isHostedPaymentFormEnabled(\n            payload.payment?.methodId,\n            payload.payment?.gatewayId,\n        ) && this._shouldRenderHostedForm\n            ? this._executeWithHostedForm(payload, options)\n            : this._executeWithoutHostedForm(payload, options);\n    }\n\n    initialize(\n        options?: PaymentInitializeOptions & WithCreditCardPaymentInitializeOptions,\n    ): Promise<void> {\n        if (\n            !this._isHostedPaymentFormEnabled(options?.methodId, options?.gatewayId) ||\n            !this._isHostedFieldAvailable(options)\n        ) {\n            this._shouldRenderHostedForm = false;\n\n            return Promise.resolve();\n        }\n\n        const formOptions = options && options.creditCard && options.creditCard.form;\n        const state = this._paymentIntegrationService.getState();\n        const { paymentSettings: { bigpayBaseUrl: host = '' } = {} } =\n            state.getStoreConfigOrThrow();\n\n        if (!formOptions) {\n            throw new InvalidArgumentError();\n        }\n\n        const form = this._paymentIntegrationService.createHostedForm(host, formOptions);\n\n        return form.attach().then(() => {\n            this._shouldRenderHostedForm = true;\n            this._hostedForm = form;\n\n            return Promise.resolve();\n        });\n    }\n\n    deinitialize(): Promise<void> {\n        if (this._hostedForm) {\n            this._hostedForm.detach();\n        }\n\n        return Promise.resolve();\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    protected async _executeWithoutHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const paymentData = payment && payment.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        await this._paymentIntegrationService.submitPayment({ ...payment, paymentData });\n    }\n\n    protected async _executeWithHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const form = this._hostedForm;\n\n        if (!form) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        if (!payment || !payment.methodId) {\n            throw new PaymentArgumentInvalidError(['payment.methodId']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        await form.validate().then(() => form.submit(payment));\n    }\n\n    protected _isHostedPaymentFormEnabled(methodId?: string, gatewayId?: string): boolean {\n        if (!methodId) {\n            return false;\n        }\n\n        const state = this._paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(methodId, gatewayId);\n\n        return paymentMethod.config.isHostedFormEnabled === true;\n    }\n\n    private _isHostedFieldAvailable(\n        options?: PaymentInitializeOptions & WithCreditCardPaymentInitializeOptions,\n    ): boolean {\n        return !values(options && options.creditCard && options.creditCard.form.fields).every(\n            isNil,\n        );\n    }\n}\n","import BrowserInfo from './browser-info';\n\nexport default function getBrowserInfo(): BrowserInfo {\n    const { navigator } = window;\n\n    let language: string;\n\n    if (navigator.language) {\n        language = navigator.language;\n    } else {\n        language = (navigator as any).userLanguage;\n    }\n\n    return {\n        color_depth: window.screen.colorDepth || 24,\n        java_enabled: typeof navigator.javaEnabled === 'function' ? navigator.javaEnabled() : false,\n        language,\n        screen_height: window.screen.height,\n        screen_width: window.screen.width,\n        time_zone_offset: new Date().getTimezoneOffset().toString(),\n    };\n}\n","import { FormPoster } from '@bigcommerce/form-poster';\nimport { some } from 'lodash';\n\nimport { CreditCardPaymentStrategy } from '@bigcommerce/checkout-sdk/credit-card-integration';\nimport {\n    getBrowserInfo,\n    isRequestError,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderRequestBody,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStatusTypes,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default class SagePayPaymentStrategy extends CreditCardPaymentStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private _formPoster: FormPoster,\n    ) {\n        super(paymentIntegrationService);\n    }\n\n    execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment } = payload;\n\n        if (!payment) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        const { paymentData } = payment;\n\n        if (!paymentData) {\n            throw new MissingDataError(MissingDataErrorType.MissingPayment);\n        }\n\n        if (this._isThreeDSTwoExperimentOn()) {\n            const newPaymentData = {\n                ...paymentData,\n                browser_info: getBrowserInfo(),\n            };\n\n            if (payload.payment) {\n                payload.payment.paymentData = newPaymentData;\n            }\n        }\n\n        return super.execute(payload, options).catch((error: Error) => {\n            if (\n                !isRequestError(error) ||\n                !some(error.body.errors, { code: 'three_d_secure_required' })\n            ) {\n                return Promise.reject(error);\n            }\n\n            return new Promise(() => {\n                let payload;\n\n                if (this._isThreeDSTwoExperimentOn() && !error.body.three_ds_result.merchant_data) {\n                    payload = {\n                        creq: error.body.three_ds_result.payer_auth_request,\n                    };\n                } else {\n                    payload = {\n                        PaReq: error.body.three_ds_result.payer_auth_request,\n                        TermUrl: error.body.three_ds_result.callback_url,\n                        MD: error.body.three_ds_result.merchant_data,\n                    };\n                }\n\n                this._formPoster.postForm(\n                    error.body.three_ds_result.acs_url,\n                    payload,\n                    undefined,\n                    '_top',\n                );\n            });\n        });\n    }\n\n    finalize(options?: PaymentRequestOptions): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const order = state.getOrder();\n\n        if (order && state.getPaymentStatus() === PaymentStatusTypes.FINALIZE) {\n            this.paymentIntegrationService.finalizeOrder(options);\n        }\n\n        return super.finalize();\n    }\n\n    private _isThreeDSTwoExperimentOn(): boolean {\n        return (\n            this.paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings\n                .features['INT-4994.Opayo_3DS2'] === true\n        );\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport SagePayPaymentStrategy from './sage-pay-payment-strategy';\n\nconst createSagePayPaymentStrategy: PaymentStrategyFactory<SagePayPaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new SagePayPaymentStrategy(paymentIntegrationService, createFormPoster());\n};\n\nexport default toResolvableModule(createSagePayPaymentStrategy, [{ id: 'sagepay' }]);\n","// The require scope\nvar __webpack_require__ = {};\n\n","import { HostedInstrument } from './payment';\n\nexport default function isHostedInstrumentLike(\n    instrument: unknown,\n): instrument is HostedInstrument {\n    return (\n        typeof instrument === 'object' &&\n        instrument !== null &&\n        (typeof (instrument as HostedInstrument).shouldSaveInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSaveInstrument === 'boolean') &&\n        (typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'boolean')\n    );\n}\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import {\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    OrderFinalizationNotRequiredError,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStatusTypes,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default class OffsitePaymentStrategy implements PaymentStrategy {\n    constructor(private _paymentIntegrationService: PaymentIntegrationService) {}\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n        const orderPayload = this._shouldSubmitFullPayload(payment) ? payload : order;\n        const paymentData = payment && payment.paymentData;\n        const instrumentId =\n            (paymentData && isVaultedInstrument(paymentData) && paymentData.instrumentId) ||\n            undefined;\n        const shouldSaveInstrument =\n            (paymentData &&\n                isHostedInstrumentLike(paymentData) &&\n                paymentData.shouldSaveInstrument) ||\n            undefined;\n        const shouldSetAsDefaultInstrument =\n            (paymentData &&\n                isHostedInstrumentLike(paymentData) &&\n                paymentData.shouldSetAsDefaultInstrument) ||\n            undefined;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { methodId, gatewayId } = payment;\n\n        await this._paymentIntegrationService.submitOrder(orderPayload, options);\n        await this._paymentIntegrationService.initializeOffsitePayment({\n            methodId,\n            gatewayId,\n            instrumentId,\n            shouldSaveInstrument,\n            shouldSetAsDefaultInstrument,\n        });\n    }\n\n    async finalize(options?: PaymentRequestOptions): Promise<void> {\n        const state = this._paymentIntegrationService.getState();\n        const order = state.getOrder();\n        const status = state.getPaymentStatus();\n\n        if (\n            order &&\n            (status === PaymentStatusTypes.ACKNOWLEDGE || status === PaymentStatusTypes.FINALIZE)\n        ) {\n            await this._paymentIntegrationService.finalizeOrder(options);\n\n            return;\n        }\n\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    initialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private _shouldSubmitFullPayload(payment?: OrderPaymentRequestBody): boolean {\n        // FIXME: A temporary workaround to support offsite payment methods\n        // where their return URL needs to be provided by the core app.\n        if (!payment) {\n            return false;\n        }\n\n        return payment.gatewayId === 'adyen' || payment.gatewayId === 'barclaycard';\n    }\n}\n","import {\n    FormattedPayload,\n    FormattedVaultedInstrument,\n    HostedVaultedInstrument,\n    PaymentInstrumentPayload,\n    VaultedInstrument,\n} from './payment';\n\nexport default function isVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is VaultedInstrument {\n    return Boolean((instrument as VaultedInstrument).instrumentId);\n}\n\nexport function isHostedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is HostedVaultedInstrument {\n    return (\n        Boolean((instrument as HostedVaultedInstrument).instrumentId) &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccNumber') &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccCvv')\n    );\n}\n\nexport function isFormattedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is FormattedPayload<FormattedVaultedInstrument> {\n    const formattedInstrument = (instrument as FormattedPayload<FormattedVaultedInstrument>)\n        .formattedPayload;\n\n    if (!formattedInstrument) {\n        return false;\n    }\n\n    return (\n        typeof formattedInstrument.bigpay_token === 'string' ||\n        Boolean(formattedInstrument.bigpay_token && formattedInstrument.bigpay_token.token)\n    );\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport OffsitePaymentStrategy from './offsite-payment-strategy';\n\nconst createOffsitePaymentStrategy: PaymentStrategyFactory<OffsitePaymentStrategy> = (\n    paymentIntegrationService,\n) => new OffsitePaymentStrategy(paymentIntegrationService);\n\nexport default toResolvableModule(createOffsitePaymentStrategy, [{ type: 'PAYMENT_TYPE_HOSTED' }]);\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a payment method experiences some kind of\n * failure (i.e.: its client library returns a rejected promise). And there is\n * no other error type that is more specific than this one.\n */\nexport default class PaymentMethodFailedError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method has thrown an unexpected error.',\n        );\n\n        this.name = 'PaymentMethodFailedError';\n        this.type = 'payment_method_client_invalid';\n    }\n}\n","import { noop, some } from 'lodash';\n\nimport { CreditCardPaymentStrategy } from '@bigcommerce/checkout-sdk/credit-card-integration';\nimport {\n    isRequestError,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodFailedError,\n    PaymentRequestOptions,\n    PaymentStatusTypes,\n    RequestError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    RestApiResponse,\n    THREE_D_SECURE_AVAILABLE,\n    THREE_D_SECURE_BUSY,\n    THREE_D_SECURE_PROCEED,\n    ThreeDSjs,\n} from './cba-mpgs';\nimport CBAMPGSScriptLoader from './cba-mpgs-script-loader';\nimport { isCBAMPGSPaymentMethodLike, isThreeDSErrorBody } from './is-cba-mpgs-payment-method-like';\n\nexport default class CBAMPGSPaymentStrategy extends CreditCardPaymentStrategy {\n    private threeDSjs?: ThreeDSjs;\n\n    private sessionId = '';\n    private locale?: string;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private cbaMGPSScriptLoader: CBAMPGSScriptLoader,\n    ) {\n        super(paymentIntegrationService);\n    }\n\n    async initialize(options: PaymentInitializeOptions): Promise<void> {\n        await super.initialize(options);\n\n        const { methodId } = options;\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(methodId);\n\n        if (!isCBAMPGSPaymentMethodLike(paymentMethod)) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            clientToken,\n            initializationData: { isTestModeFlagEnabled = false, merchantId },\n            config: { is3dsEnabled },\n        } = paymentMethod;\n\n        if (is3dsEnabled) {\n            this.threeDSjs = await this.cbaMGPSScriptLoader.load(isTestModeFlagEnabled);\n\n            if (!this.threeDSjs) {\n                throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n            }\n\n            if (!clientToken || !merchantId) {\n                throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n            }\n\n            this.sessionId = clientToken;\n            this.locale = state.getLocale();\n\n            if (!this.locale) {\n                throw new MissingDataError(MissingDataErrorType.MissingCart);\n            }\n\n            await this.threeDSjs.configure({\n                merchantId,\n                sessionId: this.sessionId,\n                callback: () => {\n                    if (this.threeDSjs?.isConfigured()) {\n                        return this.paymentIntegrationService.getState();\n                    }\n\n                    throw new PaymentMethodFailedError('Failed to configure 3DS API.');\n                },\n                configuration: {\n                    userLanguage: this.locale,\n                    wsVersion: 62,\n                },\n            });\n        }\n\n        return Promise.resolve();\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment } = payload;\n        const paymentData = payment && payment.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(payment.methodId);\n\n        const { is3dsEnabled } = paymentMethod.config;\n\n        if (is3dsEnabled) {\n            const newPaymentData = {\n                ...paymentData,\n                threeDSecure: { token: this.sessionId },\n            };\n\n            if (payload.payment) {\n                payload.payment.paymentData = newPaymentData;\n            }\n        }\n\n        return super.execute(payload, options).catch((error) => {\n            if (\n                !is3dsEnabled ||\n                !isRequestError(error) ||\n                !some(error.body.errors, { code: 'three_d_secure_required' })\n            ) {\n                return Promise.reject(error);\n            }\n\n            const retryState = this.paymentIntegrationService.getState();\n            const order = retryState.getOrder();\n\n            const {\n                storeProfile: { storeId },\n            } = retryState.getStoreConfigOrThrow();\n\n            if (!order || !this.sessionId) {\n                throw new MissingDataError(MissingDataErrorType.MissingCheckout);\n            }\n\n            const orderId = `${storeId}_${order.orderId}`;\n\n            if (!isThreeDSErrorBody(error.body)) {\n                throw new RequestError();\n            }\n\n            const {\n                three_ds_result: { token: transactionId },\n            } = error.body;\n\n            if (!transactionId) {\n                return Promise.reject(error);\n            }\n\n            return this.initiateAuthentication(orderId, transactionId);\n        });\n    }\n\n    async finalize(options?: PaymentRequestOptions): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const order = state.getOrder();\n\n        if (order && state.getPaymentStatus() === PaymentStatusTypes.FINALIZE) {\n            await this.paymentIntegrationService.finalizeOrder(options);\n\n            return Promise.resolve();\n        }\n\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.threeDSjs = undefined;\n        this.sessionId = '';\n\n        return super.deinitialize();\n    }\n\n    private async initiateAuthentication(orderId: string, transactionId: string): Promise<void> {\n        const response: RestApiResponse = await new Promise((resolve, reject) => {\n            if (!this.threeDSjs) {\n                throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n            }\n\n            this.threeDSjs.initiateAuthentication(orderId, transactionId, (data) => {\n                const error = data.error;\n\n                if (error) {\n                    return reject(new PaymentMethodFailedError(error.msg));\n                }\n\n                if (this.threeDSjs && data.gatewayRecommendation === THREE_D_SECURE_PROCEED) {\n                    return resolve(data.restApiResponse);\n                }\n\n                return reject(new PaymentMethodFailedError());\n            });\n        });\n\n        if (\n            response.transaction &&\n            response.transaction.authenticationStatus === THREE_D_SECURE_AVAILABLE\n        ) {\n            return this.authenticatePayer(orderId, transactionId);\n        }\n\n        throw new PaymentMethodFailedError();\n    }\n\n    private async authenticatePayer(\n        orderId: string,\n        transactionId: string,\n        attempt = 1,\n    ): Promise<void> {\n        return new Promise((_resolve, reject) => {\n            if (!this.threeDSjs) {\n                return reject(\n                    new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized),\n                );\n            }\n\n            this.threeDSjs.authenticatePayer(\n                orderId,\n                transactionId,\n                // eslint-disable-next-line @typescript-eslint/no-misused-promises\n                async (data) => {\n                    const error = data.error;\n\n                    if (error) {\n                        if (error.cause && error.cause === THREE_D_SECURE_BUSY && attempt < 5) {\n                            // Wait 3 seconds for MPGS server to process the `initiateAuthentication` call\n                            // See: Step 1: Initiate Authentication ->  Initiate Authentication Request:\n                            // https://ap-gateway.mastercard.com/api/documentation/integrationGuidelines/supportedFeatures/pickAdditionalFunctionality/authentication/3DS/integrationModelAPI.html?locale=en_US#x_3DSTest\n                            await new Promise((resolve) => setTimeout(resolve, 3000));\n\n                            // eslint-disable-next-line no-plusplus, no-param-reassign\n                            return this.authenticatePayer(orderId, transactionId, ++attempt);\n                        }\n\n                        return reject(new PaymentMethodFailedError());\n                    }\n\n                    // ThreeDSjs will handle the redirect so return a promise that doesn't really resolve\n                    return new Promise<never>(noop);\n                },\n                { fullScreenRedirect: true },\n            );\n        });\n    }\n}\n","/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { PaymentMethod } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { CBAMPGSPaymentMethod, ThreeDSErrorBody } from './cba-mpgs';\n\nexport function isCBAMPGSPaymentMethodLike(\n    paymentMethod: PaymentMethod,\n): paymentMethod is CBAMPGSPaymentMethod {\n    return (\n        typeof paymentMethod === 'object' &&\n        paymentMethod !== null &&\n        'initializationData' in paymentMethod &&\n        typeof (paymentMethod as CBAMPGSPaymentMethod).initializationData === 'object' &&\n        (paymentMethod as CBAMPGSPaymentMethod).initializationData !== null &&\n        'merchantId' in (paymentMethod as CBAMPGSPaymentMethod).initializationData &&\n        typeof (paymentMethod as CBAMPGSPaymentMethod).initializationData.merchantId === 'string' &&\n        (typeof (paymentMethod as CBAMPGSPaymentMethod).initializationData.isTestModeFlagEnabled ===\n            'boolean' ||\n            typeof (paymentMethod as CBAMPGSPaymentMethod).initializationData\n                .isTestModeFlagEnabled === 'undefined')\n    );\n}\n\nexport function isThreeDSErrorBody(body: unknown): body is ThreeDSErrorBody {\n    return (\n        typeof body === 'object' &&\n        body !== null &&\n        'three_ds_result' in body &&\n        typeof (body as ThreeDSErrorBody).three_ds_result === 'object' &&\n        (body as ThreeDSErrorBody).three_ds_result !== null &&\n        'token' in (body as ThreeDSErrorBody).three_ds_result &&\n        typeof (body as ThreeDSErrorBody).three_ds_result.token === 'string'\n    );\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { PaymentMethod } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport const THREE_D_SECURE_PROCEED = 'PROCEED';\nexport const THREE_D_SECURE_BUSY = 'SERVER_BUSY';\nexport const THREE_D_SECURE_AVAILABLE = 'AUTHENTICATION_AVAILABLE';\n\nexport interface CBAMPGSHostWindow extends Window {\n    ThreeDS?: ThreeDSjs;\n}\n\nexport interface ThreeDSjs {\n    // Configuration method for initializing the API.\n    configure(config: ThreeDSConfiguration): Promise<void>;\n    // Convenience method to check if the API has been configured successfully.\n    isConfigured(): boolean;\n    // Authentication for the arguments passed.\n    initiateAuthentication(\n        orderId: string,\n        transactionId: string,\n        callback: (data: ThreeDSAuthenticationResponse) => void,\n    ): void;\n    authenticatePayer(\n        orderId: string,\n        transactionId: string,\n        callback: (data: ThreeDSAuthenticationResponse) => void,\n        optionalParams?: AuthenticatePayerOptionalParams,\n    ): void;\n}\n\nexport interface RestApiResponse {\n    transaction: {\n        authenticationStatus: string;\n    };\n}\n\n// Configuration required to configure ThreeDS\nexport interface ThreeDSConfiguration {\n    merchantId: string;\n    sessionId: string;\n    configuration: ThreeDSAPIConfiguration;\n    callback(): void;\n}\n\nexport interface ThreeDSAuthenticationResponse {\n    error?: ThreeDSAuthenticationError;\n    restApiResponse: RestApiResponse;\n    gatewayRecommendation: string;\n}\n\nexport interface AuthenticatePayerOptionalParams {\n    fullScreenRedirect: boolean;\n}\n\nexport interface ThreeDSAuthenticationError {\n    code: string;\n    msg: string;\n    cause?: string;\n}\n\n// JSON value supporting data elements like userLanguage, REST API version (wsVersion)\nexport interface ThreeDSAPIConfiguration {\n    // A language identifier or IETF language tag to control the language of the payment page displayed to the payer.\n    //  For example, \"en_US\", es, \"fr-CA\". By default, the language is \"en_US\".\n    userLanguage: string;\n    // The Web Services API version that you submitted the request in. IE: 62\n    wsVersion: number;\n}\n\nexport interface CBAMPGSPaymentMethod extends PaymentMethod {\n    initializationData: CBAMPGSInitializationData;\n}\n\nexport interface CBAMPGSInitializationData {\n    isTestModeFlagEnabled?: boolean;\n    merchantId: string;\n}\n\nexport interface ThreeDSErrorBody {\n    three_ds_result: {\n        token: string;\n    };\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { CBAMPGSHostWindow, ThreeDSjs } from './cba-mpgs';\n\nexport default class CBAMPGSScriptLoader {\n    constructor(private _scriptLoader: ScriptLoader, private _window: CBAMPGSHostWindow = window) {}\n\n    async load(testMode?: boolean): Promise<ThreeDSjs> {\n        await this._scriptLoader.loadScript(\n            `//${\n                testMode ? 'test' : 'ap'\n            }-gateway.mastercard.com/static/threeDS/1.3.0/three-ds.min.js`,\n        );\n\n        if (!this._window.ThreeDS) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this._window.ThreeDS;\n    }\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CBAMPGSPaymentStrategy from './cba-mpgs-payment-strategy';\nimport CBAMPGSScriptLoader from './cba-mpgs-script-loader';\n\nconst createCBAMPGSPaymentStrategy: PaymentStrategyFactory<CBAMPGSPaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new CBAMPGSPaymentStrategy(\n        paymentIntegrationService,\n        new CBAMPGSScriptLoader(getScriptLoader()),\n    );\n};\n\nexport default toResolvableModule(createCBAMPGSPaymentStrategy, [{ id: 'cba_mpgs' }]);\n","export interface PaypalFundingTypeList {\n    CARD?: string;\n    CREDIT?: string;\n    PAYPAL?: string;\n    PAYLATER?: string;\n}\n\nexport interface PaypalButton {\n    render(options: PaypalButtonOptions, container: string): void;\n}\n\nexport interface PaypalButtonRender {\n    render(container: string): void;\n    isEligible(): boolean;\n}\n\nexport interface MessagingRender {\n    render(container: string): void;\n}\n\nexport interface MessagingOptions {\n    amount: number;\n    placement: string;\n}\n\nexport interface PaypalButtonOptions {\n    env?: string;\n    commit?: boolean;\n    style?: PaypalStyleOptions;\n    funding?: PaypalFundingType;\n    fundingSource?: string;\n    client?: PaypalClientToken;\n    payment?(data?: PaypalAuthorizeData, actions?: PaypalActions): Promise<any>;\n    onAuthorize?(data: PaypalAuthorizeData, actions?: PaypalActions): Promise<any>;\n    createOrder?(data?: PaypalAuthorizeData, actions?: PaypalActions): Promise<any>;\n    onApprove?(data?: PaypalAuthorizeData, actions?: PaypalActions): Promise<any>;\n}\n\nexport interface PaypalClientToken {\n    production?: string;\n    sandbox?: string;\n}\n\nexport interface PaypalFundingType {\n    allowed?: string[];\n    disallowed?: string[];\n}\n\nexport enum PaypalButtonStyleLayoutOption {\n    HORIZONTAL = 'horizontal',\n    VERTICAL = 'vertical',\n}\n\nexport enum PaypalButtonStyleSizeOption {\n    SMALL = 'small',\n    MEDIUM = 'medium',\n    LARGE = 'large',\n    RESPONSIVE = 'responsive',\n}\n\nexport enum PaypalButtonStyleColorOption {\n    GOLD = 'gold',\n    BLUE = 'blue',\n    SIlVER = 'silver',\n    BLACK = 'black',\n}\n\nexport enum PaypalButtonStyleLabelOption {\n    CHECKOUT = 'checkout',\n    PAY = 'pay',\n    BUYNOW = 'buynow',\n    PAYPAL = 'paypal',\n    CREDIT = 'credit',\n}\n\nexport enum PaypalButtonStyleShapeOption {\n    PILL = 'pill',\n    RECT = 'rect',\n}\n\nexport enum PaymentStatusTypes {\n    ACKNOWLEDGE = 'ACKNOWLEDGE',\n    FINALIZE = 'FINALIZE',\n    INITIALIZE = 'INITIALIZE',\n}\n\nexport interface PaypalStyleOptions {\n    layout?: PaypalButtonStyleLayoutOption;\n    size?: PaypalButtonStyleSizeOption;\n    color?: PaypalButtonStyleColorOption;\n    label?: PaypalButtonStyleLabelOption;\n    shape?: PaypalButtonStyleShapeOption;\n    tagline?: boolean;\n    fundingicons?: boolean;\n    height?: number;\n}\n\nexport interface PaypalActions {\n    payment: PaypalPaymentActions;\n    request: PaypalRequestActions;\n}\n\nexport interface PaypalPaymentActions {\n    get(id: string): Promise<PaypalPaymentPayload>;\n}\n\nexport interface PaypalRequestActions {\n    post(url: string, payload?: object, options?: object): Promise<{ id: string }>;\n}\n\nexport interface PaypalTransaction {\n    amount?: PaypalAmount;\n    payee?: PaypalPayee;\n    description?: string;\n    note_to_payee?: string;\n    item_list?: PaypalItemList;\n}\n\nexport interface PaypalItemList {\n    items?: PaypalItem[];\n    shipping_address?: PaypalAddress;\n}\n\nexport interface PaypalItem {\n    sku?: string;\n    name?: string;\n    description?: string;\n    quantity: string;\n    price: string;\n    currency: string;\n    tax?: string;\n}\n\nexport interface PaypalAmount {\n    currency: string;\n    total: string;\n}\n\nexport interface PaypalPayer {\n    payer_info: object;\n}\n\nexport interface PaypalPayee {\n    email?: string;\n    merchant_id?: string;\n}\n\nexport interface PaypalAddress {\n    line1: string;\n    line2?: string;\n    city?: string;\n    country_code: string;\n    postal_code?: string;\n    state?: string;\n    phone?: string;\n    type?: string;\n}\n\nexport interface PaypalPaymentPayload {\n    payment: PaypalPaymentPayload;\n    payer: PaypalPayer;\n    transactions?: PaypalTransaction[];\n}\n\nexport interface PaypalAuthorizeData {\n    payerId: string;\n    paymentId?: string;\n    billingToken?: string;\n    // the PayPal side of things uses uppercase ID instead of camel case Id\n    payerID?: string;\n    paymentID?: string;\n}\n\nexport interface PaypalExpressCheckout {\n    initXO(): void;\n    startFlow(url: string): void;\n    closeFlow(): void;\n    setup(merchantId: string, options: PaypalExpressCheckoutOptions): void;\n}\n\nexport interface PaypalExpressCheckoutOptions {\n    button: string;\n    environment: string;\n}\n\nexport interface PaypalHostWindow extends Window {\n    paypal?: PaypalSDK;\n}\n\nexport interface PaypalSDK {\n    Button: PaypalButton;\n    checkout: PaypalExpressCheckout;\n    FUNDING: PaypalFundingTypeList;\n    Messages(options: MessagingOptions): MessagingRender;\n    Buttons(options: PaypalButtonOptions): PaypalButtonRender;\n}\n","import { noop } from 'lodash';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentInitializeOptions,\n    PaymentIntegrationSelectors,\n    PaymentIntegrationService,\n    PaymentMethod,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithPaypalExpressPaymentInitializeOptions } from './paypal-express-payment-initialize-options';\nimport PaypalScriptLoader from './paypal-express-script-loader';\nimport { PaymentStatusTypes, PaypalHostWindow, PaypalSDK } from './paypal-express-types';\n\nexport default class PaypalExpressPaymentStrategy implements PaymentStrategy {\n    private paypalSdk?: PaypalSDK;\n    private paymentMethod?: PaymentMethod;\n    private useRedirectFlow = false;\n    private window: PaypalHostWindow;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private scriptLoader: PaypalScriptLoader,\n    ) {\n        this.window = window;\n    }\n\n    async initialize(\n        options: PaymentInitializeOptions & WithPaypalExpressPaymentInitializeOptions,\n    ): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n\n        this.paymentMethod = state.getPaymentMethodOrThrow(options.methodId);\n        this.useRedirectFlow =\n            (options.paypalexpress && options.paypalexpress.useRedirectFlow) === true;\n\n        const merchantId = this.paymentMethod.config.merchantId;\n\n        if (!this.isInContextEnabled() || !merchantId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const paypalSdk = await this.scriptLoader.loadPaypalSDK();\n\n        this.paypalSdk = paypalSdk;\n\n        this.paypalSdk.checkout.setup(merchantId, {\n            button: 'paypal-button',\n            environment: this.paymentMethod.config.testMode ? 'sandbox' : 'production',\n        });\n    }\n\n    deinitialize() {\n        if (this.isInContextEnabled() && this.paypalSdk) {\n            this.paypalSdk.checkout.closeFlow();\n            this.paypalSdk = undefined;\n        }\n\n        return Promise.resolve();\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions) {\n        let state: PaymentIntegrationSelectors;\n        let redirectUrl: string | undefined;\n        const paypal = this.paypalSdk;\n\n        if (this.isAcknowledgedOrFinalized()) {\n            await this.paymentIntegrationService.submitOrder(payload, options);\n\n            return;\n        }\n\n        if (!this.isInContextEnabled() || this.useRedirectFlow) {\n            state = await this.paymentIntegrationService.submitOrder(payload, options);\n            redirectUrl = state.getPaymentRedirectUrl();\n\n            if (redirectUrl && this.window.top) {\n                this.window.top.location.href = redirectUrl;\n            }\n\n            // We need to hold execution so the consumer does not redirect us somewhere else\n            return new Promise<never>(noop);\n        }\n\n        if (!paypal) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        paypal.checkout.initXO();\n\n        try {\n            state = await this.paymentIntegrationService.submitOrder(payload, options);\n        } catch (error) {\n            paypal.checkout.closeFlow();\n\n            return Promise.reject(error);\n        }\n\n        redirectUrl = state.getPaymentRedirectUrl();\n\n        if (redirectUrl) {\n            paypal.checkout.startFlow(redirectUrl);\n        }\n\n        // We need to hold execution so the consumer does not redirect us somewhere else\n        return new Promise<never>(noop);\n    }\n\n    async finalize(options?: PaymentRequestOptions) {\n        const state = this.paymentIntegrationService.getState();\n        const order = state.getOrder();\n\n        if (order && this.isAcknowledgedOrFinalized()) {\n            await this.paymentIntegrationService.finalizeOrder(options);\n\n            return Promise.resolve();\n        }\n\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    private isAcknowledgedOrFinalized(): boolean {\n        const state = this.paymentIntegrationService.getState();\n\n        return (\n            state.getPaymentStatus() === PaymentStatusTypes.ACKNOWLEDGE ||\n            state.getPaymentStatus() === PaymentStatusTypes.FINALIZE\n        );\n    }\n\n    private isInContextEnabled(): boolean {\n        return !!(this.paymentMethod && this.paymentMethod.config.merchantId);\n    }\n}\n","import { LoadScriptOptions, ScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentMethodClientUnavailableError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { PaypalHostWindow, PaypalSDK } from './paypal-express-types';\n\nexport default class PaypalScriptLoader {\n    private window: PaypalHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async loadPaypalSDK(merchantId = ''): Promise<PaypalSDK> {\n        const scriptSrc = '//www.paypalobjects.com/api/checkout.min.js';\n        const options: LoadScriptOptions = {\n            async: true,\n            attributes: { 'data-merchant-id': merchantId },\n            ...(merchantId && {\n                attributes: { 'data-merchant-id': merchantId },\n            }),\n        };\n\n        await this.scriptLoader.loadScript(scriptSrc, options);\n\n        if (!this.window.paypal) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypal;\n    }\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PaypalExpressPaymentStrategy from './paypal-express-payment-strategy';\nimport PaypalExpressScriptLoader from './paypal-express-script-loader';\n\nconst createPaypalExpressPaymentStrategy: PaymentStrategyFactory<PaypalExpressPaymentStrategy> = (\n    paymentIntegrationService,\n) => {\n    return new PaypalExpressPaymentStrategy(\n        paymentIntegrationService,\n        new PaypalExpressScriptLoader(getScriptLoader()),\n    );\n};\n\nexport default toResolvableModule(createPaypalExpressPaymentStrategy, [\n    { id: 'paypalexpress', type: 'PAYMENT_TYPE_HOSTED' },\n    { id: 'paypalexpresscredit', type: 'PAYMENT_TYPE_HOSTED' },\n]);\n","export const INTERNAL_USE_ONLY =\n    'This API endpoint is for internal use only and may change in the future';\n","export const SDK_VERSION_HEADERS = { 'X-Checkout-SDK-Version': LIBRARY_VERSION };\n","import { FormPoster } from '@bigcommerce/form-poster';\n\nimport {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    INTERNAL_USE_ONLY,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    NotInitializedError,\n    NotInitializedErrorType,\n    PaymentIntegrationService,\n    SDK_VERSION_HEADERS,\n    StandardError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithPaypalExpressButtonInitializeOptions } from './paypal-express-button-initialize-options';\nimport PaypalScriptLoader from './paypal-express-script-loader';\nimport {\n    PaypalActions,\n    PaypalAuthorizeData,\n    PaypalButtonStyleShapeOption,\n    PaypalButtonStyleSizeOption,\n    PaypalClientToken,\n    PaypalSDK,\n    PaypalStyleOptions,\n} from './paypal-express-types';\n\nexport default class PaypalButtonStrategy implements CheckoutButtonStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalExpressScriptLoader: PaypalScriptLoader,\n        private formPoster: FormPoster,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions & WithPaypalExpressButtonInitializeOptions,\n    ): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(options.methodId);\n\n        if (!options.paypal) {\n            throw new InvalidArgumentError();\n        }\n\n        if (!paymentMethod.config.merchantId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const paypalSDK = await this.paypalExpressScriptLoader.loadPaypalSDK(\n            paymentMethod.config.merchantId,\n        );\n\n        this.renderButton(options, paypalSDK);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        options: CheckoutButtonInitializeOptions & WithPaypalExpressButtonInitializeOptions,\n        paypalSDK: PaypalSDK,\n    ) {\n        const { containerId, methodId, paypal } = options;\n        const { allowCredit, clientId, onPaymentError, shouldProcessPayment, style } = paypal;\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(options.methodId);\n\n        if (!paymentMethod.config.merchantId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const merchantId = paymentMethod.config.merchantId;\n        const env = paymentMethod.config.testMode ? 'sandbox' : 'production';\n        const clientToken: PaypalClientToken = { [env]: clientId };\n        const fundingCreditOption = paypalSDK.FUNDING.CREDIT || 'credit';\n        const allowedSources = allowCredit ? [fundingCreditOption] : [];\n        const disallowedSources = !allowCredit ? [fundingCreditOption] : [];\n\n        return paypalSDK.Button.render(\n            {\n                env,\n                client: clientToken,\n                commit: shouldProcessPayment,\n                funding: {\n                    allowed: allowedSources,\n                    disallowed: disallowedSources,\n                },\n                style: this.getStyle(style),\n                payment: (_, actions) => this.setupPayment(merchantId, actions, onPaymentError),\n                onAuthorize: (data, actions) =>\n                    this.tokenizePayment(data, methodId, actions, shouldProcessPayment),\n            },\n            containerId,\n        );\n    }\n\n    private getStyle(style?: Omit<PaypalStyleOptions, 'height'>): PaypalStyleOptions {\n        const { color, fundingicons, label, layout, shape, size, tagline } = style || {};\n\n        return {\n            color,\n            fundingicons,\n            label,\n            layout,\n            shape: shape || PaypalButtonStyleShapeOption.RECT,\n            size: size === 'small' ? PaypalButtonStyleSizeOption.RESPONSIVE : size,\n            tagline,\n        };\n    }\n\n    private async setupPayment(\n        merchantId: string,\n        actions?: PaypalActions,\n        onError?: (error: StandardError) => void,\n    ): Promise<string> {\n        if (!actions) {\n            throw new NotInitializedError(NotInitializedErrorType.CheckoutButtonNotInitialized);\n        }\n\n        try {\n            const state = await this.paymentIntegrationService.loadDefaultCheckout();\n            const { id: cartId } = state.getCartOrThrow();\n            const host = state.getHost() || '';\n\n            const paymentRequest = await actions.request.post(\n                `${host}/api/storefront/payment/paypalexpress`,\n                { merchantId, cartId },\n                {\n                    headers: {\n                        'X-API-INTERNAL': INTERNAL_USE_ONLY,\n                        ...SDK_VERSION_HEADERS,\n                    },\n                },\n            );\n\n            return paymentRequest.id;\n        } catch (error) {\n            if (onError && error instanceof StandardError) {\n                onError(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async tokenizePayment(\n        data: PaypalAuthorizeData,\n        methodId: string,\n        actions?: PaypalActions,\n        shouldProcessPayment?: boolean,\n    ): Promise<void> {\n        if (!actions) {\n            throw new NotInitializedError(NotInitializedErrorType.CheckoutButtonNotInitialized);\n        }\n\n        if (!data.paymentID || !data.payerID) {\n            throw new MissingDataError(MissingDataErrorType.MissingPayment);\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(methodId);\n\n        const getPaymentData = await actions.payment.get(data.paymentID);\n\n        return this.formPoster.postForm('/checkout.php', {\n            payment_type: 'paypal',\n            provider: paymentMethod.id,\n            action: shouldProcessPayment ? 'process_payment' : 'set_external_checkout',\n            paymentId: data.paymentID,\n            payerId: data.payerID,\n            payerInfo: JSON.stringify(getPaymentData.payer.payer_info),\n        });\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { PaypalExpressButtonStrategy, PaypalExpressScriptLoader } from './index';\n\nconst createPaypalExpressButtonStrategy: CheckoutButtonStrategyFactory<\n    PaypalExpressButtonStrategy\n> = (paymentIntegrationService) => {\n    return new PaypalExpressButtonStrategy(\n        paymentIntegrationService,\n        new PaypalExpressScriptLoader(getScriptLoader()),\n        createFormPoster(),\n    );\n};\n\nexport default toResolvableModule(createPaypalExpressButtonStrategy, [{ id: 'paypalexpress' }]);\n","import { PaymentMethod } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport interface AdditionalActionRequired {\n    type: AdditionalActionType;\n    data: AdditionalRedirectData;\n}\n\nexport interface AdditionalRedirectData {\n    redirect_url: string;\n    transaction_id?: string;\n}\n\nexport enum AdditionalActionType {\n    OffsiteRedirect = 'offsite_redirect',\n}\n\nexport function getCheckoutcom(): PaymentMethod {\n    return {\n        id: 'checkoutcom',\n        logoUrl: '',\n        method: 'checkoutcom',\n        supportedCards: [],\n        config: {\n            displayName: 'Checkout.com',\n            merchantId: '',\n            testMode: true,\n        },\n        initializationData: {\n            checkoutcomkey: 'key',\n        },\n        type: 'PAYMENT_TYPE_API',\n        clientToken: 'clientToken',\n        skipRedirectConfirmationAlert: true,\n    };\n}\n\nexport interface WithDocumentInstrument {\n    ccDocument: string;\n}\n\nexport interface WithCheckoutcomSEPAInstrument {\n    iban: string;\n    bic: string;\n}\n\nexport interface WithCheckoutcomFawryInstrument {\n    customerMobile: string;\n    customerEmail: string;\n}\n","import { CreditCardPaymentStrategy } from '@bigcommerce/checkout-sdk/credit-card-integration';\nimport {\n    isRequestError,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStatusTypes,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { AdditionalActionRequired, AdditionalActionType } from './checkoutcom';\n\nexport default class CheckoutComCustomPaymentStrategy extends CreditCardPaymentStrategy {\n    constructor(protected paymentIntegrationService: PaymentIntegrationService) {\n        super(paymentIntegrationService);\n    }\n    finalize(options?: PaymentRequestOptions): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const order = state.getOrder();\n\n        if (order && state.getPaymentStatus() === PaymentStatusTypes.FINALIZE) {\n            this.paymentIntegrationService.finalizeOrder(options);\n        }\n\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    protected async _executeWithHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const form = this._hostedForm;\n\n        if (!form) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        if (!payment || !payment.methodId) {\n            throw new PaymentArgumentInvalidError(['payment.methodId']);\n        }\n\n        try {\n            await form.validate();\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await form.submit(payment);\n        } catch (error) {\n            return this._processResponse(error);\n        }\n\n        this.paymentIntegrationService.loadCurrentOrder();\n    }\n\n    protected _processResponse(error: unknown): Promise<void> {\n        if (!isRequestError(error)) {\n            return Promise.reject(error);\n        }\n\n        const additionalActionRequired: AdditionalActionRequired =\n            error.body.additional_action_required;\n\n        // TODO validate all possible responses and perform respective additional actions\n        if (\n            additionalActionRequired &&\n            additionalActionRequired.type === AdditionalActionType.OffsiteRedirect\n        ) {\n            return this._performRedirect(additionalActionRequired);\n        }\n\n        return Promise.reject(error);\n    }\n\n    private _performRedirect(additionalActionRequired: AdditionalActionRequired): Promise<void> {\n        return new Promise(() => {\n            window.location.replace(additionalActionRequired.data.redirect_url);\n        });\n    }\n}\n","import {\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInstrument,\n    PaymentRequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithCheckoutcomFawryInstrument } from '../checkoutcom';\nimport CheckoutComCustomPaymentStrategy from '../checkoutcom-custom-payment-strategy';\n\nconst CHECKOUTCOM_FAWRY_PAYMENT_METHOD = 'fawry';\n\nexport default class CheckoutComFawryPaymentStrategy extends CheckoutComCustomPaymentStrategy {\n    protected async _executeWithoutHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const paymentData = payment && payment.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        try {\n            await this._paymentIntegrationService.submitPayment({\n                ...payment,\n                paymentData: {\n                    ...paymentData,\n                    formattedPayload: this._createFormattedPayload(\n                        payment.methodId,\n                        paymentData as PaymentInstrument,\n                    ),\n                },\n            });\n        } catch (error) {\n            return this._processResponse(error);\n        }\n    }\n\n    private _createFormattedPayload(\n        methodId: string,\n        paymentData: PaymentInstrument,\n    ): WithCheckoutcomFawryInstrument | undefined {\n        if (\n            CHECKOUTCOM_FAWRY_PAYMENT_METHOD === methodId &&\n            'customerMobile' in paymentData &&\n            'customerEmail' in paymentData\n        ) {\n            const fawryPaymentData = paymentData as {\n                customerMobile: string;\n                customerEmail: string;\n            };\n\n            return {\n                customerMobile: fawryPaymentData.customerMobile,\n                customerEmail: fawryPaymentData.customerEmail,\n            };\n        }\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CheckoutComFawryPaymentStrategy from './checkoutcom-fawry-payment-strategy';\n\nconst createCheckoutComFawryPaymentStrategy: PaymentStrategyFactory<\n    CheckoutComFawryPaymentStrategy\n> = (paymentIntegrationService) => {\n    return new CheckoutComFawryPaymentStrategy(paymentIntegrationService);\n};\n\nexport default toResolvableModule(createCheckoutComFawryPaymentStrategy, [\n    { gateway: 'checkoutcom', id: 'fawry' },\n]);\n","import { some } from 'lodash';\n\nimport { isRequestError, RequestError } from './';\n\nexport default function isThreeDSecureRequiredError(error: unknown): error is RequestError {\n    return isRequestError(error) && some(error.body.errors, { code: 'three_d_secure_required' });\n}\n","import { FormPoster } from '@bigcommerce/form-poster';\n\nimport { CreditCardPaymentStrategy } from '@bigcommerce/checkout-sdk/credit-card-integration';\nimport {\n    isThreeDSecureRequiredError,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStatusTypes,\n    RequestError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default class CheckoutComCreditCardPaymentStrategy extends CreditCardPaymentStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        protected formPoster: FormPoster,\n    ) {\n        super(paymentIntegrationService);\n    }\n\n    finalize(options?: PaymentRequestOptions): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const order = state.getOrder();\n\n        if (order && state.getPaymentStatus() === PaymentStatusTypes.FINALIZE) {\n            this.paymentIntegrationService.finalizeOrder(options);\n        }\n\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    protected async _executeWithoutHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const paymentData = payment && payment.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        await this.paymentIntegrationService.submitOrder(order, options);\n\n        try {\n            await this.paymentIntegrationService.submitPayment({ ...payment, paymentData });\n        } catch (error) {\n            if (isThreeDSecureRequiredError(error)) {\n                return this._handleThreeDSecure(error);\n            }\n\n            return Promise.reject(error);\n        }\n    }\n\n    protected async _executeWithHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const form = this._hostedForm;\n\n        if (!form) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        if (!payment || !payment.methodId) {\n            throw new PaymentArgumentInvalidError(['payment.methodId']);\n        }\n\n        try {\n            await form.validate();\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await form.submit(payment);\n        } catch (error) {\n            if (isThreeDSecureRequiredError(error)) {\n                return this._handleThreeDSecure(error);\n            }\n\n            return Promise.reject(error);\n        }\n\n        this.paymentIntegrationService.loadCurrentOrder();\n    }\n\n    private _handleThreeDSecure(error: RequestError): Promise<void> {\n        const { acs_url, payer_auth_request, callback_url, merchant_data } =\n            error.body.three_ds_result;\n\n        return new Promise<void>(() =>\n            this.formPoster.postForm(acs_url, {\n                PaReq: payer_auth_request || null,\n                TermUrl: callback_url || null,\n                MD: merchant_data || null,\n            }),\n        );\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CheckoutComCreditCardPaymentStrategy from './checkoutcom-credit-card-payment-strategy';\n\nconst createCheckoutComCreditCardPaymentStrategy: PaymentStrategyFactory<\n    CheckoutComCreditCardPaymentStrategy\n> = (paymentIntegrationService) => {\n    return new CheckoutComCreditCardPaymentStrategy(paymentIntegrationService, createFormPoster());\n};\n\nexport default toResolvableModule(createCheckoutComCreditCardPaymentStrategy, [\n    { gateway: 'checkoutcom', id: 'credit_card' },\n    { gateway: 'checkoutcom', id: 'card' },\n]);\n","import {\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInstrument,\n    PaymentRequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithCheckoutcomSEPAInstrument } from '../checkoutcom';\nimport CheckoutComCustomPaymentStrategy from '../checkoutcom-custom-payment-strategy';\n\nconst CHECKOUTCOM_SEPA_PAYMENT_METHOD = 'sepa';\n\nexport default class CheckoutComSEPAPaymentStrategy extends CheckoutComCustomPaymentStrategy {\n    protected async _executeWithoutHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const paymentData = payment?.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        try {\n            await this._paymentIntegrationService.submitPayment({\n                ...payment,\n                paymentData: {\n                    ...paymentData,\n                    formattedPayload: this._createFormattedPayload(\n                        payment.methodId,\n                        paymentData as PaymentInstrument,\n                    ),\n                },\n            });\n        } catch (error) {\n            return this._processResponse(error);\n        }\n    }\n\n    private _createFormattedPayload(\n        methodId: string,\n        paymentData: PaymentInstrument,\n    ): WithCheckoutcomSEPAInstrument {\n        const formattedPayload: WithCheckoutcomSEPAInstrument = { iban: '', bic: '' };\n        const { iban, bic } =\n            'iban' in paymentData && 'bic' in paymentData ? paymentData : formattedPayload;\n\n        if (methodId === CHECKOUTCOM_SEPA_PAYMENT_METHOD && document) {\n            formattedPayload.iban = iban;\n            formattedPayload.bic = bic;\n        }\n\n        return formattedPayload;\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CheckoutComSepaPaymentStrategy from './checkoutcom-sepa-payment-strategy';\n\nconst createCheckoutComSepaPaymentStrategy: PaymentStrategyFactory<\n    CheckoutComSepaPaymentStrategy\n> = (paymentIntegrationService) => {\n    return new CheckoutComSepaPaymentStrategy(paymentIntegrationService);\n};\n\nexport default toResolvableModule(createCheckoutComSepaPaymentStrategy, [\n    { gateway: 'checkoutcom', id: 'sepa' },\n]);\n","import {\n    CreditCardInstrument,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInstrument,\n    PaymentRequestOptions,\n    WithIdealInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CheckoutComCustomPaymentStrategy from '../checkoutcom-custom-payment-strategy';\n\nconst CHECKOUTCOM_IDEAL_PAYMENT_METHOD = 'ideal';\n\nexport default class CheckoutComiDealPaymentStrategy extends CheckoutComCustomPaymentStrategy {\n    protected async _executeWithoutHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const paymentData = payment?.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        try {\n            await this._paymentIntegrationService.submitPayment({\n                ...payment,\n                paymentData: {\n                    ...paymentData,\n                    formattedPayload: this._createFormattedPayload(\n                        payment.methodId,\n                        paymentData as PaymentInstrument,\n                    ),\n                },\n            });\n        } catch (error) {\n            return this._processResponse(error);\n        }\n    }\n\n    private _createFormattedPayload(\n        methodId: string,\n        paymentData: PaymentInstrument | (CreditCardInstrument & WithIdealInstrument),\n    ): WithIdealInstrument | undefined {\n        if (CHECKOUTCOM_IDEAL_PAYMENT_METHOD === methodId && 'bic' in paymentData) {\n            return { bic: paymentData.bic };\n        }\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CheckoutComiDealPaymentStrategy from './checkoutcom-ideal-payment-strategy';\n\nconst createCheckoutComiDealPaymentStrategy: PaymentStrategyFactory<\n    CheckoutComiDealPaymentStrategy\n> = (paymentIntegrationService) => {\n    return new CheckoutComiDealPaymentStrategy(paymentIntegrationService);\n};\n\nexport default toResolvableModule(createCheckoutComiDealPaymentStrategy, [\n    { gateway: 'checkoutcom', id: 'ideal' },\n]);\n","import {\n    CreditCardInstrument,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInstrument,\n    PaymentRequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { WithDocumentInstrument } from '../checkoutcom';\nimport CheckoutComCustomPaymentStrategy from '../checkoutcom-custom-payment-strategy';\n\nconst DOCUMENT_SUPPORTED_APMS = ['boleto', 'oxxo', 'qpay', 'ideal'];\n\nexport default class CheckoutComAPMPaymentStrategy extends CheckoutComCustomPaymentStrategy {\n    protected async _executeWithoutHostedForm(\n        payload: OrderRequestBody,\n        options?: PaymentRequestOptions,\n    ): Promise<void> {\n        const { payment, ...order } = payload;\n        const paymentData = payment?.paymentData;\n\n        if (!payment || !paymentData) {\n            throw new PaymentArgumentInvalidError(['payment.paymentData']);\n        }\n\n        await this._paymentIntegrationService.submitOrder(order, options);\n\n        try {\n            await this._paymentIntegrationService.submitPayment({\n                ...payment,\n                paymentData: {\n                    ...paymentData,\n                    formattedPayload: this._createFormattedPayload(\n                        payment.methodId,\n                        paymentData as PaymentInstrument,\n                    ),\n                },\n            });\n        } catch (error) {\n            return this._processResponse(error);\n        }\n    }\n\n    private _createFormattedPayload(\n        methodId: string,\n        paymentData: PaymentInstrument | (CreditCardInstrument & WithDocumentInstrument),\n    ): WithDocumentInstrument {\n        const formattedPayload: WithDocumentInstrument = { ccDocument: '' };\n        const ccDocument = 'ccDocument' in paymentData ? paymentData.ccDocument : '';\n\n        if (DOCUMENT_SUPPORTED_APMS.indexOf(methodId) !== -1 && ccDocument) {\n            formattedPayload.ccDocument = ccDocument;\n        }\n\n        return formattedPayload;\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport CheckoutComCustomPaymentStrategy from '../checkoutcom-custom-payment-strategy';\n\nimport CheckoutComAPMPaymentStrategy from './checkoutcom-apm-payment-strategy';\n\nconst createCheckoutComAPMPaymentStrategy: PaymentStrategyFactory<\n    CheckoutComCustomPaymentStrategy\n> = (paymentIntegrationService) => {\n    return new CheckoutComAPMPaymentStrategy(paymentIntegrationService);\n};\n\nexport default toResolvableModule(createCheckoutComAPMPaymentStrategy, [\n    { gateway: 'checkoutcom' },\n]);\n"],"names":["MissingDataErrorType","NotInitializedErrorType","StandardError","Error","constructor","message","prototype","super","name","type","Object","setPrototypeOf","this","__proto__","captureStackTrace","stack","InvalidArgumentError","PaymentArgumentInvalidError","invalidFields","join","MissingBillingAddress","MissingCart","MissingCheckout","MissingConsignments","MissingCustomer","MissingCheckoutConfig","MissingOrder","MissingOrderConfig","MissingOrderId","MissingPayment","MissingPaymentId","MissingPaymentInstrument","MissingPaymentMethod","MissingPaymentRedirectUrl","MissingPaymentStatus","MissingPaymentToken","MissingShippingAddress","MissingDataError","subtype","OrderFinalizationNotCompletedError","CheckoutButtonNotInitialized","CustomerNotInitialized","PaymentNotInitialized","ShippingNotInitialized","SpamProtectionNotInitialized","NotInitializedError","DEFAULT_RESPONSE","body","headers","status","RequestError","response","errors","ClearpayPaymentStrategy","_paymentIntegrationService","_clearpayScriptLoader","initialize","options","getPaymentMethodOrThrow","getState","paymentMethod","methodId","gatewayId","_clearpaySdk","load","deinitialize","Promise","resolve","execute","payload","payment","state","isStoreCreditApplied","useStoreCredit","getCheckoutOrThrow","applyStoreCredit","validateCheckout","getCheckout","countryCode","getBillingAddressOrThrow","_isCountrySupported","_loadPaymentMethod","_redirectToClearpay","getPaymentMethod","noop","finalize","getPaymentId","config","getContextConfig","token","paymentPayload","providerId","paymentData","nonce","submitOrder","submitPayment","error","forgetCheckout","loadPaymentMethods","clientToken","redirect","loadPaymentMethod","params","method","PaymentMethodClientUnavailableError","ClearpayScriptLoader","_scriptLoader","_window","window","loadScript","_getScriptUrl","testMode","AfterPay","module","paymentIntegrationService","getScriptLoader","resolveIds","gateway","id","assign","OrderFinalizationNotRequiredError","PaymentStatusTypes","CreditCardPaymentStrategy","_isHostedPaymentFormEnabled","_shouldRenderHostedForm","_executeWithHostedForm","_executeWithoutHostedForm","_isHostedFieldAvailable","formOptions","creditCard","form","paymentSettings","bigpayBaseUrl","host","getStoreConfigOrThrow","createHostedForm","attach","then","_hostedForm","detach","reject","order","validate","submit","isHostedFormEnabled","values","fields","every","isNil","getBrowserInfo","navigator","language","userLanguage","color_depth","screen","colorDepth","java_enabled","javaEnabled","screen_height","height","screen_width","width","time_zone_offset","Date","getTimezoneOffset","toString","ACKNOWLEDGE","FINALIZE","INITIALIZE","SagePayPaymentStrategy","_formPoster","_isThreeDSTwoExperimentOn","newPaymentData","browser_info","catch","some","code","three_ds_result","merchant_data","creq","payer_auth_request","PaReq","TermUrl","callback_url","MD","postForm","acs_url","getOrder","getPaymentStatus","finalizeOrder","checkoutSettings","features","createFormPoster","__webpack_require__","isHostedInstrumentLike","instrument","shouldSaveInstrument","shouldSetAsDefaultInstrument","d","exports","definition","key","o","defineProperty","enumerable","get","obj","prop","hasOwnProperty","call","e","OffsitePaymentStrategy","orderPayload","_shouldSubmitFullPayload","instrumentId","Boolean","initializeOffsitePayment","PaymentMethodFailedError","CBAMPGSPaymentStrategy","cbaMGPSScriptLoader","sessionId","initializationData","merchantId","isTestModeFlagEnabled","is3dsEnabled","threeDSjs","locale","getLocale","configure","callback","isConfigured","configuration","wsVersion","threeDSecure","retryState","storeProfile","storeId","orderId","transactionId","initiateAuthentication","data","msg","gatewayRecommendation","restApiResponse","transaction","authenticationStatus","authenticatePayer","attempt","_resolve","cause","setTimeout","fullScreenRedirect","CBAMPGSScriptLoader","ThreeDS","PaypalButtonStyleLayoutOption","PaypalButtonStyleSizeOption","PaypalButtonStyleColorOption","PaypalButtonStyleLabelOption","PaypalButtonStyleShapeOption","toResolvableModule","HORIZONTAL","VERTICAL","SMALL","MEDIUM","LARGE","RESPONSIVE","GOLD","BLUE","SIlVER","BLACK","CHECKOUT","PAY","BUYNOW","PAYPAL","CREDIT","PILL","RECT","PaypalExpressPaymentStrategy","scriptLoader","useRedirectFlow","paypalexpress","isInContextEnabled","paypalSdk","loadPaypalSDK","checkout","setup","button","environment","closeFlow","redirectUrl","paypal","isAcknowledgedOrFinalized","getPaymentRedirectUrl","top","location","href","initXO","startFlow","PaypalScriptLoader","async","attributes","SDK_VERSION_HEADERS","PaypalButtonStrategy","paypalExpressScriptLoader","formPoster","paypalSDK","renderButton","containerId","allowCredit","clientId","onPaymentError","shouldProcessPayment","style","env","fundingCreditOption","FUNDING","allowedSources","disallowedSources","Button","render","client","commit","funding","allowed","disallowed","getStyle","_","actions","setupPayment","onAuthorize","tokenizePayment","color","fundingicons","label","layout","shape","size","tagline","onError","loadDefaultCheckout","cartId","getCartOrThrow","getHost","request","post","paymentID","payerID","getPaymentData","payment_type","provider","action","paymentId","payerId","payerInfo","JSON","stringify","payer","payer_info","AdditionalActionType","OffsiteRedirect","CheckoutComCustomPaymentStrategy","_processResponse","loadCurrentOrder","additionalActionRequired","additional_action_required","_performRedirect","replace","redirect_url","CheckoutComFawryPaymentStrategy","formattedPayload","_createFormattedPayload","fawryPaymentData","customerMobile","customerEmail","isThreeDSecureRequiredError","CheckoutComCreditCardPaymentStrategy","_handleThreeDSecure","CheckoutComSEPAPaymentStrategy","iban","bic","document","CheckoutComiDealPaymentStrategy","DOCUMENT_SUPPORTED_APMS","CheckoutComAPMPaymentStrategy","ccDocument","indexOf"],"sourceRoot":""}