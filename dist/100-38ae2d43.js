"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[100],{17100:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var n=a(31635),r=a(30455),i=a(41109),o=a(49655);const s=function(e){var t=e.children;return r.createElement("header",{className:"cart-header"},r.createElement("h3",{className:"cart-title optimizedCheckout-headingSecondary"},r.createElement(o.A,{id:"cart.cart_heading"})),t)};var E=a(62901),c=a(66317),l=a(62755),m=a(60164),N=a(97947),u=a(9660),R=a(6357),d=a(58330),A=a(45293),L=a(84744),T="https://61oz9fx2d9.execute-api.us-east-2.amazonaws.com/Prod/",O=function(){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,n.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,fetch("/customer/current.jwt?app_client_id=npqb1dowfj7yeh7d1fqwhcod7wqs6al",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}})];case 1:return[4,t.sent().json()];case 2:return[2,t.sent().token];case 3:return e=t.sent(),console.error("Error fetching token:",e),[2,null];case 4:return[2]}}))}))},p=function(e){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var t,a,r,i;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,O()];case 1:if(!(t=n.sent()))throw new Error("Token not available");return a={Accept:"application/json","Content-Type":"application/json","X-Current-Customer":t},[4,L.A.post("".concat(T,"create"),e,{headers:a})];case 2:if(200!==(r=n.sent()).status)throw new Error("Error submitting the form: ".concat(r.statusText));return[2,r.data];case 3:throw i=n.sent(),console.error("Error creating certificate:",i),i;case 4:return[2]}}))}))},f=a(71055),C=a(46522);const h={Alabama:"AL",Alaska:"AK",Arizona:"AZ",Arkansas:"AR",California:"CA",Colorado:"CO",Connecticut:"CT",Delaware:"DE",Florida:"FL",Georgia:"GA",Hawaii:"HI",Idaho:"ID",Illinois:"IL",Indiana:"IN",Iowa:"IA",Kansas:"KS",Kentucky:"KY",Louisiana:"LA",Maine:"ME",Maryland:"MD",Massachusetts:"MA",Michigan:"MI",Minnesota:"MN",Mississippi:"MS",Missouri:"MO",Montana:"MT",Nebraska:"NE",Nevada:"NV","New Hampshire":"NH","New Jersey":"NJ","New Mexico":"NM","New York":"NY","North Carolina":"NC","North Dakota":"ND",Ohio:"OH",Oklahoma:"OK",Oregon:"OR",Pennsylvania:"PA","Rhode Island":"RI","South Carolina":"SC","South Dakota":"SD",Tennessee:"TN",Texas:"TX",Utah:"UT",Vermont:"VT",Virginia:"VA",Washington:"WA","West Virginia":"WV",Wisconsin:"WI",Wyoming:"WY"};const M={Alabama:["RESALE","TRIBAL GOVERNMENT"],Alaska:["RESALE"],Alberta:[],"American Samoa":[],Arizona:["RESALE","TRIBAL GOVERNMENT"],Arkansas:["RESALE"],"British Columbia":["RESALE","TRIBAL GOVERNMENT"],California:["RESALE","TRIBAL GOVERNMENT"],"Canada (GST)":["TRIBAL GOVERNMENT"],Colorado:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Connecticut:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Delaware:[],"District Of Columbia":["RESALE"],Florida:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Georgia:["LOCAL GOVERNMENT","RESALE"],Guam:[],Hawaii:["RESALE"],Idaho:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Illinois:["LOCAL GOVERNMENT","RESALE"],Indiana:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Iowa:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Kansas:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Kentucky:["LOCAL GOVERNMENT","RESALE"],Louisiana:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Maine:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Manitoba:["RESALE","TRIBAL GOVERNMENT"],Maryland:["LOCAL GOVERNMENT","RESALE"],Massachusetts:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Michigan:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Minnesota:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Mississippi:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Missouri:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Montana:["RESALE"],Nebraska:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Nevada:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],"New Brunswick":["TRIBAL GOVERNMENT"],Newfoundland:["TRIBAL GOVERNMENT"],"New Hampshire":[],"New Jersey":["LOCAL GOVERNMENT","RESALE"],"New Mexico":["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],"New York":["RESALE","TRIBAL GOVERNMENT"],"North Carolina":["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],"North Dakota":["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],"Northern Mariana Islands":[],"Northwest Territories":[],"Nova Scotia":["TRIBAL GOVERNMENT"],Nunavut:[],Ohio:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Oklahoma:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Ontario:["TRIBAL GOVERNMENT"],Oregon:["RESALE"],Pennsylvania:["LOCAL GOVERNMENT","RESALE"],"Prince Edward Island":["TRIBAL GOVERNMENT"],"Puerto Rico":["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Quebec:["TRIBAL GOVERNMENT"],"Rhode Island":["RESALE","TRIBAL GOVERNMENT"],Saskatchewan:["RESALE","TRIBAL GOVERNMENT"],"South Carolina":["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],"South Dakota":["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Tennessee:["LOCAL GOVERNMENT","RESALE"],Texas:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],"U.S. Virgin Islands":[],Utah:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Vermont:["LOCAL GOVERNMENT","RESALE"],Virginia:["LOCAL GOVERNMENT","RESALE"],Washington:["RESALE","TRIBAL GOVERNMENT"],"West Virginia":["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Wisconsin:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Wyoming:["LOCAL GOVERNMENT","RESALE","TRIBAL GOVERNMENT"],Yukon:[]};var V=a(62854),S=[{value:"19",label:"AFFIDAVIT"},{value:"29",label:"AUTO-VALIDATION NO ISSUES FOUND"},{value:"22",label:"CERTEXPRESS IMPORT"},{value:"26",label:"CERTEXPRESS PUBLIC UPLOAD"}];const G=(0,f.withFormik)({mapPropsToValues:function(e){return{region:e.initialRegion||"",exemptionReason:"",effectiveDate:"",entityUseCode:"",exemptionDescription:"",certificateLabels:[]}},validationSchema:C.Ik().shape({region:C.Yj().required("Region is required"),exemptionReason:C.Yj().required("Reason for exemption is required"),effectiveDate:C.p6().required("Effective date is required").nullable()}),handleSubmit:function(e,t){t.props.onSubmit(e)}})((function(e){var t=e.values,a=e.touched,n=e.errors,i=e.handleChange,o=e.handleSubmit,s=e.setFieldValue,E=e.isSubmitting,c=(0,r.useState)([]),l=c[0],m=c[1];return(0,r.useEffect)((function(){if(t.region){var e=t.region;m(M[e]||[]),s("exemptionReason","")}}),[t.region,s]),r.createElement("form",{className:"form certificate-form",onSubmit:o},r.createElement("fieldset",{className:"form-fieldset"},r.createElement("div",{className:"form-body"},r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"region"},"Regions Covered by Certificate"),r.createElement("span",{className:"required-label"},"Required"),r.createElement("select",{name:"region",id:"region",className:"form-input",value:t.region,onChange:i},r.createElement("option",{value:""},"Select a Region"),Object.keys(h).map((function(e){return r.createElement("option",{key:e,value:e},e)}))),a.region&&n.region&&r.createElement("div",{className:"error"},n.region))),r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"exemptionReason"},"Reason for Exemption"),r.createElement("span",{className:"required-label"},"Required"),r.createElement("select",{name:"exemptionReason",id:"exemptionReason",className:"form-input",value:t.exemptionReason,onChange:i},r.createElement("option",{value:""},"Select a Reason"),l.map((function(e){return r.createElement("option",{key:e,value:e},e)}))),a.exemptionReason&&n.exemptionReason&&r.createElement("div",{className:"error"},n.exemptionReason))),r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"effectiveDate"},"Effective Date"),r.createElement("span",{className:"required-label"},"Required"),r.createElement("input",{type:"date",name:"effectiveDate",id:"effectiveDate",className:"form-input",value:t.effectiveDate,onChange:i}),a.effectiveDate&&n.effectiveDate&&r.createElement("div",{className:"error"},n.effectiveDate))),r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"entityUseCode"},"Entity Use Code"),r.createElement("span",{className:"required-label"},"Optional"),r.createElement("input",{type:"text",name:"entityUseCode",id:"entityUseCode",className:"form-input",value:t.entityUseCode,onChange:i}))),r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"exemptionDescription"},"Exemption Description"),r.createElement("span",{className:"required-label"},"Optional"),r.createElement("input",{type:"text",name:"exemptionDescription",id:"exemptionDescription",className:"form-input",value:t.exemptionDescription,onChange:i}))),r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-field"},r.createElement("label",{htmlFor:"certificateLabels"},"Certificate Labels"),r.createElement("span",{className:"required-label"},"Optional"),r.createElement(V.Ay,{id:"certificateLabels",name:"certificateLabels",options:S,isMulti:!0,value:t.certificateLabels,onChange:function(e){return s("certificateLabels",e)}})))),r.createElement("div",{className:"form-actions"},r.createElement("button",{type:"submit",className:"button button--primary",disabled:E},E?r.createElement(r.Fragment,null,"Creating Certificate...",r.createElement("span",{className:"spinner"})):"Create Certificate"))))}));const I=(0,A.A)((function(e){var t=e.checkoutState,a=e.checkoutService,n=t.data,r=n.getBillingAddress,i=n.getCheckout,o=n.getCustomer,s=n.getShippingAddress,E=r(),c=i(),l=o(),m=s();return E&&c&&l&&m?{email:E.email||l.email,customer:l,shippingAddress:m,checkoutService:a}:null}))((function(e){var t=e.customer,a=e.shippingAddress,i=e.checkoutService,o=r.useState(!1),s=o[0],E=o[1],c=(0,r.useState)(!1),l=c[0],m=c[1];return t.isGuest?r.createElement("p",null,"Please ",r.createElement("a",{href:"/login.php?from=checkout",rel:"noopener noreferrer"},"sign in")," to apply tax exemption certificates to this transaction."):r.createElement(r.Fragment,null,r.createElement("a",{onClick:function(){E(!0)}}," Add Tax Exempt Certificate  "),r.createElement(R.A,{additionalModalClassName:"modal--big",header:r.createElement(d.A,null,"Add New Certificate"),isOpen:s,onAfterOpen:function(){console.log("after open")},onRequestClose:function(){E(!1)},shouldShowCloseButton:!0},r.createElement(G,{onSubmit:function(e){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var r,o;return(0,n.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),r=function(e,t,a,n,r,i,o){return{signedDate:a,expirationDate:"9999-12-31",exposureZone:{name:e},exemptionReason:{name:t},valid:!0,CertificateCustomFields:{1:n,2:r},customers:[{customerCode:i.id,name:i.fullName,line1:o.address1,line2:o.address2,city:o.city,postalCode:o.postalCode,phoneNumber:o.phone,emailAddress:i.email,country:o.countryCode,region:o.stateOrProvinceCode}]}}(e.region,e.exemptionReason,e.effectiveDate,e.entityUseCode,e.exemptionDescription,t,a),[4,p(r)];case 1:return s.sent()&&(m(!0),setTimeout((function(){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,t,a,r,o,s;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,8,,9]),[4,i.loadCheckout()];case 1:return e=n.sent(),(t=e.data.getShippingAddress())?[4,i.updateShippingAddress(t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return n.trys.push([3,6,,7]),[4,i.loadCheckout()];case 4:return a=n.sent(),r={cart:a.data.getCart(),shippingAddress:a.data.getShippingAddress(),billingAddress:a.data.getBillingAddress(),customer:a.data.getCustomer(),customerMessage:""},[4,i.updateCheckout(r)];case 5:return n.sent(),[3,7];case 6:return o=n.sent(),console.error("Error en updateCheckout:",o),[3,7];case 7:return m(!1),E(!1),[3,9];case 8:return s=n.sent(),console.error("Error reloading checkout:",s),[3,9];case 9:return[2]}}))}))}),3e3)),[3,3];case 2:return o=s.sent(),console.error("Error creating certificate:",o),[3,3];case 3:return[2]}}))}))}}),l&&r.createElement("div",{className:"success-message"},"Certificate Created Sucessfully!")))}));const v=function(e){var t=e.isTaxIncluded,a=e.taxes,R=e.storeCurrency,d=e.shopperCurrency,A=e.headerLink,L=e.additionalLineItems,T=e.lineItems,O=e.total,p=(0,n.__rest)(e,["isTaxIncluded","taxes","storeCurrency","shopperCurrency","headerLink","additionalLineItems","lineItems","total"]),f=(0,r.useMemo)((function(){return(0,u.A)(T)}),[T]),C=t&&a&&a.length>0;return r.createElement("article",{className:"cart optimizedCheckout-orderSummary","data-test":"cart"},r.createElement(s,null,A),r.createElement(l.A,null,r.createElement(E.A,{displayLineItemsCount:!0,items:f})),r.createElement(i.Y,{region:"summary.lastItem.after"}),r.createElement(l.A,null,r.createElement(m.A,(0,n.__assign)({isTaxIncluded:t,taxes:a},p)),L),r.createElement(l.A,null,r.createElement(I,null)),r.createElement(l.A,null,r.createElement(N.A,{orderAmount:O,shopperCurrencyCode:d.code,storeCurrencyCode:R.code})),C&&r.createElement(l.A,null,r.createElement("h5",{className:"cart-taxItem cart-taxItem--subtotal optimizedCheckout-contentPrimary","data-test":"tax-text"},r.createElement(o.A,{id:"tax.inclusive_label"})),(a||[]).map((function(e,t){return r.createElement(c.A,{amount:e.amount,key:t,label:e.name,testId:"cart-taxes"})}))))}}}]);
//# sourceMappingURL=100-38ae2d43.js.map