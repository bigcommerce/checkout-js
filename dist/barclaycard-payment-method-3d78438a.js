"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[920],{31698:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(31635),a=n(44218),s=n(69440),o=n(70355),r=n(65685),c=n(94611),d=n(11474),u=n(40646),m=n(68801);const l=e=>{const{description:t,isInitializing:n=!1,initializePayment:l,method:g,onUnhandledError:h=s.noop,deinitializePayment:y}=e,[p,k]=(0,o.useState)(!1),[I,f]=(0,o.useState)(),b=function(e){const t=(0,a.B4)(((e=[])=>e.filter(r.A))),n=(0,a.B4)(((e=[])=>e.filter((({trustedShippingAddress:e})=>e)))),{checkoutService:i,checkoutState:s,isUsingMultiShipping:o=!1,method:d}=e,{data:{getCart:u,getConfig:m,getCustomer:l,getInstruments:g,isPaymentDataRequired:h,isPaymentDataSubmitted:y},statuses:{isLoadingInstruments:p}}=s,k=u(),I=m(),f=l();if(!I||!k||!f)throw new Error("Unable to get checkout");const b=t(g(d)),v=n(b);return{instruments:v,isNewAddress:0===v.length&&b.length>0,isInstrumentFeatureAvailable:!y(d.id,d.gateway)&&(0,c.A)({config:I,customer:f,isUsingMultiShipping:o,paymentMethod:d}),isLoadingInstruments:p(),isPaymentDataRequired:h(),loadInstruments:i.loadInstruments}}(e),{isLoadingInstruments:v,instruments:S,isNewAddress:w,isInstrumentFeatureAvailable:A,loadInstruments:C}=b,E=(0,o.useCallback)((()=>{if(!p&&S.length)return(0,s.find)(S,{defaultInstrument:!0})||S[0]}),[p,S]),P=(0,o.useCallback)((()=>{k(!0),f(void 0)}),[]),M=(0,o.useCallback)((e=>{k(!1),f((0,s.find)(S,{bigpayToken:e}))}),[S]);(0,o.useEffect)((()=>((0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{yield l({gatewayId:g.gateway,methodId:g.id}),A&&(yield C())}catch(e){h(e)}})),()=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{yield y({gatewayId:g.gateway,methodId:g.id})}catch(e){h(e)}}))})),[]);const z=I||E(),U=n||v,_=A&&(S.length>0||w);return t||A?o.createElement(m.A,{hideContentWhenLoading:!0,isLoading:U},o.createElement("div",{className:"paymentMethod paymentMethod--hosted"},t,_&&o.createElement(d.A,{instruments:S,onSelectInstrument:M,onUseNewInstrument:P,selectedInstrument:z}),A&&o.createElement(u.A,{instrumentId:z&&z.bigpayToken,instruments:S,isAccountInstrument:!0}))):null}},41256:(e,t,n)=>{n.d(t,{BarclaycardPaymentMethod:()=>r});var i=n(31635),a=n(34624),s=n(70355),o=n(31698);const r=(0,n(19285).A)((e=>{var{checkoutService:t,checkoutState:n,method:r,paymentForm:c}=e,d=(0,i.__rest)(e,["checkoutService","checkoutState","method","paymentForm"]);const u=(0,s.useCallback)((e=>t.initializePayment(Object.assign(Object.assign({},e),{integrations:[a.q]}))),[t]);return s.createElement(o.A,Object.assign({},d,{checkoutService:t,checkoutState:n,deinitializePayment:t.deinitializePayment,initializePayment:u,method:r,paymentForm:c}))}),[{gateway:"barclaycard"}])},94611:(e,t,n)=>{function i({config:e,customer:t,isUsingMultiShipping:n,paymentMethod:i}){return!(!e.checkoutSettings.isCardVaultingEnabled||!i.config.isVaultingEnabled||t.isGuest||n)}n.d(t,{A:()=>i})}}]);
//# sourceMappingURL=barclaycard-payment-method-3d78438a.js.map