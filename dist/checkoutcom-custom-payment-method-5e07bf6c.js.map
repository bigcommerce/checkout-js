{"version":3,"file":"checkoutcom-custom-payment-method-5e07bf6c.js","mappings":"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","sources":["webpack://checkout/./packages/checkoutcom-integration/src/checkoutcomFieldsets/TextFieldForm.tsx","webpack://checkout/./packages/checkoutcom-integration/src/CheckoutcomCustomFormFields.tsx","webpack://checkout/./packages/checkoutcom-integration/src/checkoutcomFieldsets/getCheckoutcomFieldsetValidationSchemas.tsx","webpack://checkout/./packages/checkoutcom-integration/src/CheckoutcomCustomPaymentMethod.tsx"],"sourcesContent":["import { type FieldProps } from 'formik';\nimport React, { type FunctionComponent, memo, useCallback, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { Fieldset, FormField, TextInput } from '@bigcommerce/checkout/ui';\n\nexport interface TextFieldProps {\n    additionalClassName: string;\n    autoComplete: string;\n    labelId: string;\n    name: string;\n}\n\nexport interface TextFieldFormProps {\n    additionalClassName: string;\n    autoComplete: string;\n    labelId: string;\n    name: string;\n}\n\nconst TextField: FunctionComponent<TextFieldProps> = (props) => {\n    const { additionalClassName, autoComplete, labelId, name } = props;\n\n    const renderInput = useCallback(\n        ({ field }: FieldProps) => (\n            <TextInput {...field} autoComplete={autoComplete} id={field.name} />\n        ),\n        [autoComplete],\n    );\n\n    const labelContent = useMemo(() => <TranslatedString id={labelId} />, [labelId]);\n\n    return (\n        <FormField\n            additionalClassName={additionalClassName}\n            input={renderInput}\n            labelContent={labelContent}\n            name={name}\n        />\n    );\n};\n\nconst TextFieldForm: FunctionComponent<TextFieldFormProps> = ({\n    additionalClassName,\n    autoComplete,\n    labelId,\n    name,\n}) => (\n    <Fieldset>\n        <div className=\"form-ccFields\">\n            <TextField\n                additionalClassName={additionalClassName}\n                autoComplete={autoComplete}\n                labelId={labelId}\n                name={name}\n            />\n        </div>\n    </Fieldset>\n);\n\nexport default memo(TextFieldForm);\n","import { type BillingAddress, type PaymentMethod } from '@bigcommerce/checkout-sdk';\nimport React, { type FunctionComponent, useContext, useEffect } from 'react';\n\nimport { PaymentFormContext } from '@bigcommerce/checkout/contexts';\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { CheckboxFormField } from '@bigcommerce/checkout/ui';\n\nimport TextFieldForm from './checkoutcomFieldsets/TextFieldForm';\n\ninterface CheckoutcomAPMFormProps {\n    method: PaymentMethod;\n    debtor: BillingAddress;\n}\n\ninterface SepaCreditor {\n    sepaCreditorAddress: string;\n    sepaCreditorCity: string;\n    sepaCreditorCompanyName: string;\n    sepaCreditorCountry: string;\n    sepaCreditorIdentifier: string;\n    sepaCreditorPostalCode: string;\n}\n\nconst Sepa: FunctionComponent<CheckoutcomAPMFormProps> = ({ method, debtor }) => {\n    const paymentContext = useContext(PaymentFormContext);\n    const creditor: SepaCreditor = method.initializationData.sepaCreditor;\n\n    useEffect(() => {\n        paymentContext?.paymentForm.disableSubmit(method, true);\n\n        return () => paymentContext?.paymentForm.disableSubmit(method, false);\n    }, [paymentContext, method]);\n\n    function toggleSubmitButton(isChecked: boolean) {\n        paymentContext?.paymentForm.disableSubmit(method, !isChecked);\n    }\n\n    return (\n        <>\n            <div className=\"checkoutcom-sepa-column-container\">\n                <div className=\"checkoutcom-sepa-column-content\">\n                    <h4 className=\"checkoutcom-sepa-title\">\n                        <TranslatedString id=\"payment.checkoutcom_sepa_creditor_title\" />\n                    </h4>\n                    <h5 className=\"checkoutcom-sepa-title\">{creditor.sepaCreditorCompanyName}</h5>\n                    <p className=\"checkoutcom-sepa-line\">{creditor.sepaCreditorAddress}</p>\n                    <p className=\"checkoutcom-sepa-line\">{`${creditor.sepaCreditorPostalCode} ${creditor.sepaCreditorCity}`}</p>\n                    <p className=\"checkoutcom-sepa-line\">{creditor.sepaCreditorCountry}</p>\n                    <br />\n                    <p className=\"checkoutcom-sepa-line\">\n                        <TranslatedString\n                            data={{ creditorId: creditor.sepaCreditorIdentifier }}\n                            id=\"payment.checkoutcom_sepa_creditor_id\"\n                        />\n                    </p>\n                </div>\n                <div className=\"checkoutcom-sepa-column-content\">\n                    <h4 className=\"checkoutcom-sepa-title\">\n                        <TranslatedString id=\"payment.checkoutcom_sepa_debtor_title\" />\n                    </h4>\n                    <h5 className=\"checkoutcom-sepa-title\">{`${debtor.firstName} ${debtor.lastName}`}</h5>\n                    <p className=\"checkoutcom-sepa-line\">{debtor.address1}</p>\n                    <p className=\"checkoutcom-sepa-line\">{`${debtor.postalCode} ${debtor.city}, ${debtor.stateOrProvinceCode}`}</p>\n                    <p className=\"checkoutcom-sepa-line\">{debtor.countryCode}</p>\n                </div>\n            </div>\n            <p className=\"checkoutcom-sepa-line\">\n                <TranslatedString id=\"payment.checkoutcom_sepa_payment_type\" />\n            </p>\n            <br />\n\n            <TextFieldForm\n                additionalClassName=\"form-field--iban\"\n                autoComplete=\"iban\"\n                labelId=\"payment.sepa_account_number\"\n                name=\"iban\"\n            />\n            <CheckboxFormField\n                labelContent={\n                    <TranslatedString\n                        data={{ creditorName: creditor.sepaCreditorCompanyName }}\n                        id=\"payment.checkoutcom_sepa_mandate_disclaimer\"\n                    />\n                }\n                name=\"sepaMandate\"\n                // eslint-disable-next-line react/jsx-no-bind\n                onChange={toggleSubmitButton}\n            />\n        </>\n    );\n};\n\nconst Fawry: FunctionComponent<CheckoutcomAPMFormProps> = () => {\n    return (\n        <>\n            <TextFieldForm\n                additionalClassName=\"form-field--customerMobile\"\n                autoComplete=\"tel\"\n                labelId=\"payment.checkoutcom_fawry_customer_mobile_label\"\n                name=\"customerMobile\"\n            />\n            <TextFieldForm\n                additionalClassName=\"form-field--customerEmail\"\n                autoComplete=\"email\"\n                labelId=\"payment.checkoutcom_fawry_customer_email_label\"\n                name=\"customerEmail\"\n            />\n        </>\n    );\n};\n\nconst checkoutcomCustomFormFields: CheckoutcomCustomFormFields = {\n    fawry: Fawry,\n    sepa: Sepa,\n};\n\ninterface CheckoutcomCustomFormFields {\n    [key: string]: React.FunctionComponent<CheckoutcomAPMFormProps>;\n}\n\nexport const ccDocumentField = ({ method }: CheckoutcomAPMFormProps) => (\n    <TextFieldForm\n        additionalClassName=\"form-field--ccDocument\"\n        autoComplete=\"cc-document\"\n        labelId={`payment.checkoutcom_document_label_${method.id}`}\n        name=\"ccDocument\"\n    />\n);\n\nexport default checkoutcomCustomFormFields;\n","import { type LanguageService } from '@bigcommerce/checkout-sdk';\nimport { memoize } from '@bigcommerce/memoize';\nimport { boolean, object, type ObjectSchema, string } from 'yup';\n\nimport {\n    type DocumentOnlyCustomFormFieldsetValues,\n    type FawryCustomFormFieldsetValues,\n    type SepaCustomFormFieldsetValues,\n} from './CheckoutcomFormValues';\n\nexport type checkoutcomCustomPaymentMethods = 'fawry' | 'sepa';\nexport type documentPaymentMethods = 'oxxo' | 'qpay' | 'boleto';\nexport type checkoutcomPaymentMethods = documentPaymentMethods | checkoutcomCustomPaymentMethods;\nexport const checkoutcomPaymentMethodsArray = ['fawry', 'sepa', 'oxxo', 'qpay', 'boleto'];\nexport interface CustomValidationSchemaOptions {\n    paymentMethod: checkoutcomPaymentMethods;\n    language: LanguageService;\n}\n\nconst checkoutComShemas: {\n    [key in checkoutcomPaymentMethods]: (language: LanguageService) => any;\n} = {\n    oxxo: (language: LanguageService) => ({\n        ccDocument: string()\n            .required(language.translate('payment.checkoutcom_document_invalid_error_oxxo'))\n            .length(18, language.translate('payment.checkoutcom_document_invalid_error_oxxo')),\n    }),\n    qpay: (language: LanguageService) => ({\n        ccDocument: string()\n            .notRequired()\n            .max(32, language.translate('payment.checkoutcom_document_invalid_error_qpay')),\n    }),\n    boleto: (language: LanguageService) => ({\n        ccDocument: string()\n            .required(language.translate('payment.checkoutcom_document_invalid_error_boleto'))\n            .min(11, language.translate('payment.checkoutcom_document_invalid_error_boleto'))\n            .max(14, language.translate('payment.checkoutcom_document_invalid_error_boleto')),\n    }),\n    sepa: (language: LanguageService) => ({\n        iban: string().required(language.translate('payment.sepa_account_number_required')),\n        sepaMandate: boolean().required(language.translate('payment.sepa_mandate_required')),\n    }),\n    fawry: (language: LanguageService) => ({\n        customerMobile: string()\n            .required(language.translate('payment.checkoutcom_fawry_customer_mobile_invalid_error'))\n            .matches(\n                new RegExp(`^\\\\d{11}$`),\n                language.translate('payment.checkoutcom_fawry_customer_mobile_invalid_error'),\n            ),\n        customerEmail: string()\n            .required(language.translate('payment.checkoutcom_fawry_customer_email_invalid_error'))\n            .email(language.translate('payment.checkoutcom_fawry_customer_email_invalid_error')),\n    }),\n};\n\nexport default memoize(function getCheckoutcomValidationSchemas({\n    paymentMethod,\n    language,\n}: CustomValidationSchemaOptions): ObjectSchema<\n    | DocumentOnlyCustomFormFieldsetValues\n    | FawryCustomFormFieldsetValues\n    | SepaCustomFormFieldsetValues\n> {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    return object(checkoutComShemas[paymentMethod](language));\n});\n","import { type PaymentInitializeOptions } from '@bigcommerce/checkout-sdk';\nimport {\n    createCheckoutComAPMPaymentStrategy,\n    createCheckoutComCreditCardPaymentStrategy,\n    createCheckoutComFawryPaymentStrategy,\n    createCheckoutComIdealPaymentStrategy,\n    createCheckoutComSepaPaymentStrategy,\n} from '@bigcommerce/checkout-sdk/integrations/checkoutcom-custom';\nimport React, { type FunctionComponent, useCallback } from 'react';\n\nimport {\n    CreditCardPaymentMethodComponent,\n    type CreditCardPaymentMethodProps,\n} from '@bigcommerce/checkout/credit-card-integration';\nimport {\n    type PaymentMethodProps,\n    type PaymentMethodResolveId,\n    toResolvableComponent,\n} from '@bigcommerce/checkout/payment-integration-api';\n\nimport checkoutcomCustomFormFields, { ccDocumentField } from './CheckoutcomCustomFormFields';\nimport {\n    type checkoutcomPaymentMethods,\n    getCheckoutcomValidationSchemas,\n} from './checkoutcomFieldsets';\nimport { checkoutcomPaymentMethodsArray } from './checkoutcomFieldsets/getCheckoutcomFieldsetValidationSchemas';\n\nexport interface CheckoutcomCustomPaymentMethodProps\n    extends Omit<CreditCardPaymentMethodProps, 'cardFieldset' | 'cardValidationSchema'> {\n    checkoutCustomMethod: string;\n}\n\nconst isCheckoutcomPaymentMethod = (methodId: string): methodId is checkoutcomPaymentMethods => {\n    return Object.values(checkoutcomPaymentMethodsArray).includes(methodId);\n};\nconst CheckoutcomCustomPaymentMethod: FunctionComponent<PaymentMethodProps> = ({\n    language,\n    method,\n    checkoutService,\n    checkoutState,\n    ...rest\n}) => {\n    const checkoutCustomMethod = method.id;\n    const CheckoutcomCustomFieldset =\n        checkoutCustomMethod in checkoutcomCustomFormFields\n            ? checkoutcomCustomFormFields[checkoutCustomMethod]\n            : ccDocumentField;\n\n    const billingAddress = checkoutState.data.getBillingAddress();\n\n    const initializeCheckoutcomCustomPayment = useCallback(\n        (options: PaymentInitializeOptions) => {\n            return checkoutService.initializePayment({\n                ...options,\n                integrations: [\n                    createCheckoutComAPMPaymentStrategy,\n                    createCheckoutComCreditCardPaymentStrategy,\n                    createCheckoutComFawryPaymentStrategy,\n                    createCheckoutComIdealPaymentStrategy,\n                    createCheckoutComSepaPaymentStrategy,\n                ],\n            });\n        },\n        [checkoutService],\n    );\n\n    if (!isCheckoutcomPaymentMethod(checkoutCustomMethod)) {\n        return null;\n    }\n\n    return (\n        <CreditCardPaymentMethodComponent\n            checkoutService={checkoutService}\n            checkoutState={checkoutState}\n            deinitializePayment={checkoutService.deinitializePayment}\n            initializePayment={initializeCheckoutcomCustomPayment}\n            language={language}\n            method={method}\n            {...rest}\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            cardFieldset={<CheckoutcomCustomFieldset debtor={billingAddress!} method={method} />}\n            cardValidationSchema={getCheckoutcomValidationSchemas({\n                paymentMethod: checkoutCustomMethod,\n                language,\n            })}\n        />\n    );\n};\n\nexport default toResolvableComponent<PaymentMethodProps, PaymentMethodResolveId>(\n    CheckoutcomCustomPaymentMethod,\n    [{ gateway: 'checkoutcom' }],\n);\n"],"names":["TextField","props","additionalClassName","autoComplete","labelId","name","renderInput","useCallback","field","TextInput","id","labelContent","useMemo","TranslatedString","FormField","input","memo","Fieldset","className","ccDocumentField","method","fawry","sepa","debtor","paymentContext","useContext","PaymentFormContext","creditor","initializationData","sepaCreditor","useEffect","paymentForm","disableSubmit","sepaCreditorCompanyName","sepaCreditorAddress","sepaCreditorPostalCode","sepaCreditorCity","sepaCreditorCountry","data","creditorId","sepaCreditorIdentifier","firstName","lastName","address1","postalCode","city","stateOrProvinceCode","countryCode","CheckboxFormField","creditorName","onChange","isChecked","checkoutcomPaymentMethodsArray","checkoutComShemas","oxxo","language","ccDocument","required","translate","length","qpay","notRequired","max","boleto","min","iban","sepaMandate","customerMobile","matches","RegExp","customerEmail","email","paymentMethod","toResolvableComponent","checkoutService","checkoutState","rest","checkoutCustomMethod","CheckoutcomCustomFieldset","billingAddress","getBillingAddress","initializeCheckoutcomCustomPayment","options","initializePayment","integrations","methodId","Object","values","includes","deinitializePayment","cardFieldset","cardValidationSchema","gateway"],"sourceRoot":""}