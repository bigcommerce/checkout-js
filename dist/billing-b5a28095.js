(window.webpackJsonpCheckout=window.webpackJsonpCheckout||[]).push([[0],{1829:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(1),s=n(0),i=n.n(s),a=n(2),o=n(6),d=function(){var e=Object(s.useCallback)((function(e){return i.a.createElement(o.o,{hidden:!0,htmlFor:e},i.a.createElement(a.e,{id:"shipping.order_comment_label"}))}),[]),t=Object(s.useCallback)((function(e){var t=e.field;return i.a.createElement(o.r,Object(r.__assign)({},t,{autoComplete:"off",maxLength:2e3}))}),[]),n=Object(s.useMemo)((function(){return i.a.createElement(o.p,null,i.a.createElement(a.e,{id:"shipping.order_comment_label"}))}),[]);return i.a.createElement(o.h,{legend:n,testId:"checkout-shipping-comments"},i.a.createElement(o.k,{input:t,label:e,name:"orderComment"}))}},1849:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n(3),i=n(0),a=n.n(i),o=n(140),d=n(32),c=n(58),l=n(2),u=n(185),m=n(6),g=n(43),h=n(955);function p(e){var t=Object(h.a)(e);return t&&["amazonpay"].indexOf(t.providerId)>-1?t.providerId:void 0}var b=n(55),f=n(22),A=n(375),v=n(1829),_=n(42),O=n(643),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isResettingAddress:!1},t.addressFormRef=Object(i.createRef)(),t.handleSelectAddress=function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n,s,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=this.props,n=t.updateAddress,s=t.onUnhandledError,this.setState({isResettingAddress:!0}),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,n(e)];case 2:return r.sent(),[3,5];case 3:return i=r.sent(),s(i),[3,5];case 4:return this.setState({isResettingAddress:!1}),[7];case 5:return[2]}}))}))},t.handleUseNewAddress=function(){t.handleSelectAddress({})},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.googleMapsApiKey,n=e.billingAddress,r=e.countriesWithAutocomplete,s=e.customer,i=s.addresses,d=s.isGuest,c=e.getFields,u=e.countries,h=e.isUpdating,p=e.setFieldValue,b=e.shouldShowOrderComments,f=e.values,A="amazonpay"===e.methodId,C=c(f.countryCode),j=C.filter((function(e){return e.custom})),E=j.length>0,y=A&&E?j:C,k=this.state.isResettingAddress,S=i&&i.length>0,w=n&&Object(o.j)(n,i,c(n.countryCode));return a.a.createElement(m.i,{autoComplete:"on"},A&&n&&a.a.createElement("div",{className:"form-fieldset"},a.a.createElement(O.a,{address:n})),a.a.createElement(m.h,{id:"checkoutBillingAddress",ref:this.addressFormRef},S&&!A&&a.a.createElement(m.h,{id:"billingAddresses"},a.a.createElement(g.c,{isLoading:k},a.a.createElement(o.c,{addresses:i,onSelectAddress:this.handleSelectAddress,onUseNewAddress:this.handleUseNewAddress,selectedAddress:w?n:void 0}))),!w&&a.a.createElement(g.c,{isLoading:k},a.a.createElement(o.a,{countries:u,countriesWithAutocomplete:r,countryCode:f.countryCode,formFields:y,googleMapsApiKey:t,setFieldValue:p,shouldShowSaveAddress:!d}))),b&&a.a.createElement(v.a,null),a.a.createElement("div",{className:"form-actions"},a.a.createElement(_.a,{disabled:h||k,id:"checkout-billing-continue",isLoading:h||k,type:"submit",variant:_.c.Primary},a.a.createElement(l.e,{id:"common.continue_action"}))))},t}(i.PureComponent),j=Object(l.j)(Object(b.withFormik)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,n=e.customerMessage,s=e.billingAddress;return Object(r.__assign)(Object(r.__assign)({},Object(o.l)(t(s&&s.countryCode),s)),{orderComment:n})},isInitialValid:function(e){var t=e.billingAddress,n=e.getFields,r=e.language;return!!t&&Object(o.f)({language:r,formFields:n(t.countryCode)}).isValidSync(t)},validationSchema:function(e){var t=e.language,n=e.getFields;return"amazonpay"===e.methodId?Object(f.lazy)((function(e){return Object(A.a)({translate:Object(o.g)(t),formFields:n(e&&e.countryCode)})})):Object(f.lazy)((function(e){return Object(o.f)({language:t,formFields:n(e&&e.countryCode)})}))},enableReinitialize:!0})(C)),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n,s,i,a,d,c,l,u,m,g=e.orderComment,h=Object(r.__rest)(e,["orderComment"]);return Object(r.__generator)(this,(function(e){switch(e.label){case 0:t=this.props,n=t.updateAddress,s=t.updateCheckout,i=t.customerMessage,a=t.billingAddress,d=t.navigateNextStep,c=t.onUnhandledError,l=[],(u=Object(o.k)(h))&&!Object(o.h)(u,a)&&l.push(n(u)),i!==g&&l.push(s({customerMessage:g})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(l)];case 2:return e.sent(),d(),[3,4];case 3:return m=e.sent(),c(m),[3,4];case 4:return[2]}}))}))},t}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e=this.props,t=e.initialize,n=e.onReady,i=void 0===n?s.noop:n,a=e.onUnhandledError,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t()];case 2:return r.sent(),i(),[3,4];case 3:return o=r.sent(),a(o),[3,4];case 4:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.updateAddress,n=e.isInitializing,s=Object(r.__rest)(e,["updateAddress","isInitializing"]);return a.a.createElement("div",{className:"checkout-form"},a.a.createElement("div",{className:"form-legend-container"},a.a.createElement(m.p,{testId:"billing-address-heading"},a.a.createElement(l.e,{id:"billing.billing_address_heading"}))),a.a.createElement(g.c,{isLoading:n,unmountContentWhenLoading:!0},a.a.createElement(j,Object(r.__assign)({},s,{onSubmit:this.handleSubmit,updateAddress:t}))))},t}(i.Component);t.default=Object(d.d)((function(e){var t=e.checkoutService,n=e.checkoutState,r=n.data,s=r.getCheckout,i=r.getConfig,a=r.getCart,o=r.getCustomer,d=r.getBillingAddress,l=r.getBillingAddressFields,m=r.getBillingCountries,g=n.statuses,h=g.isLoadingBillingCountries,b=g.isUpdatingBillingAddress,f=g.isUpdatingCheckout,A=i(),v=o(),_=s(),O=a();if(!(A&&v&&_&&O))return null;var C=A.checkoutSettings,j=C.enableOrderComments,E=C.googleMapsApiKey,y=["US","CA","AU","NZ"];return C.features["CHECKOUT-4183.checkout_google_address_autocomplete_uk"]&&y.push("GB"),{billingAddress:d(),countries:m()||c.a,countriesWithAutocomplete:y,customer:v,customerMessage:_.customerMessage,getFields:l,googleMapsApiKey:E,initialize:t.loadBillingAddressFields,isInitializing:h(),isUpdating:b()||f(),methodId:p(_),shouldShowOrderComments:j&&Object(u.b)(O)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout}}))(E)}}]);