{"version":3,"file":"braintree-credit-card-payment-method-1c9c0fcd.js","mappings":"mNA2BA,MAsFA,GAAe,OApFV,I,IAAA,qBACDA,EAAoB,sCACpBC,EAAqC,eACrCC,EAAc,iCACdC,EAAgC,uBAChCC,EAAsB,kBACtBC,EAAiB,iBACjBC,EAAmB,EAAAC,MAAI,EACpBC,GAAI,cARN,sLAUD,MAAOC,EAAqBC,IAA0B,IAAAC,YAChDC,GAAM,IAAAC,QAA4C,CACpDC,wBAAwB,IAAAC,eAGtBC,GACF,IAAAC,aACI,CAAOC,EAASC,KAAuB,gDACnC,OAAOd,EAAkB,OAAD,wBACjBa,GAAO,CACVE,UAAW,CACPC,aAAc,CACV,QAAAC,CAASC,EAAOC,EAASC,GACrB,GAAIF,EACA,OAAOjB,EAAiBiB,GAG5Bb,EAAuBc,GACvBZ,EAAIc,QAAQC,+BAAiCF,CACjD,EACA,WAAAG,GACIlB,OAAuBmB,GACvBjB,EAAIc,QAAQC,oCAAiCE,CACjD,GAEJC,KACI9B,UACOA,EAAqBmB,OAG5C,GACA,CAACnB,EAAsBK,EAAmBC,IAG5CyB,GAA4B,IAAAd,aAAY,KACtCL,EAAIc,QAAQZ,uBAAuBY,SAAWjB,GAC9CG,EAAIc,QAAQZ,uBAAuBY,QAAQM,YAAYvB,IAE5D,CAACA,IAEEwB,GAA8B,IAAAhB,aAAY,KAC5CP,OAAuBmB,GAEnBjB,EAAIc,QAAQC,iCACZf,EAAIc,QAAQC,iCACZf,EAAIc,QAAQC,oCAAiCE,IAElD,IAEH,OACI,gCACI,gBAAC,IAAuB,iBAChBrB,EAAI,CACR0B,aAAchC,EACdiC,qBAAsB/B,EACtBgC,gCAAiCnC,EACjCI,kBAAmBW,EACnBV,iBAAkBA,EAClB+B,2BAA4BlC,KAGhC,gBAAC,IAAK,CACFmC,wBAAwB,qBACxBC,iBAAkB,gBAAC,IAAgB,CAACC,GAAG,wBACvCC,SAAUhC,EACViC,YAAaX,EACbY,eAAgBV,GAEhB,uBAAKrB,IAAKA,EAAIc,QAAQZ,4B","sources":["webpack://checkout/./packages/core/src/app/payment/paymentMethod/BraintreeCreditCardPaymentMethod.tsx"],"sourcesContent":["import { noop } from 'lodash';\nimport React, {\n    createRef,\n    FunctionComponent,\n    RefObject,\n    useCallback,\n    useRef,\n    useState,\n} from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { Modal } from '../../ui/modal';\nimport {\n    withHostedCreditCardFieldset,\n    WithInjectedHostedCreditCardFieldsetProps,\n} from '../hostedCreditCard';\n\nimport CreditCardPaymentMethod, { CreditCardPaymentMethodProps } from './CreditCardPaymentMethod';\n\nexport type BraintreeCreditCardPaymentMethodProps = CreditCardPaymentMethodProps;\n\ninterface BraintreeCreditCardPaymentMethodRef {\n    threeDSecureContentRef: RefObject<HTMLDivElement>;\n    cancelThreeDSecureVerification?(): void;\n}\n\nconst BraintreeCreditCardPaymentMethod: FunctionComponent<\n    BraintreeCreditCardPaymentMethodProps & WithInjectedHostedCreditCardFieldsetProps\n> = ({\n    getHostedFormOptions,\n    getHostedStoredCardValidationFieldset,\n    hostedFieldset,\n    hostedStoredCardValidationSchema,\n    hostedValidationSchema,\n    initializePayment,\n    onUnhandledError = noop,\n    ...rest\n}) => {\n    const [threeDSecureContent, setThreeDSecureContent] = useState<HTMLElement>();\n    const ref = useRef<BraintreeCreditCardPaymentMethodRef>({\n        threeDSecureContentRef: createRef(),\n    });\n\n    const initializeBraintreePayment: BraintreeCreditCardPaymentMethodProps['initializePayment'] =\n        useCallback(\n            async (options, selectedInstrument) => {\n                return initializePayment({\n                    ...options,\n                    braintree: {\n                        threeDSecure: {\n                            addFrame(error, content, cancel) {\n                                if (error) {\n                                    return onUnhandledError(error);\n                                }\n\n                                setThreeDSecureContent(content);\n                                ref.current.cancelThreeDSecureVerification = cancel;\n                            },\n                            removeFrame() {\n                                setThreeDSecureContent(undefined);\n                                ref.current.cancelThreeDSecureVerification = undefined;\n                            },\n                        },\n                        form:\n                            getHostedFormOptions &&\n                            (await getHostedFormOptions(selectedInstrument)),\n                    },\n                });\n            },\n            [getHostedFormOptions, initializePayment, onUnhandledError],\n        );\n\n    const appendThreeDSecureContent = useCallback(() => {\n        if (ref.current.threeDSecureContentRef.current && threeDSecureContent) {\n            ref.current.threeDSecureContentRef.current.appendChild(threeDSecureContent);\n        }\n    }, [threeDSecureContent]);\n\n    const cancelThreeDSecureModalFlow = useCallback(() => {\n        setThreeDSecureContent(undefined);\n\n        if (ref.current.cancelThreeDSecureVerification) {\n            ref.current.cancelThreeDSecureVerification();\n            ref.current.cancelThreeDSecureVerification = undefined;\n        }\n    }, []);\n\n    return (\n        <>\n            <CreditCardPaymentMethod\n                {...rest}\n                cardFieldset={hostedFieldset}\n                cardValidationSchema={hostedValidationSchema}\n                getStoredCardValidationFieldset={getHostedStoredCardValidationFieldset}\n                initializePayment={initializeBraintreePayment}\n                onUnhandledError={onUnhandledError}\n                storedCardValidationSchema={hostedStoredCardValidationSchema}\n            />\n\n            <Modal\n                additionalBodyClassName=\"modal-body--center\"\n                closeButtonLabel={<TranslatedString id=\"common.close_action\" />}\n                isOpen={!!threeDSecureContent}\n                onAfterOpen={appendThreeDSecureContent}\n                onRequestClose={cancelThreeDSecureModalFlow}\n            >\n                <div ref={ref.current.threeDSecureContentRef} />\n            </Modal>\n        </>\n    );\n};\n\nexport default withHostedCreditCardFieldset(BraintreeCreditCardPaymentMethod);\n"],"names":["getHostedFormOptions","getHostedStoredCardValidationFieldset","hostedFieldset","hostedStoredCardValidationSchema","hostedValidationSchema","initializePayment","onUnhandledError","noop","rest","threeDSecureContent","setThreeDSecureContent","useState","ref","useRef","threeDSecureContentRef","createRef","initializeBraintreePayment","useCallback","options","selectedInstrument","braintree","threeDSecure","addFrame","error","content","cancel","current","cancelThreeDSecureVerification","removeFrame","undefined","form","appendThreeDSecureContent","appendChild","cancelThreeDSecureModalFlow","cardFieldset","cardValidationSchema","getStoredCardValidationFieldset","storedCardValidationSchema","additionalBodyClassName","closeButtonLabel","id","isOpen","onAfterOpen","onRequestClose"],"sourceRoot":""}