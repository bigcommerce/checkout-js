"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[8964],{44713:(e,t,s)=>{s.r(t),s.d(t,{default:()=>P});var i=s(31635),n=s(69440),o=s(70355),d=s(49655),a=s(17986),l=s(39886),r=s(95108),c=s(45293),u=s(79001),m=s(84559),g=s(87980),A=s(74027),p=s(43586),h=s(69462),b=s(94202),y=s(68512),C=s(38989),E=s(69022),f=s(91182),v=s(87650),k=s(49102),S=s(62562),F=s(12319),_=s(22011),M=s(33515),U=s(10685),w=s(69070),B=s(46487),I=s(4899),V=s(60833),z=s(74302);const L=(0,y.A)((0,h.bk)({handleSubmit:(e,{props:{onSubmit:t}})=>{t(e)},mapPropsToValues:({getFields:e,customerMessage:t,billingAddress:s})=>Object.assign(Object.assign({},(0,_.A)(e(s&&s.countryCode),s)),{orderComment:t}),isInitialValid:({billingAddress:e,getFields:t,language:s})=>!!e&&(0,M.A)({language:s,formFields:t(e.countryCode)}).isValidSync(e),validationSchema:({language:e,getFields:t,methodId:s})=>"amazonpay"===s?(0,b.RZ)(s=>(0,U.A)({translate:(0,M.X)(e),formFields:t(s&&s.countryCode)})):(0,b.RZ)(s=>(0,M.A)({language:e,formFields:t(s&&s.countryCode)})),enableReinitialize:!0})(({googleMapsApiKey:e,billingAddress:t,countriesWithAutocomplete:s,customer:{addresses:n,isGuest:l},getFields:r,countries:c,isUpdating:u,setFieldValue:m,shouldShowOrderComments:g,values:A,methodId:p,isFloatingLabelEnabled:h,updateAddress:b,onUnhandledError:y})=>{const[_,M]=(0,o.useState)(!1),U=(0,o.useRef)(null),{isPayPalFastlaneEnabled:L,paypalFastlaneAddresses:N}=(0,C.A)(),{themeV2:O}=(0,E.w)(),K="amazonpay"===p,P=r(A.countryCode),R=P.filter(({custom:e})=>e),j=R.length>0,W=K&&j?R:P,Z=l&&L?N:n,x=(null==Z?void 0:Z.length)>0,G=t&&(0,v.A)(t,Z,r(t.countryCode)),J=e=>(0,i.__awaiter)(void 0,void 0,void 0,function*(){M(!0);try{yield b(e)}catch(e){e instanceof Error&&y(e)}finally{M(!1)}});return o.createElement(I.A,{autoComplete:"on"},K&&t&&o.createElement("div",{className:"form-fieldset"},o.createElement(z.A,{address:t})),o.createElement(V.A,{id:"checkoutBillingAddress",ref:U},x&&!K&&o.createElement(V.A,{id:"billingAddresses"},o.createElement(f.A,{isLoading:_},o.createElement(k.A,{addresses:Z,onSelectAddress:J,onUseNewAddress:()=>{J({})},selectedAddress:G?t:void 0,type:S.A.Billing}))),!G&&o.createElement(a.A,{isLoading:_},o.createElement(F.A,{countries:c,countriesWithAutocomplete:s,countryCode:A.countryCode,formFields:W,googleMapsApiKey:e,isFloatingLabelEnabled:h,setFieldValue:m,shouldShowSaveAddress:!l}))),g&&o.createElement(w.A,null),o.createElement("div",{className:"form-actions"},o.createElement(B.Ay,{className:O?"body-bold":"",disabled:u||_,id:"checkout-billing-continue",isLoading:u||_,type:"submit",variant:B.Ak.Primary},o.createElement(d.A,{id:"common.continue_action"}))))}));var N=s(21106);function O(e){const t=(0,N.A)(e);return t&&["amazonpay"].includes(t.providerId)?t.providerId:void 0}class K extends o.Component{constructor(){super(...arguments),this.handleSubmit=e=>(0,i.__awaiter)(this,void 0,void 0,function*(){var{orderComment:t}=e,s=(0,i.__rest)(e,["orderComment"]);const{updateAddress:n,updateCheckout:o,customerMessage:d,billingAddress:a,navigateNextStep:c,onUnhandledError:u}=this.props,m=[],g=(0,l.A)(s);g&&!(0,r.A)(g,a)&&m.push(n(g)),d!==t&&m.push(o({customerMessage:t}));try{yield Promise.all(m),c()}catch(e){e instanceof Error&&u(e)}})}componentDidMount(){return(0,i.__awaiter)(this,void 0,void 0,function*(){const{initialize:e,onReady:t=n.noop,onUnhandledError:s}=this.props;try{yield e(),t()}catch(e){e instanceof Error&&s(e)}})}render(){const e=this.props,{updateAddress:t,isInitializing:s,themeV2:n}=e,l=(0,i.__rest)(e,["updateAddress","isInitializing","themeV2"]);return o.createElement(a.A,{isLoading:s},o.createElement("div",{className:"checkout-form"},o.createElement("div",{className:"form-legend-container"},o.createElement(p.A,{testId:"billing-address-heading",themeV2:n},o.createElement(d.A,{id:"billing.billing_address_heading"}))),o.createElement(L,Object.assign({},l,{onSubmit:this.handleSubmit,updateAddress:t}))))}}const P=(0,c.A)(function({checkoutService:e,checkoutState:t}){const{data:{getCheckout:s,getConfig:i,getCart:n,getCustomer:o,getBillingAddress:d,getBillingAddressFields:a,getBillingCountries:l},statuses:{isLoadingBillingCountries:r,isUpdatingBillingAddress:c,isUpdatingCheckout:p}}=t,h=i(),b=o(),y=s(),C=n();if(!(h&&b&&y&&C))return null;const{enableOrderComments:E,googleMapsApiKey:f}=h.checkoutSettings;return{billingAddress:d(),countries:l()||u.M,countriesWithAutocomplete:["US","CA","AU","NZ","GB"],customer:b,customerMessage:y.customerMessage,getFields:a,googleMapsApiKey:f,initialize:e.loadBillingAddressFields,isInitializing:r(),isUpdating:c()||p(),methodId:O(y),shouldShowOrderComments:E&&(0,A.A)(C)<1,updateAddress:e.updateBillingAddress,updateCheckout:e.updateCheckout,isFloatingLabelEnabled:(0,m.A)(h.checkoutSettings),themeV2:(0,g.A)(h.checkoutSettings,"CHECKOUT-7962.update_font_style_on_checkout_page")}})(K)}}]);
//# sourceMappingURL=billing-16b1389d.js.map